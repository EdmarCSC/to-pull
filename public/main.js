/*! For license information please see main.js.LICENSE.txt */
(()=>{var e={760:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var r=n(81),i=n.n(r),o=n(645),s=n.n(o)()(i());s.push([e.id,"@import url(https://fonts.googleapis.com/css2?family=Roboto:wght@500&display=swap);"]),s.push([e.id,'* {\n    margin: 0;\n    padding: 0;\n    font-family: roboto, sans-serif;\n    --main-bg-color: #021F59;\n    --second-bg-color: #72778c;\n    --bg-list-carga: #9da4c1;\n    --one-destac-color: #6375c1;\n    --two-destac-color: #3c4775;\n    --txt-color: #d9d8d7; \n    --two-txt-color: #141a26;\n    --bg-dialog-mobal: #9da4c1;\n    --color-text-m-dialog-box: #021F59;\n    --main-bg-color-hover: #051a44;\n\n    --opacity-color-text-m-dialog-box: #021f5902;\n    --main-bg-opacity-color: #222842be;\n    --one-destac-opacity-color: #6374c19e;\n    --second-bg-opacity-color: #72778c9e;\n    --bg-opacity-dialog-mobal: #9da4c101;\n}\n\n.container-main {\n    display: grid;\n    grid-template-columns: .2fr 1fr;\n    grid-template-rows: .2fr 1fr 10%;\n    grid-template-areas: \'header header\'\n                         \'sidebar body\'\n                         \'sidebar footer\';\n    width: 100%;\n    height: 100%;\n}\n\n.header {\n    position: relative;\n    grid-area: header;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    background-color: var(--second-bg-color);\n\n}\n\nbody {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    background-color: #002333;\n    height: 100vh;\n}\n\n.box-info {\n    position: absolute;\n    display: flex;\n    flex-direction: column;\n    justify-content: space-around;\n    right: 5px;\n    bottom: 10px;\n    width: 185px;\n    height: 40px;\n}\n\n.qt-cargas {\n    display: flex;\n    gap: 5px;\n    width: 250px;\n    height: 8px;\n}\n\n.qt-cargas h4 {\n    color: var(--txt-color);\n}\n\n.qt-cargas strong {\n    color: var(--main-bg-color);\n}\n\n.qt-puxar {\n    display: flex;\n    gap: 5px;\n    width: 250px;\n    height: 8px;\n}\n\n.qt-puxar h4 {\n    color: var(--txt-color);\n}\n\n.qt-puxar strong {\n    color: var(--main-bg-color);\n}\n\n.menu, .box-menu {\n    display: none;\n}\n\n.header h1 {\n    color: var(--txt-color);\n    text-shadow: 0 1px 1px  var(--txt-color);\n}\n\n.header h1 strong {\n    color: var(--main-bg-color);\n    text-shadow: 0 1px 1px  var(--main-bg-color);\n}\n\n.sidebar {\n    grid-area: sidebar;\n    display: flex;\n    justify-content: center;\n    background-color: var(--second-bg-color);\n}\n\n.container-inputs {\n    display: flex;\n    flex-direction: column;\n    justify-content: space-around;\n    align-items: center;\n    width: 80%;\n    height: auto;\n    background-color: var(--two-destac-opacity-color);\n    border: 1px solid var(--two-txt-color);\n    border-radius: 2px;\n    box-shadow: 1px 1px 3px;\n    padding: 5px;\n    margin-bottom: 10px;\n}\n\n.container-inputs input, button {\n    width: 100%;\n    height: 30px;\n    max-height: 33px;\n    border: none;\n    border-radius: 3px;\n    margin-bottom: 9px;\n}\n\n.container-inputs button {\n    width: 100%;\n    height: 35px;\n    max-height: 36px;\n    margin-bottom: 10px;\n}\n\n.container-inputs button:hover {\n    background-color: var(--main-bg-color-hover);\n}\n\n.container-inputs input {\n    box-shadow: 0 10px 10px  var(--second-bg-color);\n}\n\n.container-inputs label {\n    align-self: flex-start;\n    margin-bottom: 3px;\n}\n\n.container-inputs button {\n    margin-top: 15px;\n    background-color: var(--main-bg-color);\n    color: #fff;\n    font-size: larger;\n    box-shadow: 0 1px 2px var(--main-bg-color);\n    cursor: pointer;\n}\n\n.container-inputs button:active {\n    margin-top: 15px;\n    background-color: var(--main-bg-opacity-color);\n    color: #b4bec9;\n}\n\n.body {\n    position: relative;\n    width: 100%;\n    grid-area: body;\n    background-color: var(--bg-list-carga);\n    border: 1px solid var(--main-bg-color);\n    box-shadow: inset 1px 1px 3px;\n    border-radius: 3px;\n    overflow-y: auto;\n}\n\n.dialog-box {\n    display: grid;\n    grid-template-columns: 1fr 1fr 1fr;\n    grid-template-rows: 1fr 1fr;\n    grid-template-areas: \'title title title\'\n                        \'btn-confirm btn-desk-print btn-cancel\';\n    justify-items: center;\n    align-items: center;\n    position: absolute;\n    z-index: 2;\n    left: 50%;\n    top: 40%;\n    background-color: var(--second-bg-opacity-color); \n    border: 2px solid var(--main-bg-color);\n    border-radius: 5px;\n    width: 280px;\n    height: 150px;\n}\n\n.dialog-box h3 {\n    color: var(--txt-color);\n    text-shadow: var(--second-bg-color) 1px 1px 3px;\n    grid-area: title;\n}\n\n.btn-confirm-dialog-box {\n    grid-area: btn-confirm;\n}\n\n.btn-desk-print-dialog-box {\n    grid-area: btn-desk-print;\n}\n\n.btn-cancel-dialog-box {\n    grid-area: btn-cancel;\n}\n\n.dialog-box button {\n    background-color: var(--main-bg-color);\n    color: var(--txt-color);\n    border: 1px solid var(--main-bg-color);\n    border-radius: 5px;\n    box-shadow: var(--main-bg-color) 2px 2px 3px;\n    width: 80px;\n    height: 30px;\n}\n\n.dialog-box button:hover {\n    cursor: pointer;\n}\n\n.dialog-box button:active {\n    background-color: var(--main-bg-opacity-color);\n} \n\n.header-list {\n    display: grid;\n    grid-template-columns: repeat(9, 1fr);\n    justify-items: center;\n    width: 84%;\n    border-bottom: 2px solid var(--main-bg-color);\n    background-color: var(--main-bg-color);\n    color: var(--txt-color);\n    position: fixed;\n    z-index: 1;\n}\n\n.list-data {\n    display: grid;\n    grid-template-columns: 1fr;\n    grid-template-rows: auto;\n    margin-top: 22px;\n}\n\n.list-data-back-day {\n    display: grid;\n    grid-template-columns: 1fr;\n    grid-template-rows: auto;\n    gap: 2px;\n    margin-top: 22px;\n}\n\n.list-data div {\n    display: grid;\n    grid-template-columns: repeat(9, 1fr);\n    grid-template-areas: "fl ag dc co ma pa dt hr tp";\n    justify-items: center;\n    align-items: center;\n    color: var(--two-txt-colorr);\n    border-bottom: 1px solid #00141d31;\n    width: 100%;\n    height: 100%;\n}\n\n.title-cell {\n    display: none;\n}\n\n.line {\n    background-color: var(--one-destac-opacity-color);\n}\n\n.line:hover {\n    cursor: pointer;\n    background-color:  var(--two-destac-color);\n}\n\n.line div {\n    display: flex;\n    border-left: 1px solid var(--main-bg-opacity-color);\n    width: 100%;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n\n.cell {\n    justify-content: center;\n}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \n\n.yellow {\n    background-color: yellow;\n}\n\n.red {\n    background-color: red;\n}\n\n.green {\n    background-color: green;\n}\n\n.material {\n    justify-content: start;\n    padding: 0 0 0 1px;\n}\n\n.id {\n    position: absolute;\n    visibility: hidden;\n    z-index: -3px;\n    height: 1px;\n}\n\n.m-status {\n    display: none;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    gap: 35px;\n    position: absolute;\n    z-index: 7;\n    bottom: 0;\n    width: 100%;\n    height: 90vh;\n    background-color: var(--bg-list-carga);\n}\n\n.box-status-mobile {\n    position: absolute;\n    top: 100px;\n    display: flex;\n    flex-direction: column;\n    gap: 30px;\n}\n\n.m-status div h4, .score {\n    font-size: x-large;\n}\n\n.footer {\n    grid-area: footer;\n    background-color: var(--second-bg-color);\n}\n\n.footer div {\n    display: flex;\n    justify-content: flex-start;\n    align-items: center;\n    gap: 30px;\n    width: 50%;\n    height: 55px;\n}\n\n.footer-box button {\n    width: 200px;\n    height: 30px;\n    background-color: var(--main-bg-color);\n    color: #fff;\n    box-shadow: 0 1px 2px var(--main-bg-color);\n    cursor: pointer; \n    border: none;\n}\n\n.footer-box button:hover {\n    background-color: var(--main-bg-color-hover);\n}\n\n.btn-xlsx {\n    display: none;\n    animation: enable-btn 0.8s ease-in both running;\n}\n\n@keyframes enable-btn {\n    from {\n        opacity: 0;\n    } to {\n        opacity: 10;\n    }\n} \n\n@media (max-width: 950px){\n    .container-main {\n        display: grid;\n        grid-template-columns: .4fr 1fr;\n        grid-template-rows: .3fr 1fr;\n    }\n\n    .header-list h4 {\n        font-size: 12px;\n    }\n\n    .footer-box button {\n        display: none;\n    }\n    \n}\n\n@media (max-width: 700px){\n    .container-main {\n        display: flex;\n        flex-direction: column;\n        position: relative;\n        height: 100vh;\n    }\n\n    .box-info {\n        display: none;\n    }\n\n    .mobile-dialog-box {\n        display: flex;\n        flex-direction: column;\n        justify-content: center;\n        align-items: center;\n        position: absolute;\n        z-index: 15;\n        width: 100%;\n        height: 100vh;\n        animation: dialog-mobal 0.1s ease-in  both running;\n    }\n\n    .mobile-dialog-box h2 {\n        padding: 10px;\n        border-radius: 5px;\n        color: var(--main-bg-color);\n        animation: dialog-mobal-title 0.5s ease-in  both running;  \n    }\n\n    @keyframes dialog-mobal{\n        from {\n            background-color: var(--bg-opacity-dialog-mobal);            \n        } to {\n            background-color: var(--bg-dialog-mobal);\n        } \n    }\n\n    @keyframes dialog-mobal-title {\n        from {\n            color: var(--opacity-color-text-m-dialog-box);           \n        } to {\n            color: var(--color-text-m-dialog-box);           \n        } \n\n    }\n\n    .mobile-dialog-box h2:hover {\n        cursor: pointer;\n        background-color: var(--two-destac-color);\n    }\n\n    .header {\n        position: relative;\n        top: 2;\n        height: 80px;\n        width: 100%;\n    } \n\n    .body {\n        display: none;\n    }\n\n    .s-visible {\n        display: flex;\n    }\n\n    .visible {\n        display: flex;\n        flex-direction: column;\n        position: absolute;\n        z-index: 1;\n        width: 100%;\n        top: 65px;      \n    }   \n   \n    .box-menu {\n        display: none;\n        flex-direction: column;\n        align-items: center;\n        justify-content: center;\n        width: 200px;\n        height: 100vh;\n        background-color: var(--one-destac-opacity-color);\n        position: absolute;\n        z-index: 8;\n        top: 0;\n        right: -200px;\n    }\n\n    .box-menu div {\n        position: absolute;\n        top: 150px;\n        height: 200px;\n    }\n\n    .box-menu div h2 {\n        margin-bottom: 15px;\n        font-size: 20px;\n        padding: 5px;\n        color: var(--main-bg-color);\n        cursor: pointer;\n        border-radius: 5px;\n    }\n\n    .box-menu div h2:hover {\n        background-color: var(--two-destac-color);\n    }\n\n    .menu {\n        display: flex;\n        flex-direction: column;\n        justify-content: space-around;\n        position: absolute;\n        right: 5px;\n        top: 15;\n        margin-right: 7px;\n        width: 22px;\n        height: 22px;\n        padding: 5px;\n        border-radius: 5px;\n        z-index: 10;\n    }\n\n    .animation-box-menu {\n        display: flex;\n        animation: slidein-box 0.2s ease-in  both running;\n    }\n\n    .animation-btn-menu {\n        animation: slidein-menu 0.2s ease-in 0.1s both running;   \n    }\n\n    @keyframes slidein-box {\n        from {\n            right: -200;\n\n        }\n      \n        to {\n          right: 0;\n\n        }\n      }\n\n    @keyframes slidein-menu {\n        from {\n            right: 0;\n        }\n      \n        to {\n          right: 150px;\n        }\n      }      \n\n    .animation-btn-menu .li2 {\n        visibility: hidden;\n    }\n\n    .animation-btn-menu .li1 {\n        background-color: var(--main-bg-color);\n        transform: translatey(5px) rotate(-45deg);\n    }\n\n    .animation-btn-menu .li3 {\n        background-color: var(--main-bg-color);\n        transform: translatey(-9px) rotate(45deg);\n        \n    }\n\n    .menu:hover {\n        cursor: pointer;\n    }\n\n    .menu:active {\n        background-color: #b4bec9;\n    }\n\n    .menu li {\n        width: 100%;\n        height: 3px;\n        border-radius: 5px;\n        background-color: var(--txt-color);\n        z-index: 1;\n        list-style: none;\n    }\n\n    .sidebar {\n        height: 100vh;    \n    }\n\n    .container-inputs {\n        height: 85%;\n    }\n\n    .inp {\n        display: none;\n    }\n\n    .container-inputs input, button {\n        height: 38px;\n        max-height: 45px;\n    }\n\n    .container-title-of-list {\n        border: none;\n    }\n\n    .list-data {\n        overflow-y: scroll;\n        height: 100vh;\n        align-content: flex-start;\n        margin-top: 0;\n        gap: 1px;\n    }\n\n    .header-list {\n        display: none;\n    }\n\n    .list-data .line {\n        display: grid;\n        grid-template-columns: .3fr 1fr;\n        grid-template-rows: repeat(8, 1fr);\n        grid-template-areas: "txt-values fl"\n                             "txt-values ag"\n                             "txt-values dc"\n                             "txt-values ct"\n                             "txt-values mt"\n                             "txt-values pl"\n                             "txt-values dt"\n                             "txt-values hr"\n                             "txt-values tm";\n        height: auto;\n        justify-content: start;\n        position: relative;\n        top: 0;\n        z-index: 1;\n        font-size: 16px;\n    }\n   \n    .container-title-of-list {\n        grid-area: txt-values;\n        display: flex;\n        flex-direction: column;\n        background-color: #002333;\n    }\n\n    .container-title-of-list p {\n        margin-left: 5px;\n        color: var(--txt-color);\n        font-size: larger;\n    }\n\n    .filial {\n        grid-area: fl;\n    }\n\n    .agenda {\n        grid-area: ag;\n    }\n\n    .box {\n        grid-area: dc;\n    }\n\n    .controle {\n        grid-area: ct;\n    }\n\n    .material {\n        grid-area: mt;\n        justify-content: center;\n    }\n    \n    .qt-pallets {\n        grid-area: pl;\n    }\n\n    .data {\n        grid-area: dt;\n    }\n\n    .hora {\n        grid-area: hr;\n    }\n\n    .tempo {\n        grid-area: tm;\n    }\n\n    .id {\n        display: none;\n        border: none;\n        position: absolute;\n        visibility: hidden;\n        z-index: -3px;\n        height: 1px;\n    }    \n\n    .footer {\n        display: none;\n    }\n\n}\n\n@media print {\n    .container-main {\n        display: none;\n    }\n\n    .body-of-print {\n        position: relative;\n        display: grid;\n        justify-items: center;\n        grid-template-columns: 1fr;\n        grid-template-rows: repeat(5, 1fr);\n        width: 100%;\n        height: 500px;\n    }\n\n    .warn, .description {\n        margin-top: 85px;\n        font-size: 80px;\n        font-weight: bold;\n    }\n\n    .body-of-print div {\n        margin-bottom: 15px;\n    }\n\n    div:nth-child(1),\n    div:nth-child(2),\n    div:nth-child(3),\n    div:nth-child(5)\n    div:nth-child(7) {\n        font-size: 75px;\n        font-weight: bold;\n        text-decoration: underline;\n    }\n}',""]);const a=s},645:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,i,o){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(r)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(s[l]=!0)}for(var c=0;c<e.length;c++){var u=[].concat(e[c]);r&&s[u[0]]||(void 0!==o&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=o),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),i&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=i):u[4]="".concat(i)),t.push(u))}},t}},81:e=>{"use strict";e.exports=function(e){return e[1]}},486:function(e,t,n){var r;e=n.nmd(e),function(){var i,o="Expected a function",s="__lodash_hash_undefined__",a="__lodash_placeholder__",l=32,c=128,u=1/0,h=9007199254740991,f=NaN,d=4294967295,p=[["ary",c],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",l],["partialRight",64],["rearg",256]],g="[object Arguments]",m="[object Array]",_="[object Boolean]",v="[object Date]",y="[object Error]",b="[object Function]",w="[object GeneratorFunction]",x="[object Map]",C="[object Number]",S="[object Object]",k="[object Promise]",E="[object RegExp]",T="[object Set]",I="[object String]",A="[object Symbol]",D="[object WeakMap]",N="[object ArrayBuffer]",O="[object DataView]",P="[object Float32Array]",R="[object Float64Array]",M="[object Int8Array]",F="[object Int16Array]",L="[object Int32Array]",j="[object Uint8Array]",z="[object Uint8ClampedArray]",$="[object Uint16Array]",q="[object Uint32Array]",U=/\b__p \+= '';/g,B=/\b(__p \+=) '' \+/g,W=/(__e\(.*?\)|\b__t\)) \+\n'';/g,H=/&(?:amp|lt|gt|quot|#39);/g,V=/[&<>"']/g,Y=RegExp(H.source),G=RegExp(V.source),K=/<%-([\s\S]+?)%>/g,X=/<%([\s\S]+?)%>/g,J=/<%=([\s\S]+?)%>/g,Q=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Z=/^\w*$/,ee=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,te=/[\\^$.*+?()[\]{}|]/g,ne=RegExp(te.source),re=/^\s+/,ie=/\s/,oe=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,se=/\{\n\/\* \[wrapped with (.+)\] \*/,ae=/,? & /,le=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ce=/[()=,{}\[\]\/\s]/,ue=/\\(\\)?/g,he=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,fe=/\w*$/,de=/^[-+]0x[0-9a-f]+$/i,pe=/^0b[01]+$/i,ge=/^\[object .+?Constructor\]$/,me=/^0o[0-7]+$/i,_e=/^(?:0|[1-9]\d*)$/,ve=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ye=/($^)/,be=/['\n\r\u2028\u2029\\]/g,we="\\ud800-\\udfff",xe="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Ce="\\u2700-\\u27bf",Se="a-z\\xdf-\\xf6\\xf8-\\xff",ke="A-Z\\xc0-\\xd6\\xd8-\\xde",Ee="\\ufe0e\\ufe0f",Te="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ie="["+we+"]",Ae="["+Te+"]",De="["+xe+"]",Ne="\\d+",Oe="["+Ce+"]",Pe="["+Se+"]",Re="[^"+we+Te+Ne+Ce+Se+ke+"]",Me="\\ud83c[\\udffb-\\udfff]",Fe="[^"+we+"]",Le="(?:\\ud83c[\\udde6-\\uddff]){2}",je="[\\ud800-\\udbff][\\udc00-\\udfff]",ze="["+ke+"]",$e="\\u200d",qe="(?:"+Pe+"|"+Re+")",Ue="(?:"+ze+"|"+Re+")",Be="(?:['’](?:d|ll|m|re|s|t|ve))?",We="(?:['’](?:D|LL|M|RE|S|T|VE))?",He="(?:"+De+"|"+Me+")?",Ve="["+Ee+"]?",Ye=Ve+He+"(?:"+$e+"(?:"+[Fe,Le,je].join("|")+")"+Ve+He+")*",Ge="(?:"+[Oe,Le,je].join("|")+")"+Ye,Ke="(?:"+[Fe+De+"?",De,Le,je,Ie].join("|")+")",Xe=RegExp("['’]","g"),Je=RegExp(De,"g"),Qe=RegExp(Me+"(?="+Me+")|"+Ke+Ye,"g"),Ze=RegExp([ze+"?"+Pe+"+"+Be+"(?="+[Ae,ze,"$"].join("|")+")",Ue+"+"+We+"(?="+[Ae,ze+qe,"$"].join("|")+")",ze+"?"+qe+"+"+Be,ze+"+"+We,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ne,Ge].join("|"),"g"),et=RegExp("["+$e+we+xe+Ee+"]"),tt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,nt=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],rt=-1,it={};it[P]=it[R]=it[M]=it[F]=it[L]=it[j]=it[z]=it[$]=it[q]=!0,it[g]=it[m]=it[N]=it[_]=it[O]=it[v]=it[y]=it[b]=it[x]=it[C]=it[S]=it[E]=it[T]=it[I]=it[D]=!1;var ot={};ot[g]=ot[m]=ot[N]=ot[O]=ot[_]=ot[v]=ot[P]=ot[R]=ot[M]=ot[F]=ot[L]=ot[x]=ot[C]=ot[S]=ot[E]=ot[T]=ot[I]=ot[A]=ot[j]=ot[z]=ot[$]=ot[q]=!0,ot[y]=ot[b]=ot[D]=!1;var st={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},at=parseFloat,lt=parseInt,ct="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,ut="object"==typeof self&&self&&self.Object===Object&&self,ht=ct||ut||Function("return this")(),ft=t&&!t.nodeType&&t,dt=ft&&e&&!e.nodeType&&e,pt=dt&&dt.exports===ft,gt=pt&&ct.process,mt=function(){try{return dt&&dt.require&&dt.require("util").types||gt&&gt.binding&&gt.binding("util")}catch(e){}}(),_t=mt&&mt.isArrayBuffer,vt=mt&&mt.isDate,yt=mt&&mt.isMap,bt=mt&&mt.isRegExp,wt=mt&&mt.isSet,xt=mt&&mt.isTypedArray;function Ct(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function St(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var s=e[i];t(r,s,n(s),e)}return r}function kt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function Et(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function Tt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function It(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var s=e[n];t(s,n,e)&&(o[i++]=s)}return o}function At(e,t){return!(null==e||!e.length)&&zt(e,t,0)>-1}function Dt(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function Nt(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function Ot(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function Pt(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function Rt(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function Mt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var Ft=Bt("length");function Lt(e,t,n){var r;return n(e,(function(e,n,i){if(t(e,n,i))return r=n,!1})),r}function jt(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function zt(e,t,n){return t==t?function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):jt(e,qt,n)}function $t(e,t,n,r){for(var i=n-1,o=e.length;++i<o;)if(r(e[i],t))return i;return-1}function qt(e){return e!=e}function Ut(e,t){var n=null==e?0:e.length;return n?Vt(e,t)/n:f}function Bt(e){return function(t){return null==t?i:t[e]}}function Wt(e){return function(t){return null==e?i:e[t]}}function Ht(e,t,n,r,i){return i(e,(function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)})),n}function Vt(e,t){for(var n,r=-1,o=e.length;++r<o;){var s=t(e[r]);s!==i&&(n=n===i?s:n+s)}return n}function Yt(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function Gt(e){return e?e.slice(0,fn(e)+1).replace(re,""):e}function Kt(e){return function(t){return e(t)}}function Xt(e,t){return Nt(t,(function(t){return e[t]}))}function Jt(e,t){return e.has(t)}function Qt(e,t){for(var n=-1,r=e.length;++n<r&&zt(t,e[n],0)>-1;);return n}function Zt(e,t){for(var n=e.length;n--&&zt(t,e[n],0)>-1;);return n}var en=Wt({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"}),tn=Wt({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function nn(e){return"\\"+st[e]}function rn(e){return et.test(e)}function on(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function sn(e,t){return function(n){return e(t(n))}}function an(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var s=e[n];s!==t&&s!==a||(e[n]=a,o[i++]=n)}return o}function ln(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}function cn(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=[e,e]})),n}function un(e){return rn(e)?function(e){for(var t=Qe.lastIndex=0;Qe.test(e);)++t;return t}(e):Ft(e)}function hn(e){return rn(e)?function(e){return e.match(Qe)||[]}(e):function(e){return e.split("")}(e)}function fn(e){for(var t=e.length;t--&&ie.test(e.charAt(t)););return t}var dn=Wt({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),pn=function e(t){var n,r=(t=null==t?ht:pn.defaults(ht.Object(),t,pn.pick(ht,nt))).Array,ie=t.Date,we=t.Error,xe=t.Function,Ce=t.Math,Se=t.Object,ke=t.RegExp,Ee=t.String,Te=t.TypeError,Ie=r.prototype,Ae=xe.prototype,De=Se.prototype,Ne=t["__core-js_shared__"],Oe=Ae.toString,Pe=De.hasOwnProperty,Re=0,Me=(n=/[^.]+$/.exec(Ne&&Ne.keys&&Ne.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",Fe=De.toString,Le=Oe.call(Se),je=ht._,ze=ke("^"+Oe.call(Pe).replace(te,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),$e=pt?t.Buffer:i,qe=t.Symbol,Ue=t.Uint8Array,Be=$e?$e.allocUnsafe:i,We=sn(Se.getPrototypeOf,Se),He=Se.create,Ve=De.propertyIsEnumerable,Ye=Ie.splice,Ge=qe?qe.isConcatSpreadable:i,Ke=qe?qe.iterator:i,Qe=qe?qe.toStringTag:i,et=function(){try{var e=lo(Se,"defineProperty");return e({},"",{}),e}catch(e){}}(),st=t.clearTimeout!==ht.clearTimeout&&t.clearTimeout,ct=ie&&ie.now!==ht.Date.now&&ie.now,ut=t.setTimeout!==ht.setTimeout&&t.setTimeout,ft=Ce.ceil,dt=Ce.floor,gt=Se.getOwnPropertySymbols,mt=$e?$e.isBuffer:i,Ft=t.isFinite,Wt=Ie.join,gn=sn(Se.keys,Se),mn=Ce.max,_n=Ce.min,vn=ie.now,yn=t.parseInt,bn=Ce.random,wn=Ie.reverse,xn=lo(t,"DataView"),Cn=lo(t,"Map"),Sn=lo(t,"Promise"),kn=lo(t,"Set"),En=lo(t,"WeakMap"),Tn=lo(Se,"create"),In=En&&new En,An={},Dn=Lo(xn),Nn=Lo(Cn),On=Lo(Sn),Pn=Lo(kn),Rn=Lo(En),Mn=qe?qe.prototype:i,Fn=Mn?Mn.valueOf:i,Ln=Mn?Mn.toString:i;function jn(e){if(ea(e)&&!Bs(e)&&!(e instanceof Un)){if(e instanceof qn)return e;if(Pe.call(e,"__wrapped__"))return jo(e)}return new qn(e)}var zn=function(){function e(){}return function(t){if(!Zs(t))return{};if(He)return He(t);e.prototype=t;var n=new e;return e.prototype=i,n}}();function $n(){}function qn(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=i}function Un(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=d,this.__views__=[]}function Bn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Wn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Hn(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Vn(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Hn;++t<n;)this.add(e[t])}function Yn(e){var t=this.__data__=new Wn(e);this.size=t.size}function Gn(e,t){var n=Bs(e),r=!n&&Us(e),i=!n&&!r&&Ys(e),o=!n&&!r&&!i&&la(e),s=n||r||i||o,a=s?Yt(e.length,Ee):[],l=a.length;for(var c in e)!t&&!Pe.call(e,c)||s&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||mo(c,l))||a.push(c);return a}function Kn(e){var t=e.length;return t?e[Hr(0,t-1)]:i}function Xn(e,t){return Oo(Ei(e),or(t,0,e.length))}function Jn(e){return Oo(Ei(e))}function Qn(e,t,n){(n!==i&&!zs(e[t],n)||n===i&&!(t in e))&&rr(e,t,n)}function Zn(e,t,n){var r=e[t];Pe.call(e,t)&&zs(r,n)&&(n!==i||t in e)||rr(e,t,n)}function er(e,t){for(var n=e.length;n--;)if(zs(e[n][0],t))return n;return-1}function tr(e,t,n,r){return ur(e,(function(e,i,o){t(r,e,n(e),o)})),r}function nr(e,t){return e&&Ti(t,Da(t),e)}function rr(e,t,n){"__proto__"==t&&et?et(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function ir(e,t){for(var n=-1,o=t.length,s=r(o),a=null==e;++n<o;)s[n]=a?i:ka(e,t[n]);return s}function or(e,t,n){return e==e&&(n!==i&&(e=e<=n?e:n),t!==i&&(e=e>=t?e:t)),e}function sr(e,t,n,r,o,s){var a,l=1&t,c=2&t,u=4&t;if(n&&(a=o?n(e,r,o,s):n(e)),a!==i)return a;if(!Zs(e))return e;var h=Bs(e);if(h){if(a=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&Pe.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!l)return Ei(e,a)}else{var f=ho(e),d=f==b||f==w;if(Ys(e))return bi(e,l);if(f==S||f==g||d&&!o){if(a=c||d?{}:po(e),!l)return c?function(e,t){return Ti(e,uo(e),t)}(e,function(e,t){return e&&Ti(t,Na(t),e)}(a,e)):function(e,t){return Ti(e,co(e),t)}(e,nr(a,e))}else{if(!ot[f])return o?e:{};a=function(e,t,n){var r,i=e.constructor;switch(t){case N:return wi(e);case _:case v:return new i(+e);case O:return function(e,t){var n=t?wi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case P:case R:case M:case F:case L:case j:case z:case $:case q:return xi(e,n);case x:return new i;case C:case I:return new i(e);case E:return function(e){var t=new e.constructor(e.source,fe.exec(e));return t.lastIndex=e.lastIndex,t}(e);case T:return new i;case A:return r=e,Fn?Se(Fn.call(r)):{}}}(e,f,l)}}s||(s=new Yn);var p=s.get(e);if(p)return p;s.set(e,a),oa(e)?e.forEach((function(r){a.add(sr(r,t,n,r,e,s))})):ta(e)&&e.forEach((function(r,i){a.set(i,sr(r,t,n,i,e,s))}));var m=h?i:(u?c?to:eo:c?Na:Da)(e);return kt(m||e,(function(r,i){m&&(r=e[i=r]),Zn(a,i,sr(r,t,n,i,e,s))})),a}function ar(e,t,n){var r=n.length;if(null==e)return!r;for(e=Se(e);r--;){var o=n[r],s=t[o],a=e[o];if(a===i&&!(o in e)||!s(a))return!1}return!0}function lr(e,t,n){if("function"!=typeof e)throw new Te(o);return Io((function(){e.apply(i,n)}),t)}function cr(e,t,n,r){var i=-1,o=At,s=!0,a=e.length,l=[],c=t.length;if(!a)return l;n&&(t=Nt(t,Kt(n))),r?(o=Dt,s=!1):t.length>=200&&(o=Jt,s=!1,t=new Vn(t));e:for(;++i<a;){var u=e[i],h=null==n?u:n(u);if(u=r||0!==u?u:0,s&&h==h){for(var f=c;f--;)if(t[f]===h)continue e;l.push(u)}else o(t,h,r)||l.push(u)}return l}jn.templateSettings={escape:K,evaluate:X,interpolate:J,variable:"",imports:{_:jn}},jn.prototype=$n.prototype,jn.prototype.constructor=jn,qn.prototype=zn($n.prototype),qn.prototype.constructor=qn,Un.prototype=zn($n.prototype),Un.prototype.constructor=Un,Bn.prototype.clear=function(){this.__data__=Tn?Tn(null):{},this.size=0},Bn.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Bn.prototype.get=function(e){var t=this.__data__;if(Tn){var n=t[e];return n===s?i:n}return Pe.call(t,e)?t[e]:i},Bn.prototype.has=function(e){var t=this.__data__;return Tn?t[e]!==i:Pe.call(t,e)},Bn.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Tn&&t===i?s:t,this},Wn.prototype.clear=function(){this.__data__=[],this.size=0},Wn.prototype.delete=function(e){var t=this.__data__,n=er(t,e);return!(n<0||(n==t.length-1?t.pop():Ye.call(t,n,1),--this.size,0))},Wn.prototype.get=function(e){var t=this.__data__,n=er(t,e);return n<0?i:t[n][1]},Wn.prototype.has=function(e){return er(this.__data__,e)>-1},Wn.prototype.set=function(e,t){var n=this.__data__,r=er(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},Hn.prototype.clear=function(){this.size=0,this.__data__={hash:new Bn,map:new(Cn||Wn),string:new Bn}},Hn.prototype.delete=function(e){var t=so(this,e).delete(e);return this.size-=t?1:0,t},Hn.prototype.get=function(e){return so(this,e).get(e)},Hn.prototype.has=function(e){return so(this,e).has(e)},Hn.prototype.set=function(e,t){var n=so(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Vn.prototype.add=Vn.prototype.push=function(e){return this.__data__.set(e,s),this},Vn.prototype.has=function(e){return this.__data__.has(e)},Yn.prototype.clear=function(){this.__data__=new Wn,this.size=0},Yn.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Yn.prototype.get=function(e){return this.__data__.get(e)},Yn.prototype.has=function(e){return this.__data__.has(e)},Yn.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Wn){var r=n.__data__;if(!Cn||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Hn(r)}return n.set(e,t),this.size=n.size,this};var ur=Di(vr),hr=Di(yr,!0);function fr(e,t){var n=!0;return ur(e,(function(e,r,i){return n=!!t(e,r,i)})),n}function dr(e,t,n){for(var r=-1,o=e.length;++r<o;){var s=e[r],a=t(s);if(null!=a&&(l===i?a==a&&!aa(a):n(a,l)))var l=a,c=s}return c}function pr(e,t){var n=[];return ur(e,(function(e,r,i){t(e,r,i)&&n.push(e)})),n}function gr(e,t,n,r,i){var o=-1,s=e.length;for(n||(n=go),i||(i=[]);++o<s;){var a=e[o];t>0&&n(a)?t>1?gr(a,t-1,n,r,i):Ot(i,a):r||(i[i.length]=a)}return i}var mr=Ni(),_r=Ni(!0);function vr(e,t){return e&&mr(e,t,Da)}function yr(e,t){return e&&_r(e,t,Da)}function br(e,t){return It(t,(function(t){return Xs(e[t])}))}function wr(e,t){for(var n=0,r=(t=mi(t,e)).length;null!=e&&n<r;)e=e[Fo(t[n++])];return n&&n==r?e:i}function xr(e,t,n){var r=t(e);return Bs(e)?r:Ot(r,n(e))}function Cr(e){return null==e?e===i?"[object Undefined]":"[object Null]":Qe&&Qe in Se(e)?function(e){var t=Pe.call(e,Qe),n=e[Qe];try{e[Qe]=i;var r=!0}catch(e){}var o=Fe.call(e);return r&&(t?e[Qe]=n:delete e[Qe]),o}(e):function(e){return Fe.call(e)}(e)}function Sr(e,t){return e>t}function kr(e,t){return null!=e&&Pe.call(e,t)}function Er(e,t){return null!=e&&t in Se(e)}function Tr(e,t,n){for(var o=n?Dt:At,s=e[0].length,a=e.length,l=a,c=r(a),u=1/0,h=[];l--;){var f=e[l];l&&t&&(f=Nt(f,Kt(t))),u=_n(f.length,u),c[l]=!n&&(t||s>=120&&f.length>=120)?new Vn(l&&f):i}f=e[0];var d=-1,p=c[0];e:for(;++d<s&&h.length<u;){var g=f[d],m=t?t(g):g;if(g=n||0!==g?g:0,!(p?Jt(p,m):o(h,m,n))){for(l=a;--l;){var _=c[l];if(!(_?Jt(_,m):o(e[l],m,n)))continue e}p&&p.push(m),h.push(g)}}return h}function Ir(e,t,n){var r=null==(e=ko(e,t=mi(t,e)))?e:e[Fo(Ko(t))];return null==r?i:Ct(r,e,n)}function Ar(e){return ea(e)&&Cr(e)==g}function Dr(e,t,n,r,o){return e===t||(null==e||null==t||!ea(e)&&!ea(t)?e!=e&&t!=t:function(e,t,n,r,o,s){var a=Bs(e),l=Bs(t),c=a?m:ho(e),u=l?m:ho(t),h=(c=c==g?S:c)==S,f=(u=u==g?S:u)==S,d=c==u;if(d&&Ys(e)){if(!Ys(t))return!1;a=!0,h=!1}if(d&&!h)return s||(s=new Yn),a||la(e)?Qi(e,t,n,r,o,s):function(e,t,n,r,i,o,s){switch(n){case O:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case N:return!(e.byteLength!=t.byteLength||!o(new Ue(e),new Ue(t)));case _:case v:case C:return zs(+e,+t);case y:return e.name==t.name&&e.message==t.message;case E:case I:return e==t+"";case x:var a=on;case T:var l=1&r;if(a||(a=ln),e.size!=t.size&&!l)return!1;var c=s.get(e);if(c)return c==t;r|=2,s.set(e,t);var u=Qi(a(e),a(t),r,i,o,s);return s.delete(e),u;case A:if(Fn)return Fn.call(e)==Fn.call(t)}return!1}(e,t,c,n,r,o,s);if(!(1&n)){var p=h&&Pe.call(e,"__wrapped__"),b=f&&Pe.call(t,"__wrapped__");if(p||b){var w=p?e.value():e,k=b?t.value():t;return s||(s=new Yn),o(w,k,n,r,s)}}return!!d&&(s||(s=new Yn),function(e,t,n,r,o,s){var a=1&n,l=eo(e),c=l.length;if(c!=eo(t).length&&!a)return!1;for(var u=c;u--;){var h=l[u];if(!(a?h in t:Pe.call(t,h)))return!1}var f=s.get(e),d=s.get(t);if(f&&d)return f==t&&d==e;var p=!0;s.set(e,t),s.set(t,e);for(var g=a;++u<c;){var m=e[h=l[u]],_=t[h];if(r)var v=a?r(_,m,h,t,e,s):r(m,_,h,e,t,s);if(!(v===i?m===_||o(m,_,n,r,s):v)){p=!1;break}g||(g="constructor"==h)}if(p&&!g){var y=e.constructor,b=t.constructor;y==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b||(p=!1)}return s.delete(e),s.delete(t),p}(e,t,n,r,o,s))}(e,t,n,r,Dr,o))}function Nr(e,t,n,r){var o=n.length,s=o,a=!r;if(null==e)return!s;for(e=Se(e);o--;){var l=n[o];if(a&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++o<s;){var c=(l=n[o])[0],u=e[c],h=l[1];if(a&&l[2]){if(u===i&&!(c in e))return!1}else{var f=new Yn;if(r)var d=r(u,h,c,e,t,f);if(!(d===i?Dr(h,u,3,r,f):d))return!1}}return!0}function Or(e){return!(!Zs(e)||(t=e,Me&&Me in t))&&(Xs(e)?ze:ge).test(Lo(e));var t}function Pr(e){return"function"==typeof e?e:null==e?nl:"object"==typeof e?Bs(e)?jr(e[0],e[1]):Lr(e):hl(e)}function Rr(e){if(!wo(e))return gn(e);var t=[];for(var n in Se(e))Pe.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Mr(e,t){return e<t}function Fr(e,t){var n=-1,i=Hs(e)?r(e.length):[];return ur(e,(function(e,r,o){i[++n]=t(e,r,o)})),i}function Lr(e){var t=ao(e);return 1==t.length&&t[0][2]?Co(t[0][0],t[0][1]):function(n){return n===e||Nr(n,e,t)}}function jr(e,t){return vo(e)&&xo(t)?Co(Fo(e),t):function(n){var r=ka(n,e);return r===i&&r===t?Ea(n,e):Dr(t,r,3)}}function zr(e,t,n,r,o){e!==t&&mr(t,(function(s,a){if(o||(o=new Yn),Zs(s))!function(e,t,n,r,o,s,a){var l=Eo(e,n),c=Eo(t,n),u=a.get(c);if(u)Qn(e,n,u);else{var h=s?s(l,c,n+"",e,t,a):i,f=h===i;if(f){var d=Bs(c),p=!d&&Ys(c),g=!d&&!p&&la(c);h=c,d||p||g?Bs(l)?h=l:Vs(l)?h=Ei(l):p?(f=!1,h=bi(c,!0)):g?(f=!1,h=xi(c,!0)):h=[]:ra(c)||Us(c)?(h=l,Us(l)?h=ma(l):Zs(l)&&!Xs(l)||(h=po(c))):f=!1}f&&(a.set(c,h),o(h,c,r,s,a),a.delete(c)),Qn(e,n,h)}}(e,t,a,n,zr,r,o);else{var l=r?r(Eo(e,a),s,a+"",e,t,o):i;l===i&&(l=s),Qn(e,a,l)}}),Na)}function $r(e,t){var n=e.length;if(n)return mo(t+=t<0?n:0,n)?e[t]:i}function qr(e,t,n){t=t.length?Nt(t,(function(e){return Bs(e)?function(t){return wr(t,1===e.length?e[0]:e)}:e})):[nl];var r=-1;t=Nt(t,Kt(oo()));var i=Fr(e,(function(e,n,i){var o=Nt(t,(function(t){return t(e)}));return{criteria:o,index:++r,value:e}}));return function(e,t){var r=e.length;for(e.sort((function(e,t){return function(e,t,n){for(var r=-1,i=e.criteria,o=t.criteria,s=i.length,a=n.length;++r<s;){var l=Ci(i[r],o[r]);if(l)return r>=a?l:l*("desc"==n[r]?-1:1)}return e.index-t.index}(e,t,n)}));r--;)e[r]=e[r].value;return e}(i)}function Ur(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var s=t[r],a=wr(e,s);n(a,s)&&Xr(o,mi(s,e),a)}return o}function Br(e,t,n,r){var i=r?$t:zt,o=-1,s=t.length,a=e;for(e===t&&(t=Ei(t)),n&&(a=Nt(e,Kt(n)));++o<s;)for(var l=0,c=t[o],u=n?n(c):c;(l=i(a,u,l,r))>-1;)a!==e&&Ye.call(a,l,1),Ye.call(e,l,1);return e}function Wr(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==o){var o=i;mo(i)?Ye.call(e,i,1):li(e,i)}}return e}function Hr(e,t){return e+dt(bn()*(t-e+1))}function Vr(e,t){var n="";if(!e||t<1||t>h)return n;do{t%2&&(n+=e),(t=dt(t/2))&&(e+=e)}while(t);return n}function Yr(e,t){return Ao(So(e,t,nl),e+"")}function Gr(e){return Kn(za(e))}function Kr(e,t){var n=za(e);return Oo(n,or(t,0,n.length))}function Xr(e,t,n,r){if(!Zs(e))return e;for(var o=-1,s=(t=mi(t,e)).length,a=s-1,l=e;null!=l&&++o<s;){var c=Fo(t[o]),u=n;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(o!=a){var h=l[c];(u=r?r(h,c,l):i)===i&&(u=Zs(h)?h:mo(t[o+1])?[]:{})}Zn(l,c,u),l=l[c]}return e}var Jr=In?function(e,t){return In.set(e,t),e}:nl,Qr=et?function(e,t){return et(e,"toString",{configurable:!0,enumerable:!1,value:Za(t),writable:!0})}:nl;function Zr(e){return Oo(za(e))}function ei(e,t,n){var i=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var s=r(o);++i<o;)s[i]=e[i+t];return s}function ti(e,t){var n;return ur(e,(function(e,r,i){return!(n=t(e,r,i))})),!!n}function ni(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t==t&&i<=2147483647){for(;r<i;){var o=r+i>>>1,s=e[o];null!==s&&!aa(s)&&(n?s<=t:s<t)?r=o+1:i=o}return i}return ri(e,t,nl,n)}function ri(e,t,n,r){var o=0,s=null==e?0:e.length;if(0===s)return 0;for(var a=(t=n(t))!=t,l=null===t,c=aa(t),u=t===i;o<s;){var h=dt((o+s)/2),f=n(e[h]),d=f!==i,p=null===f,g=f==f,m=aa(f);if(a)var _=r||g;else _=u?g&&(r||d):l?g&&d&&(r||!p):c?g&&d&&!p&&(r||!m):!p&&!m&&(r?f<=t:f<t);_?o=h+1:s=h}return _n(s,4294967294)}function ii(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var s=e[n],a=t?t(s):s;if(!n||!zs(a,l)){var l=a;o[i++]=0===s?0:s}}return o}function oi(e){return"number"==typeof e?e:aa(e)?f:+e}function si(e){if("string"==typeof e)return e;if(Bs(e))return Nt(e,si)+"";if(aa(e))return Ln?Ln.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function ai(e,t,n){var r=-1,i=At,o=e.length,s=!0,a=[],l=a;if(n)s=!1,i=Dt;else if(o>=200){var c=t?null:Vi(e);if(c)return ln(c);s=!1,i=Jt,l=new Vn}else l=t?[]:a;e:for(;++r<o;){var u=e[r],h=t?t(u):u;if(u=n||0!==u?u:0,s&&h==h){for(var f=l.length;f--;)if(l[f]===h)continue e;t&&l.push(h),a.push(u)}else i(l,h,n)||(l!==a&&l.push(h),a.push(u))}return a}function li(e,t){return null==(e=ko(e,t=mi(t,e)))||delete e[Fo(Ko(t))]}function ci(e,t,n,r){return Xr(e,t,n(wr(e,t)),r)}function ui(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?ei(e,r?0:o,r?o+1:i):ei(e,r?o+1:0,r?i:o)}function hi(e,t){var n=e;return n instanceof Un&&(n=n.value()),Pt(t,(function(e,t){return t.func.apply(t.thisArg,Ot([e],t.args))}),n)}function fi(e,t,n){var i=e.length;if(i<2)return i?ai(e[0]):[];for(var o=-1,s=r(i);++o<i;)for(var a=e[o],l=-1;++l<i;)l!=o&&(s[o]=cr(s[o]||a,e[l],t,n));return ai(gr(s,1),t,n)}function di(e,t,n){for(var r=-1,o=e.length,s=t.length,a={};++r<o;){var l=r<s?t[r]:i;n(a,e[r],l)}return a}function pi(e){return Vs(e)?e:[]}function gi(e){return"function"==typeof e?e:nl}function mi(e,t){return Bs(e)?e:vo(e,t)?[e]:Mo(_a(e))}var _i=Yr;function vi(e,t,n){var r=e.length;return n=n===i?r:n,!t&&n>=r?e:ei(e,t,n)}var yi=st||function(e){return ht.clearTimeout(e)};function bi(e,t){if(t)return e.slice();var n=e.length,r=Be?Be(n):new e.constructor(n);return e.copy(r),r}function wi(e){var t=new e.constructor(e.byteLength);return new Ue(t).set(new Ue(e)),t}function xi(e,t){var n=t?wi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Ci(e,t){if(e!==t){var n=e!==i,r=null===e,o=e==e,s=aa(e),a=t!==i,l=null===t,c=t==t,u=aa(t);if(!l&&!u&&!s&&e>t||s&&a&&c&&!l&&!u||r&&a&&c||!n&&c||!o)return 1;if(!r&&!s&&!u&&e<t||u&&n&&o&&!r&&!s||l&&n&&o||!a&&o||!c)return-1}return 0}function Si(e,t,n,i){for(var o=-1,s=e.length,a=n.length,l=-1,c=t.length,u=mn(s-a,0),h=r(c+u),f=!i;++l<c;)h[l]=t[l];for(;++o<a;)(f||o<s)&&(h[n[o]]=e[o]);for(;u--;)h[l++]=e[o++];return h}function ki(e,t,n,i){for(var o=-1,s=e.length,a=-1,l=n.length,c=-1,u=t.length,h=mn(s-l,0),f=r(h+u),d=!i;++o<h;)f[o]=e[o];for(var p=o;++c<u;)f[p+c]=t[c];for(;++a<l;)(d||o<s)&&(f[p+n[a]]=e[o++]);return f}function Ei(e,t){var n=-1,i=e.length;for(t||(t=r(i));++n<i;)t[n]=e[n];return t}function Ti(e,t,n,r){var o=!n;n||(n={});for(var s=-1,a=t.length;++s<a;){var l=t[s],c=r?r(n[l],e[l],l,n,e):i;c===i&&(c=e[l]),o?rr(n,l,c):Zn(n,l,c)}return n}function Ii(e,t){return function(n,r){var i=Bs(n)?St:tr,o=t?t():{};return i(n,e,oo(r,2),o)}}function Ai(e){return Yr((function(t,n){var r=-1,o=n.length,s=o>1?n[o-1]:i,a=o>2?n[2]:i;for(s=e.length>3&&"function"==typeof s?(o--,s):i,a&&_o(n[0],n[1],a)&&(s=o<3?i:s,o=1),t=Se(t);++r<o;){var l=n[r];l&&e(t,l,r,s)}return t}))}function Di(e,t){return function(n,r){if(null==n)return n;if(!Hs(n))return e(n,r);for(var i=n.length,o=t?i:-1,s=Se(n);(t?o--:++o<i)&&!1!==r(s[o],o,s););return n}}function Ni(e){return function(t,n,r){for(var i=-1,o=Se(t),s=r(t),a=s.length;a--;){var l=s[e?a:++i];if(!1===n(o[l],l,o))break}return t}}function Oi(e){return function(t){var n=rn(t=_a(t))?hn(t):i,r=n?n[0]:t.charAt(0),o=n?vi(n,1).join(""):t.slice(1);return r[e]()+o}}function Pi(e){return function(t){return Pt(Xa(Ua(t).replace(Xe,"")),e,"")}}function Ri(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=zn(e.prototype),r=e.apply(n,t);return Zs(r)?r:n}}function Mi(e){return function(t,n,r){var o=Se(t);if(!Hs(t)){var s=oo(n,3);t=Da(t),n=function(e){return s(o[e],e,o)}}var a=e(t,n,r);return a>-1?o[s?t[a]:a]:i}}function Fi(e){return Zi((function(t){var n=t.length,r=n,s=qn.prototype.thru;for(e&&t.reverse();r--;){var a=t[r];if("function"!=typeof a)throw new Te(o);if(s&&!l&&"wrapper"==ro(a))var l=new qn([],!0)}for(r=l?r:n;++r<n;){var c=ro(a=t[r]),u="wrapper"==c?no(a):i;l=u&&yo(u[0])&&424==u[1]&&!u[4].length&&1==u[9]?l[ro(u[0])].apply(l,u[3]):1==a.length&&yo(a)?l[c]():l.thru(a)}return function(){var e=arguments,r=e[0];if(l&&1==e.length&&Bs(r))return l.plant(r).value();for(var i=0,o=n?t[i].apply(this,e):r;++i<n;)o=t[i].call(this,o);return o}}))}function Li(e,t,n,o,s,a,l,u,h,f){var d=t&c,p=1&t,g=2&t,m=24&t,_=512&t,v=g?i:Ri(e);return function c(){for(var y=arguments.length,b=r(y),w=y;w--;)b[w]=arguments[w];if(m)var x=io(c),C=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}(b,x);if(o&&(b=Si(b,o,s,m)),a&&(b=ki(b,a,l,m)),y-=C,m&&y<f){var S=an(b,x);return Wi(e,t,Li,c.placeholder,n,b,S,u,h,f-y)}var k=p?n:this,E=g?k[e]:e;return y=b.length,u?b=function(e,t){for(var n=e.length,r=_n(t.length,n),o=Ei(e);r--;){var s=t[r];e[r]=mo(s,n)?o[s]:i}return e}(b,u):_&&y>1&&b.reverse(),d&&h<y&&(b.length=h),this&&this!==ht&&this instanceof c&&(E=v||Ri(E)),E.apply(k,b)}}function ji(e,t){return function(n,r){return function(e,t,n,r){return vr(e,(function(e,i,o){t(r,n(e),i,o)})),r}(n,e,t(r),{})}}function zi(e,t){return function(n,r){var o;if(n===i&&r===i)return t;if(n!==i&&(o=n),r!==i){if(o===i)return r;"string"==typeof n||"string"==typeof r?(n=si(n),r=si(r)):(n=oi(n),r=oi(r)),o=e(n,r)}return o}}function $i(e){return Zi((function(t){return t=Nt(t,Kt(oo())),Yr((function(n){var r=this;return e(t,(function(e){return Ct(e,r,n)}))}))}))}function qi(e,t){var n=(t=t===i?" ":si(t)).length;if(n<2)return n?Vr(t,e):t;var r=Vr(t,ft(e/un(t)));return rn(t)?vi(hn(r),0,e).join(""):r.slice(0,e)}function Ui(e){return function(t,n,o){return o&&"number"!=typeof o&&_o(t,n,o)&&(n=o=i),t=fa(t),n===i?(n=t,t=0):n=fa(n),function(e,t,n,i){for(var o=-1,s=mn(ft((t-e)/(n||1)),0),a=r(s);s--;)a[i?s:++o]=e,e+=n;return a}(t,n,o=o===i?t<n?1:-1:fa(o),e)}}function Bi(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=ga(t),n=ga(n)),e(t,n)}}function Wi(e,t,n,r,o,s,a,c,u,h){var f=8&t;t|=f?l:64,4&(t&=~(f?64:l))||(t&=-4);var d=[e,t,o,f?s:i,f?a:i,f?i:s,f?i:a,c,u,h],p=n.apply(i,d);return yo(e)&&To(p,d),p.placeholder=r,Do(p,e,t)}function Hi(e){var t=Ce[e];return function(e,n){if(e=ga(e),(n=null==n?0:_n(da(n),292))&&Ft(e)){var r=(_a(e)+"e").split("e");return+((r=(_a(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var Vi=kn&&1/ln(new kn([,-0]))[1]==u?function(e){return new kn(e)}:al;function Yi(e){return function(t){var n=ho(t);return n==x?on(t):n==T?cn(t):function(e,t){return Nt(t,(function(t){return[t,e[t]]}))}(t,e(t))}}function Gi(e,t,n,s,u,h,f,d){var p=2&t;if(!p&&"function"!=typeof e)throw new Te(o);var g=s?s.length:0;if(g||(t&=-97,s=u=i),f=f===i?f:mn(da(f),0),d=d===i?d:da(d),g-=u?u.length:0,64&t){var m=s,_=u;s=u=i}var v=p?i:no(e),y=[e,t,n,s,u,m,_,h,f,d];if(v&&function(e,t){var n=e[1],r=t[1],i=n|r,o=i<131,s=r==c&&8==n||r==c&&256==n&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(!o&&!s)return e;1&r&&(e[2]=t[2],i|=1&n?0:4);var l=t[3];if(l){var u=e[3];e[3]=u?Si(u,l,t[4]):l,e[4]=u?an(e[3],a):t[4]}(l=t[5])&&(u=e[5],e[5]=u?ki(u,l,t[6]):l,e[6]=u?an(e[5],a):t[6]),(l=t[7])&&(e[7]=l),r&c&&(e[8]=null==e[8]?t[8]:_n(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i}(y,v),e=y[0],t=y[1],n=y[2],s=y[3],u=y[4],!(d=y[9]=y[9]===i?p?0:e.length:mn(y[9]-g,0))&&24&t&&(t&=-25),t&&1!=t)b=8==t||16==t?function(e,t,n){var o=Ri(e);return function s(){for(var a=arguments.length,l=r(a),c=a,u=io(s);c--;)l[c]=arguments[c];var h=a<3&&l[0]!==u&&l[a-1]!==u?[]:an(l,u);return(a-=h.length)<n?Wi(e,t,Li,s.placeholder,i,l,h,i,i,n-a):Ct(this&&this!==ht&&this instanceof s?o:e,this,l)}}(e,t,d):t!=l&&33!=t||u.length?Li.apply(i,y):function(e,t,n,i){var o=1&t,s=Ri(e);return function t(){for(var a=-1,l=arguments.length,c=-1,u=i.length,h=r(u+l),f=this&&this!==ht&&this instanceof t?s:e;++c<u;)h[c]=i[c];for(;l--;)h[c++]=arguments[++a];return Ct(f,o?n:this,h)}}(e,t,n,s);else var b=function(e,t,n){var r=1&t,i=Ri(e);return function t(){return(this&&this!==ht&&this instanceof t?i:e).apply(r?n:this,arguments)}}(e,t,n);return Do((v?Jr:To)(b,y),e,t)}function Ki(e,t,n,r){return e===i||zs(e,De[n])&&!Pe.call(r,n)?t:e}function Xi(e,t,n,r,o,s){return Zs(e)&&Zs(t)&&(s.set(t,e),zr(e,t,i,Xi,s),s.delete(t)),e}function Ji(e){return ra(e)?i:e}function Qi(e,t,n,r,o,s){var a=1&n,l=e.length,c=t.length;if(l!=c&&!(a&&c>l))return!1;var u=s.get(e),h=s.get(t);if(u&&h)return u==t&&h==e;var f=-1,d=!0,p=2&n?new Vn:i;for(s.set(e,t),s.set(t,e);++f<l;){var g=e[f],m=t[f];if(r)var _=a?r(m,g,f,t,e,s):r(g,m,f,e,t,s);if(_!==i){if(_)continue;d=!1;break}if(p){if(!Mt(t,(function(e,t){if(!Jt(p,t)&&(g===e||o(g,e,n,r,s)))return p.push(t)}))){d=!1;break}}else if(g!==m&&!o(g,m,n,r,s)){d=!1;break}}return s.delete(e),s.delete(t),d}function Zi(e){return Ao(So(e,i,Wo),e+"")}function eo(e){return xr(e,Da,co)}function to(e){return xr(e,Na,uo)}var no=In?function(e){return In.get(e)}:al;function ro(e){for(var t=e.name+"",n=An[t],r=Pe.call(An,t)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==e)return i.name}return t}function io(e){return(Pe.call(jn,"placeholder")?jn:e).placeholder}function oo(){var e=jn.iteratee||rl;return e=e===rl?Pr:e,arguments.length?e(arguments[0],arguments[1]):e}function so(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function ao(e){for(var t=Da(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,xo(i)]}return t}function lo(e,t){var n=function(e,t){return null==e?i:e[t]}(e,t);return Or(n)?n:i}var co=gt?function(e){return null==e?[]:(e=Se(e),It(gt(e),(function(t){return Ve.call(e,t)})))}:pl,uo=gt?function(e){for(var t=[];e;)Ot(t,co(e)),e=We(e);return t}:pl,ho=Cr;function fo(e,t,n){for(var r=-1,i=(t=mi(t,e)).length,o=!1;++r<i;){var s=Fo(t[r]);if(!(o=null!=e&&n(e,s)))break;e=e[s]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&Qs(i)&&mo(s,i)&&(Bs(e)||Us(e))}function po(e){return"function"!=typeof e.constructor||wo(e)?{}:zn(We(e))}function go(e){return Bs(e)||Us(e)||!!(Ge&&e&&e[Ge])}function mo(e,t){var n=typeof e;return!!(t=null==t?h:t)&&("number"==n||"symbol"!=n&&_e.test(e))&&e>-1&&e%1==0&&e<t}function _o(e,t,n){if(!Zs(n))return!1;var r=typeof t;return!!("number"==r?Hs(n)&&mo(t,n.length):"string"==r&&t in n)&&zs(n[t],e)}function vo(e,t){if(Bs(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!aa(e))||Z.test(e)||!Q.test(e)||null!=t&&e in Se(t)}function yo(e){var t=ro(e),n=jn[t];if("function"!=typeof n||!(t in Un.prototype))return!1;if(e===n)return!0;var r=no(n);return!!r&&e===r[0]}(xn&&ho(new xn(new ArrayBuffer(1)))!=O||Cn&&ho(new Cn)!=x||Sn&&ho(Sn.resolve())!=k||kn&&ho(new kn)!=T||En&&ho(new En)!=D)&&(ho=function(e){var t=Cr(e),n=t==S?e.constructor:i,r=n?Lo(n):"";if(r)switch(r){case Dn:return O;case Nn:return x;case On:return k;case Pn:return T;case Rn:return D}return t});var bo=Ne?Xs:gl;function wo(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||De)}function xo(e){return e==e&&!Zs(e)}function Co(e,t){return function(n){return null!=n&&n[e]===t&&(t!==i||e in Se(n))}}function So(e,t,n){return t=mn(t===i?e.length-1:t,0),function(){for(var i=arguments,o=-1,s=mn(i.length-t,0),a=r(s);++o<s;)a[o]=i[t+o];o=-1;for(var l=r(t+1);++o<t;)l[o]=i[o];return l[t]=n(a),Ct(e,this,l)}}function ko(e,t){return t.length<2?e:wr(e,ei(t,0,-1))}function Eo(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var To=No(Jr),Io=ut||function(e,t){return ht.setTimeout(e,t)},Ao=No(Qr);function Do(e,t,n){var r=t+"";return Ao(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(oe,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return kt(p,(function(n){var r="_."+n[0];t&n[1]&&!At(e,r)&&e.push(r)})),e.sort()}(function(e){var t=e.match(se);return t?t[1].split(ae):[]}(r),n)))}function No(e){var t=0,n=0;return function(){var r=vn(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(i,arguments)}}function Oo(e,t){var n=-1,r=e.length,o=r-1;for(t=t===i?r:t;++n<t;){var s=Hr(n,o),a=e[s];e[s]=e[n],e[n]=a}return e.length=t,e}var Po,Ro,Mo=(Po=Ps((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(ee,(function(e,n,r,i){t.push(r?i.replace(ue,"$1"):n||e)})),t}),(function(e){return 500===Ro.size&&Ro.clear(),e})),Ro=Po.cache,Po);function Fo(e){if("string"==typeof e||aa(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Lo(e){if(null!=e){try{return Oe.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function jo(e){if(e instanceof Un)return e.clone();var t=new qn(e.__wrapped__,e.__chain__);return t.__actions__=Ei(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var zo=Yr((function(e,t){return Vs(e)?cr(e,gr(t,1,Vs,!0)):[]})),$o=Yr((function(e,t){var n=Ko(t);return Vs(n)&&(n=i),Vs(e)?cr(e,gr(t,1,Vs,!0),oo(n,2)):[]})),qo=Yr((function(e,t){var n=Ko(t);return Vs(n)&&(n=i),Vs(e)?cr(e,gr(t,1,Vs,!0),i,n):[]}));function Uo(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:da(n);return i<0&&(i=mn(r+i,0)),jt(e,oo(t,3),i)}function Bo(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r-1;return n!==i&&(o=da(n),o=n<0?mn(r+o,0):_n(o,r-1)),jt(e,oo(t,3),o,!0)}function Wo(e){return null!=e&&e.length?gr(e,1):[]}function Ho(e){return e&&e.length?e[0]:i}var Vo=Yr((function(e){var t=Nt(e,pi);return t.length&&t[0]===e[0]?Tr(t):[]})),Yo=Yr((function(e){var t=Ko(e),n=Nt(e,pi);return t===Ko(n)?t=i:n.pop(),n.length&&n[0]===e[0]?Tr(n,oo(t,2)):[]})),Go=Yr((function(e){var t=Ko(e),n=Nt(e,pi);return(t="function"==typeof t?t:i)&&n.pop(),n.length&&n[0]===e[0]?Tr(n,i,t):[]}));function Ko(e){var t=null==e?0:e.length;return t?e[t-1]:i}var Xo=Yr(Jo);function Jo(e,t){return e&&e.length&&t&&t.length?Br(e,t):e}var Qo=Zi((function(e,t){var n=null==e?0:e.length,r=ir(e,t);return Wr(e,Nt(t,(function(e){return mo(e,n)?+e:e})).sort(Ci)),r}));function Zo(e){return null==e?e:wn.call(e)}var es=Yr((function(e){return ai(gr(e,1,Vs,!0))})),ts=Yr((function(e){var t=Ko(e);return Vs(t)&&(t=i),ai(gr(e,1,Vs,!0),oo(t,2))})),ns=Yr((function(e){var t=Ko(e);return t="function"==typeof t?t:i,ai(gr(e,1,Vs,!0),i,t)}));function rs(e){if(!e||!e.length)return[];var t=0;return e=It(e,(function(e){if(Vs(e))return t=mn(e.length,t),!0})),Yt(t,(function(t){return Nt(e,Bt(t))}))}function is(e,t){if(!e||!e.length)return[];var n=rs(e);return null==t?n:Nt(n,(function(e){return Ct(t,i,e)}))}var os=Yr((function(e,t){return Vs(e)?cr(e,t):[]})),ss=Yr((function(e){return fi(It(e,Vs))})),as=Yr((function(e){var t=Ko(e);return Vs(t)&&(t=i),fi(It(e,Vs),oo(t,2))})),ls=Yr((function(e){var t=Ko(e);return t="function"==typeof t?t:i,fi(It(e,Vs),i,t)})),cs=Yr(rs),us=Yr((function(e){var t=e.length,n=t>1?e[t-1]:i;return n="function"==typeof n?(e.pop(),n):i,is(e,n)}));function hs(e){var t=jn(e);return t.__chain__=!0,t}function fs(e,t){return t(e)}var ds=Zi((function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,o=function(t){return ir(t,e)};return!(t>1||this.__actions__.length)&&r instanceof Un&&mo(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:fs,args:[o],thisArg:i}),new qn(r,this.__chain__).thru((function(e){return t&&!e.length&&e.push(i),e}))):this.thru(o)})),ps=Ii((function(e,t,n){Pe.call(e,n)?++e[n]:rr(e,n,1)})),gs=Mi(Uo),ms=Mi(Bo);function _s(e,t){return(Bs(e)?kt:ur)(e,oo(t,3))}function vs(e,t){return(Bs(e)?Et:hr)(e,oo(t,3))}var ys=Ii((function(e,t,n){Pe.call(e,n)?e[n].push(t):rr(e,n,[t])})),bs=Yr((function(e,t,n){var i=-1,o="function"==typeof t,s=Hs(e)?r(e.length):[];return ur(e,(function(e){s[++i]=o?Ct(t,e,n):Ir(e,t,n)})),s})),ws=Ii((function(e,t,n){rr(e,n,t)}));function xs(e,t){return(Bs(e)?Nt:Fr)(e,oo(t,3))}var Cs=Ii((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]})),Ss=Yr((function(e,t){if(null==e)return[];var n=t.length;return n>1&&_o(e,t[0],t[1])?t=[]:n>2&&_o(t[0],t[1],t[2])&&(t=[t[0]]),qr(e,gr(t,1),[])})),ks=ct||function(){return ht.Date.now()};function Es(e,t,n){return t=n?i:t,t=e&&null==t?e.length:t,Gi(e,c,i,i,i,i,t)}function Ts(e,t){var n;if("function"!=typeof t)throw new Te(o);return e=da(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=i),n}}var Is=Yr((function(e,t,n){var r=1;if(n.length){var i=an(n,io(Is));r|=l}return Gi(e,r,t,n,i)})),As=Yr((function(e,t,n){var r=3;if(n.length){var i=an(n,io(As));r|=l}return Gi(t,r,e,n,i)}));function Ds(e,t,n){var r,s,a,l,c,u,h=0,f=!1,d=!1,p=!0;if("function"!=typeof e)throw new Te(o);function g(t){var n=r,o=s;return r=s=i,h=t,l=e.apply(o,n)}function m(e){var n=e-u;return u===i||n>=t||n<0||d&&e-h>=a}function _(){var e=ks();if(m(e))return v(e);c=Io(_,function(e){var n=t-(e-u);return d?_n(n,a-(e-h)):n}(e))}function v(e){return c=i,p&&r?g(e):(r=s=i,l)}function y(){var e=ks(),n=m(e);if(r=arguments,s=this,u=e,n){if(c===i)return function(e){return h=e,c=Io(_,t),f?g(e):l}(u);if(d)return yi(c),c=Io(_,t),g(u)}return c===i&&(c=Io(_,t)),l}return t=ga(t)||0,Zs(n)&&(f=!!n.leading,a=(d="maxWait"in n)?mn(ga(n.maxWait)||0,t):a,p="trailing"in n?!!n.trailing:p),y.cancel=function(){c!==i&&yi(c),h=0,r=u=s=c=i},y.flush=function(){return c===i?l:v(ks())},y}var Ns=Yr((function(e,t){return lr(e,1,t)})),Os=Yr((function(e,t,n){return lr(e,ga(t)||0,n)}));function Ps(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new Te(o);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=e.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(Ps.Cache||Hn),n}function Rs(e){if("function"!=typeof e)throw new Te(o);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}Ps.Cache=Hn;var Ms=_i((function(e,t){var n=(t=1==t.length&&Bs(t[0])?Nt(t[0],Kt(oo())):Nt(gr(t,1),Kt(oo()))).length;return Yr((function(r){for(var i=-1,o=_n(r.length,n);++i<o;)r[i]=t[i].call(this,r[i]);return Ct(e,this,r)}))})),Fs=Yr((function(e,t){var n=an(t,io(Fs));return Gi(e,l,i,t,n)})),Ls=Yr((function(e,t){var n=an(t,io(Ls));return Gi(e,64,i,t,n)})),js=Zi((function(e,t){return Gi(e,256,i,i,i,t)}));function zs(e,t){return e===t||e!=e&&t!=t}var $s=Bi(Sr),qs=Bi((function(e,t){return e>=t})),Us=Ar(function(){return arguments}())?Ar:function(e){return ea(e)&&Pe.call(e,"callee")&&!Ve.call(e,"callee")},Bs=r.isArray,Ws=_t?Kt(_t):function(e){return ea(e)&&Cr(e)==N};function Hs(e){return null!=e&&Qs(e.length)&&!Xs(e)}function Vs(e){return ea(e)&&Hs(e)}var Ys=mt||gl,Gs=vt?Kt(vt):function(e){return ea(e)&&Cr(e)==v};function Ks(e){if(!ea(e))return!1;var t=Cr(e);return t==y||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!ra(e)}function Xs(e){if(!Zs(e))return!1;var t=Cr(e);return t==b||t==w||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Js(e){return"number"==typeof e&&e==da(e)}function Qs(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=h}function Zs(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function ea(e){return null!=e&&"object"==typeof e}var ta=yt?Kt(yt):function(e){return ea(e)&&ho(e)==x};function na(e){return"number"==typeof e||ea(e)&&Cr(e)==C}function ra(e){if(!ea(e)||Cr(e)!=S)return!1;var t=We(e);if(null===t)return!0;var n=Pe.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Oe.call(n)==Le}var ia=bt?Kt(bt):function(e){return ea(e)&&Cr(e)==E},oa=wt?Kt(wt):function(e){return ea(e)&&ho(e)==T};function sa(e){return"string"==typeof e||!Bs(e)&&ea(e)&&Cr(e)==I}function aa(e){return"symbol"==typeof e||ea(e)&&Cr(e)==A}var la=xt?Kt(xt):function(e){return ea(e)&&Qs(e.length)&&!!it[Cr(e)]},ca=Bi(Mr),ua=Bi((function(e,t){return e<=t}));function ha(e){if(!e)return[];if(Hs(e))return sa(e)?hn(e):Ei(e);if(Ke&&e[Ke])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[Ke]());var t=ho(e);return(t==x?on:t==T?ln:za)(e)}function fa(e){return e?(e=ga(e))===u||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function da(e){var t=fa(e),n=t%1;return t==t?n?t-n:t:0}function pa(e){return e?or(da(e),0,d):0}function ga(e){if("number"==typeof e)return e;if(aa(e))return f;if(Zs(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Zs(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Gt(e);var n=pe.test(e);return n||me.test(e)?lt(e.slice(2),n?2:8):de.test(e)?f:+e}function ma(e){return Ti(e,Na(e))}function _a(e){return null==e?"":si(e)}var va=Ai((function(e,t){if(wo(t)||Hs(t))Ti(t,Da(t),e);else for(var n in t)Pe.call(t,n)&&Zn(e,n,t[n])})),ya=Ai((function(e,t){Ti(t,Na(t),e)})),ba=Ai((function(e,t,n,r){Ti(t,Na(t),e,r)})),wa=Ai((function(e,t,n,r){Ti(t,Da(t),e,r)})),xa=Zi(ir),Ca=Yr((function(e,t){e=Se(e);var n=-1,r=t.length,o=r>2?t[2]:i;for(o&&_o(t[0],t[1],o)&&(r=1);++n<r;)for(var s=t[n],a=Na(s),l=-1,c=a.length;++l<c;){var u=a[l],h=e[u];(h===i||zs(h,De[u])&&!Pe.call(e,u))&&(e[u]=s[u])}return e})),Sa=Yr((function(e){return e.push(i,Xi),Ct(Pa,i,e)}));function ka(e,t,n){var r=null==e?i:wr(e,t);return r===i?n:r}function Ea(e,t){return null!=e&&fo(e,t,Er)}var Ta=ji((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Fe.call(t)),e[t]=n}),Za(nl)),Ia=ji((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Fe.call(t)),Pe.call(e,t)?e[t].push(n):e[t]=[n]}),oo),Aa=Yr(Ir);function Da(e){return Hs(e)?Gn(e):Rr(e)}function Na(e){return Hs(e)?Gn(e,!0):function(e){if(!Zs(e))return function(e){var t=[];if(null!=e)for(var n in Se(e))t.push(n);return t}(e);var t=wo(e),n=[];for(var r in e)("constructor"!=r||!t&&Pe.call(e,r))&&n.push(r);return n}(e)}var Oa=Ai((function(e,t,n){zr(e,t,n)})),Pa=Ai((function(e,t,n,r){zr(e,t,n,r)})),Ra=Zi((function(e,t){var n={};if(null==e)return n;var r=!1;t=Nt(t,(function(t){return t=mi(t,e),r||(r=t.length>1),t})),Ti(e,to(e),n),r&&(n=sr(n,7,Ji));for(var i=t.length;i--;)li(n,t[i]);return n})),Ma=Zi((function(e,t){return null==e?{}:function(e,t){return Ur(e,t,(function(t,n){return Ea(e,n)}))}(e,t)}));function Fa(e,t){if(null==e)return{};var n=Nt(to(e),(function(e){return[e]}));return t=oo(t),Ur(e,n,(function(e,n){return t(e,n[0])}))}var La=Yi(Da),ja=Yi(Na);function za(e){return null==e?[]:Xt(e,Da(e))}var $a=Pi((function(e,t,n){return t=t.toLowerCase(),e+(n?qa(t):t)}));function qa(e){return Ka(_a(e).toLowerCase())}function Ua(e){return(e=_a(e))&&e.replace(ve,en).replace(Je,"")}var Ba=Pi((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),Wa=Pi((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),Ha=Oi("toLowerCase"),Va=Pi((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()})),Ya=Pi((function(e,t,n){return e+(n?" ":"")+Ka(t)})),Ga=Pi((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()})),Ka=Oi("toUpperCase");function Xa(e,t,n){return e=_a(e),(t=n?i:t)===i?function(e){return tt.test(e)}(e)?function(e){return e.match(Ze)||[]}(e):function(e){return e.match(le)||[]}(e):e.match(t)||[]}var Ja=Yr((function(e,t){try{return Ct(e,i,t)}catch(e){return Ks(e)?e:new we(e)}})),Qa=Zi((function(e,t){return kt(t,(function(t){t=Fo(t),rr(e,t,Is(e[t],e))})),e}));function Za(e){return function(){return e}}var el=Fi(),tl=Fi(!0);function nl(e){return e}function rl(e){return Pr("function"==typeof e?e:sr(e,1))}var il=Yr((function(e,t){return function(n){return Ir(n,e,t)}})),ol=Yr((function(e,t){return function(n){return Ir(e,n,t)}}));function sl(e,t,n){var r=Da(t),i=br(t,r);null!=n||Zs(t)&&(i.length||!r.length)||(n=t,t=e,e=this,i=br(t,Da(t)));var o=!(Zs(n)&&"chain"in n&&!n.chain),s=Xs(e);return kt(i,(function(n){var r=t[n];e[n]=r,s&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__);return(n.__actions__=Ei(this.__actions__)).push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,Ot([this.value()],arguments))})})),e}function al(){}var ll=$i(Nt),cl=$i(Tt),ul=$i(Mt);function hl(e){return vo(e)?Bt(Fo(e)):function(e){return function(t){return wr(t,e)}}(e)}var fl=Ui(),dl=Ui(!0);function pl(){return[]}function gl(){return!1}var ml,_l=zi((function(e,t){return e+t}),0),vl=Hi("ceil"),yl=zi((function(e,t){return e/t}),1),bl=Hi("floor"),wl=zi((function(e,t){return e*t}),1),xl=Hi("round"),Cl=zi((function(e,t){return e-t}),0);return jn.after=function(e,t){if("function"!=typeof t)throw new Te(o);return e=da(e),function(){if(--e<1)return t.apply(this,arguments)}},jn.ary=Es,jn.assign=va,jn.assignIn=ya,jn.assignInWith=ba,jn.assignWith=wa,jn.at=xa,jn.before=Ts,jn.bind=Is,jn.bindAll=Qa,jn.bindKey=As,jn.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return Bs(e)?e:[e]},jn.chain=hs,jn.chunk=function(e,t,n){t=(n?_o(e,t,n):t===i)?1:mn(da(t),0);var o=null==e?0:e.length;if(!o||t<1)return[];for(var s=0,a=0,l=r(ft(o/t));s<o;)l[a++]=ei(e,s,s+=t);return l},jn.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i},jn.concat=function(){var e=arguments.length;if(!e)return[];for(var t=r(e-1),n=arguments[0],i=e;i--;)t[i-1]=arguments[i];return Ot(Bs(n)?Ei(n):[n],gr(t,1))},jn.cond=function(e){var t=null==e?0:e.length,n=oo();return e=t?Nt(e,(function(e){if("function"!=typeof e[1])throw new Te(o);return[n(e[0]),e[1]]})):[],Yr((function(n){for(var r=-1;++r<t;){var i=e[r];if(Ct(i[0],this,n))return Ct(i[1],this,n)}}))},jn.conforms=function(e){return function(e){var t=Da(e);return function(n){return ar(n,e,t)}}(sr(e,1))},jn.constant=Za,jn.countBy=ps,jn.create=function(e,t){var n=zn(e);return null==t?n:nr(n,t)},jn.curry=function e(t,n,r){var o=Gi(t,8,i,i,i,i,i,n=r?i:n);return o.placeholder=e.placeholder,o},jn.curryRight=function e(t,n,r){var o=Gi(t,16,i,i,i,i,i,n=r?i:n);return o.placeholder=e.placeholder,o},jn.debounce=Ds,jn.defaults=Ca,jn.defaultsDeep=Sa,jn.defer=Ns,jn.delay=Os,jn.difference=zo,jn.differenceBy=$o,jn.differenceWith=qo,jn.drop=function(e,t,n){var r=null==e?0:e.length;return r?ei(e,(t=n||t===i?1:da(t))<0?0:t,r):[]},jn.dropRight=function(e,t,n){var r=null==e?0:e.length;return r?ei(e,0,(t=r-(t=n||t===i?1:da(t)))<0?0:t):[]},jn.dropRightWhile=function(e,t){return e&&e.length?ui(e,oo(t,3),!0,!0):[]},jn.dropWhile=function(e,t){return e&&e.length?ui(e,oo(t,3),!0):[]},jn.fill=function(e,t,n,r){var o=null==e?0:e.length;return o?(n&&"number"!=typeof n&&_o(e,t,n)&&(n=0,r=o),function(e,t,n,r){var o=e.length;for((n=da(n))<0&&(n=-n>o?0:o+n),(r=r===i||r>o?o:da(r))<0&&(r+=o),r=n>r?0:pa(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},jn.filter=function(e,t){return(Bs(e)?It:pr)(e,oo(t,3))},jn.flatMap=function(e,t){return gr(xs(e,t),1)},jn.flatMapDeep=function(e,t){return gr(xs(e,t),u)},jn.flatMapDepth=function(e,t,n){return n=n===i?1:da(n),gr(xs(e,t),n)},jn.flatten=Wo,jn.flattenDeep=function(e){return null!=e&&e.length?gr(e,u):[]},jn.flattenDepth=function(e,t){return null!=e&&e.length?gr(e,t=t===i?1:da(t)):[]},jn.flip=function(e){return Gi(e,512)},jn.flow=el,jn.flowRight=tl,jn.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},jn.functions=function(e){return null==e?[]:br(e,Da(e))},jn.functionsIn=function(e){return null==e?[]:br(e,Na(e))},jn.groupBy=ys,jn.initial=function(e){return null!=e&&e.length?ei(e,0,-1):[]},jn.intersection=Vo,jn.intersectionBy=Yo,jn.intersectionWith=Go,jn.invert=Ta,jn.invertBy=Ia,jn.invokeMap=bs,jn.iteratee=rl,jn.keyBy=ws,jn.keys=Da,jn.keysIn=Na,jn.map=xs,jn.mapKeys=function(e,t){var n={};return t=oo(t,3),vr(e,(function(e,r,i){rr(n,t(e,r,i),e)})),n},jn.mapValues=function(e,t){var n={};return t=oo(t,3),vr(e,(function(e,r,i){rr(n,r,t(e,r,i))})),n},jn.matches=function(e){return Lr(sr(e,1))},jn.matchesProperty=function(e,t){return jr(e,sr(t,1))},jn.memoize=Ps,jn.merge=Oa,jn.mergeWith=Pa,jn.method=il,jn.methodOf=ol,jn.mixin=sl,jn.negate=Rs,jn.nthArg=function(e){return e=da(e),Yr((function(t){return $r(t,e)}))},jn.omit=Ra,jn.omitBy=function(e,t){return Fa(e,Rs(oo(t)))},jn.once=function(e){return Ts(2,e)},jn.orderBy=function(e,t,n,r){return null==e?[]:(Bs(t)||(t=null==t?[]:[t]),Bs(n=r?i:n)||(n=null==n?[]:[n]),qr(e,t,n))},jn.over=ll,jn.overArgs=Ms,jn.overEvery=cl,jn.overSome=ul,jn.partial=Fs,jn.partialRight=Ls,jn.partition=Cs,jn.pick=Ma,jn.pickBy=Fa,jn.property=hl,jn.propertyOf=function(e){return function(t){return null==e?i:wr(e,t)}},jn.pull=Xo,jn.pullAll=Jo,jn.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?Br(e,t,oo(n,2)):e},jn.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?Br(e,t,i,n):e},jn.pullAt=Qo,jn.range=fl,jn.rangeRight=dl,jn.rearg=js,jn.reject=function(e,t){return(Bs(e)?It:pr)(e,Rs(oo(t,3)))},jn.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],o=e.length;for(t=oo(t,3);++r<o;){var s=e[r];t(s,r,e)&&(n.push(s),i.push(r))}return Wr(e,i),n},jn.rest=function(e,t){if("function"!=typeof e)throw new Te(o);return Yr(e,t=t===i?t:da(t))},jn.reverse=Zo,jn.sampleSize=function(e,t,n){return t=(n?_o(e,t,n):t===i)?1:da(t),(Bs(e)?Xn:Kr)(e,t)},jn.set=function(e,t,n){return null==e?e:Xr(e,t,n)},jn.setWith=function(e,t,n,r){return r="function"==typeof r?r:i,null==e?e:Xr(e,t,n,r)},jn.shuffle=function(e){return(Bs(e)?Jn:Zr)(e)},jn.slice=function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&_o(e,t,n)?(t=0,n=r):(t=null==t?0:da(t),n=n===i?r:da(n)),ei(e,t,n)):[]},jn.sortBy=Ss,jn.sortedUniq=function(e){return e&&e.length?ii(e):[]},jn.sortedUniqBy=function(e,t){return e&&e.length?ii(e,oo(t,2)):[]},jn.split=function(e,t,n){return n&&"number"!=typeof n&&_o(e,t,n)&&(t=n=i),(n=n===i?d:n>>>0)?(e=_a(e))&&("string"==typeof t||null!=t&&!ia(t))&&!(t=si(t))&&rn(e)?vi(hn(e),0,n):e.split(t,n):[]},jn.spread=function(e,t){if("function"!=typeof e)throw new Te(o);return t=null==t?0:mn(da(t),0),Yr((function(n){var r=n[t],i=vi(n,0,t);return r&&Ot(i,r),Ct(e,this,i)}))},jn.tail=function(e){var t=null==e?0:e.length;return t?ei(e,1,t):[]},jn.take=function(e,t,n){return e&&e.length?ei(e,0,(t=n||t===i?1:da(t))<0?0:t):[]},jn.takeRight=function(e,t,n){var r=null==e?0:e.length;return r?ei(e,(t=r-(t=n||t===i?1:da(t)))<0?0:t,r):[]},jn.takeRightWhile=function(e,t){return e&&e.length?ui(e,oo(t,3),!1,!0):[]},jn.takeWhile=function(e,t){return e&&e.length?ui(e,oo(t,3)):[]},jn.tap=function(e,t){return t(e),e},jn.throttle=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new Te(o);return Zs(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Ds(e,t,{leading:r,maxWait:t,trailing:i})},jn.thru=fs,jn.toArray=ha,jn.toPairs=La,jn.toPairsIn=ja,jn.toPath=function(e){return Bs(e)?Nt(e,Fo):aa(e)?[e]:Ei(Mo(_a(e)))},jn.toPlainObject=ma,jn.transform=function(e,t,n){var r=Bs(e),i=r||Ys(e)||la(e);if(t=oo(t,4),null==n){var o=e&&e.constructor;n=i?r?new o:[]:Zs(e)&&Xs(o)?zn(We(e)):{}}return(i?kt:vr)(e,(function(e,r,i){return t(n,e,r,i)})),n},jn.unary=function(e){return Es(e,1)},jn.union=es,jn.unionBy=ts,jn.unionWith=ns,jn.uniq=function(e){return e&&e.length?ai(e):[]},jn.uniqBy=function(e,t){return e&&e.length?ai(e,oo(t,2)):[]},jn.uniqWith=function(e,t){return t="function"==typeof t?t:i,e&&e.length?ai(e,i,t):[]},jn.unset=function(e,t){return null==e||li(e,t)},jn.unzip=rs,jn.unzipWith=is,jn.update=function(e,t,n){return null==e?e:ci(e,t,gi(n))},jn.updateWith=function(e,t,n,r){return r="function"==typeof r?r:i,null==e?e:ci(e,t,gi(n),r)},jn.values=za,jn.valuesIn=function(e){return null==e?[]:Xt(e,Na(e))},jn.without=os,jn.words=Xa,jn.wrap=function(e,t){return Fs(gi(t),e)},jn.xor=ss,jn.xorBy=as,jn.xorWith=ls,jn.zip=cs,jn.zipObject=function(e,t){return di(e||[],t||[],Zn)},jn.zipObjectDeep=function(e,t){return di(e||[],t||[],Xr)},jn.zipWith=us,jn.entries=La,jn.entriesIn=ja,jn.extend=ya,jn.extendWith=ba,sl(jn,jn),jn.add=_l,jn.attempt=Ja,jn.camelCase=$a,jn.capitalize=qa,jn.ceil=vl,jn.clamp=function(e,t,n){return n===i&&(n=t,t=i),n!==i&&(n=(n=ga(n))==n?n:0),t!==i&&(t=(t=ga(t))==t?t:0),or(ga(e),t,n)},jn.clone=function(e){return sr(e,4)},jn.cloneDeep=function(e){return sr(e,5)},jn.cloneDeepWith=function(e,t){return sr(e,5,t="function"==typeof t?t:i)},jn.cloneWith=function(e,t){return sr(e,4,t="function"==typeof t?t:i)},jn.conformsTo=function(e,t){return null==t||ar(e,t,Da(t))},jn.deburr=Ua,jn.defaultTo=function(e,t){return null==e||e!=e?t:e},jn.divide=yl,jn.endsWith=function(e,t,n){e=_a(e),t=si(t);var r=e.length,o=n=n===i?r:or(da(n),0,r);return(n-=t.length)>=0&&e.slice(n,o)==t},jn.eq=zs,jn.escape=function(e){return(e=_a(e))&&G.test(e)?e.replace(V,tn):e},jn.escapeRegExp=function(e){return(e=_a(e))&&ne.test(e)?e.replace(te,"\\$&"):e},jn.every=function(e,t,n){var r=Bs(e)?Tt:fr;return n&&_o(e,t,n)&&(t=i),r(e,oo(t,3))},jn.find=gs,jn.findIndex=Uo,jn.findKey=function(e,t){return Lt(e,oo(t,3),vr)},jn.findLast=ms,jn.findLastIndex=Bo,jn.findLastKey=function(e,t){return Lt(e,oo(t,3),yr)},jn.floor=bl,jn.forEach=_s,jn.forEachRight=vs,jn.forIn=function(e,t){return null==e?e:mr(e,oo(t,3),Na)},jn.forInRight=function(e,t){return null==e?e:_r(e,oo(t,3),Na)},jn.forOwn=function(e,t){return e&&vr(e,oo(t,3))},jn.forOwnRight=function(e,t){return e&&yr(e,oo(t,3))},jn.get=ka,jn.gt=$s,jn.gte=qs,jn.has=function(e,t){return null!=e&&fo(e,t,kr)},jn.hasIn=Ea,jn.head=Ho,jn.identity=nl,jn.includes=function(e,t,n,r){e=Hs(e)?e:za(e),n=n&&!r?da(n):0;var i=e.length;return n<0&&(n=mn(i+n,0)),sa(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&zt(e,t,n)>-1},jn.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:da(n);return i<0&&(i=mn(r+i,0)),zt(e,t,i)},jn.inRange=function(e,t,n){return t=fa(t),n===i?(n=t,t=0):n=fa(n),function(e,t,n){return e>=_n(t,n)&&e<mn(t,n)}(e=ga(e),t,n)},jn.invoke=Aa,jn.isArguments=Us,jn.isArray=Bs,jn.isArrayBuffer=Ws,jn.isArrayLike=Hs,jn.isArrayLikeObject=Vs,jn.isBoolean=function(e){return!0===e||!1===e||ea(e)&&Cr(e)==_},jn.isBuffer=Ys,jn.isDate=Gs,jn.isElement=function(e){return ea(e)&&1===e.nodeType&&!ra(e)},jn.isEmpty=function(e){if(null==e)return!0;if(Hs(e)&&(Bs(e)||"string"==typeof e||"function"==typeof e.splice||Ys(e)||la(e)||Us(e)))return!e.length;var t=ho(e);if(t==x||t==T)return!e.size;if(wo(e))return!Rr(e).length;for(var n in e)if(Pe.call(e,n))return!1;return!0},jn.isEqual=function(e,t){return Dr(e,t)},jn.isEqualWith=function(e,t,n){var r=(n="function"==typeof n?n:i)?n(e,t):i;return r===i?Dr(e,t,i,n):!!r},jn.isError=Ks,jn.isFinite=function(e){return"number"==typeof e&&Ft(e)},jn.isFunction=Xs,jn.isInteger=Js,jn.isLength=Qs,jn.isMap=ta,jn.isMatch=function(e,t){return e===t||Nr(e,t,ao(t))},jn.isMatchWith=function(e,t,n){return n="function"==typeof n?n:i,Nr(e,t,ao(t),n)},jn.isNaN=function(e){return na(e)&&e!=+e},jn.isNative=function(e){if(bo(e))throw new we("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Or(e)},jn.isNil=function(e){return null==e},jn.isNull=function(e){return null===e},jn.isNumber=na,jn.isObject=Zs,jn.isObjectLike=ea,jn.isPlainObject=ra,jn.isRegExp=ia,jn.isSafeInteger=function(e){return Js(e)&&e>=-9007199254740991&&e<=h},jn.isSet=oa,jn.isString=sa,jn.isSymbol=aa,jn.isTypedArray=la,jn.isUndefined=function(e){return e===i},jn.isWeakMap=function(e){return ea(e)&&ho(e)==D},jn.isWeakSet=function(e){return ea(e)&&"[object WeakSet]"==Cr(e)},jn.join=function(e,t){return null==e?"":Wt.call(e,t)},jn.kebabCase=Ba,jn.last=Ko,jn.lastIndexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var o=r;return n!==i&&(o=(o=da(n))<0?mn(r+o,0):_n(o,r-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,o):jt(e,qt,o,!0)},jn.lowerCase=Wa,jn.lowerFirst=Ha,jn.lt=ca,jn.lte=ua,jn.max=function(e){return e&&e.length?dr(e,nl,Sr):i},jn.maxBy=function(e,t){return e&&e.length?dr(e,oo(t,2),Sr):i},jn.mean=function(e){return Ut(e,nl)},jn.meanBy=function(e,t){return Ut(e,oo(t,2))},jn.min=function(e){return e&&e.length?dr(e,nl,Mr):i},jn.minBy=function(e,t){return e&&e.length?dr(e,oo(t,2),Mr):i},jn.stubArray=pl,jn.stubFalse=gl,jn.stubObject=function(){return{}},jn.stubString=function(){return""},jn.stubTrue=function(){return!0},jn.multiply=wl,jn.nth=function(e,t){return e&&e.length?$r(e,da(t)):i},jn.noConflict=function(){return ht._===this&&(ht._=je),this},jn.noop=al,jn.now=ks,jn.pad=function(e,t,n){e=_a(e);var r=(t=da(t))?un(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return qi(dt(i),n)+e+qi(ft(i),n)},jn.padEnd=function(e,t,n){e=_a(e);var r=(t=da(t))?un(e):0;return t&&r<t?e+qi(t-r,n):e},jn.padStart=function(e,t,n){e=_a(e);var r=(t=da(t))?un(e):0;return t&&r<t?qi(t-r,n)+e:e},jn.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),yn(_a(e).replace(re,""),t||0)},jn.random=function(e,t,n){if(n&&"boolean"!=typeof n&&_o(e,t,n)&&(t=n=i),n===i&&("boolean"==typeof t?(n=t,t=i):"boolean"==typeof e&&(n=e,e=i)),e===i&&t===i?(e=0,t=1):(e=fa(e),t===i?(t=e,e=0):t=fa(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var o=bn();return _n(e+o*(t-e+at("1e-"+((o+"").length-1))),t)}return Hr(e,t)},jn.reduce=function(e,t,n){var r=Bs(e)?Pt:Ht,i=arguments.length<3;return r(e,oo(t,4),n,i,ur)},jn.reduceRight=function(e,t,n){var r=Bs(e)?Rt:Ht,i=arguments.length<3;return r(e,oo(t,4),n,i,hr)},jn.repeat=function(e,t,n){return t=(n?_o(e,t,n):t===i)?1:da(t),Vr(_a(e),t)},jn.replace=function(){var e=arguments,t=_a(e[0]);return e.length<3?t:t.replace(e[1],e[2])},jn.result=function(e,t,n){var r=-1,o=(t=mi(t,e)).length;for(o||(o=1,e=i);++r<o;){var s=null==e?i:e[Fo(t[r])];s===i&&(r=o,s=n),e=Xs(s)?s.call(e):s}return e},jn.round=xl,jn.runInContext=e,jn.sample=function(e){return(Bs(e)?Kn:Gr)(e)},jn.size=function(e){if(null==e)return 0;if(Hs(e))return sa(e)?un(e):e.length;var t=ho(e);return t==x||t==T?e.size:Rr(e).length},jn.snakeCase=Va,jn.some=function(e,t,n){var r=Bs(e)?Mt:ti;return n&&_o(e,t,n)&&(t=i),r(e,oo(t,3))},jn.sortedIndex=function(e,t){return ni(e,t)},jn.sortedIndexBy=function(e,t,n){return ri(e,t,oo(n,2))},jn.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=ni(e,t);if(r<n&&zs(e[r],t))return r}return-1},jn.sortedLastIndex=function(e,t){return ni(e,t,!0)},jn.sortedLastIndexBy=function(e,t,n){return ri(e,t,oo(n,2),!0)},jn.sortedLastIndexOf=function(e,t){if(null!=e&&e.length){var n=ni(e,t,!0)-1;if(zs(e[n],t))return n}return-1},jn.startCase=Ya,jn.startsWith=function(e,t,n){return e=_a(e),n=null==n?0:or(da(n),0,e.length),t=si(t),e.slice(n,n+t.length)==t},jn.subtract=Cl,jn.sum=function(e){return e&&e.length?Vt(e,nl):0},jn.sumBy=function(e,t){return e&&e.length?Vt(e,oo(t,2)):0},jn.template=function(e,t,n){var r=jn.templateSettings;n&&_o(e,t,n)&&(t=i),e=_a(e),t=ba({},t,r,Ki);var o,s,a=ba({},t.imports,r.imports,Ki),l=Da(a),c=Xt(a,l),u=0,h=t.interpolate||ye,f="__p += '",d=ke((t.escape||ye).source+"|"+h.source+"|"+(h===J?he:ye).source+"|"+(t.evaluate||ye).source+"|$","g"),p="//# sourceURL="+(Pe.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++rt+"]")+"\n";e.replace(d,(function(t,n,r,i,a,l){return r||(r=i),f+=e.slice(u,l).replace(be,nn),n&&(o=!0,f+="' +\n__e("+n+") +\n'"),a&&(s=!0,f+="';\n"+a+";\n__p += '"),r&&(f+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),u=l+t.length,t})),f+="';\n";var g=Pe.call(t,"variable")&&t.variable;if(g){if(ce.test(g))throw new we("Invalid `variable` option passed into `_.template`")}else f="with (obj) {\n"+f+"\n}\n";f=(s?f.replace(U,""):f).replace(B,"$1").replace(W,"$1;"),f="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var m=Ja((function(){return xe(l,p+"return "+f).apply(i,c)}));if(m.source=f,Ks(m))throw m;return m},jn.times=function(e,t){if((e=da(e))<1||e>h)return[];var n=d,r=_n(e,d);t=oo(t),e-=d;for(var i=Yt(r,t);++n<e;)t(n);return i},jn.toFinite=fa,jn.toInteger=da,jn.toLength=pa,jn.toLower=function(e){return _a(e).toLowerCase()},jn.toNumber=ga,jn.toSafeInteger=function(e){return e?or(da(e),-9007199254740991,h):0===e?e:0},jn.toString=_a,jn.toUpper=function(e){return _a(e).toUpperCase()},jn.trim=function(e,t,n){if((e=_a(e))&&(n||t===i))return Gt(e);if(!e||!(t=si(t)))return e;var r=hn(e),o=hn(t);return vi(r,Qt(r,o),Zt(r,o)+1).join("")},jn.trimEnd=function(e,t,n){if((e=_a(e))&&(n||t===i))return e.slice(0,fn(e)+1);if(!e||!(t=si(t)))return e;var r=hn(e);return vi(r,0,Zt(r,hn(t))+1).join("")},jn.trimStart=function(e,t,n){if((e=_a(e))&&(n||t===i))return e.replace(re,"");if(!e||!(t=si(t)))return e;var r=hn(e);return vi(r,Qt(r,hn(t))).join("")},jn.truncate=function(e,t){var n=30,r="...";if(Zs(t)){var o="separator"in t?t.separator:o;n="length"in t?da(t.length):n,r="omission"in t?si(t.omission):r}var s=(e=_a(e)).length;if(rn(e)){var a=hn(e);s=a.length}if(n>=s)return e;var l=n-un(r);if(l<1)return r;var c=a?vi(a,0,l).join(""):e.slice(0,l);if(o===i)return c+r;if(a&&(l+=c.length-l),ia(o)){if(e.slice(l).search(o)){var u,h=c;for(o.global||(o=ke(o.source,_a(fe.exec(o))+"g")),o.lastIndex=0;u=o.exec(h);)var f=u.index;c=c.slice(0,f===i?l:f)}}else if(e.indexOf(si(o),l)!=l){var d=c.lastIndexOf(o);d>-1&&(c=c.slice(0,d))}return c+r},jn.unescape=function(e){return(e=_a(e))&&Y.test(e)?e.replace(H,dn):e},jn.uniqueId=function(e){var t=++Re;return _a(e)+t},jn.upperCase=Ga,jn.upperFirst=Ka,jn.each=_s,jn.eachRight=vs,jn.first=Ho,sl(jn,(ml={},vr(jn,(function(e,t){Pe.call(jn.prototype,t)||(ml[t]=e)})),ml),{chain:!1}),jn.VERSION="4.17.21",kt(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){jn[e].placeholder=jn})),kt(["drop","take"],(function(e,t){Un.prototype[e]=function(n){n=n===i?1:mn(da(n),0);var r=this.__filtered__&&!t?new Un(this):this.clone();return r.__filtered__?r.__takeCount__=_n(n,r.__takeCount__):r.__views__.push({size:_n(n,d),type:e+(r.__dir__<0?"Right":"")}),r},Un.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),kt(["filter","map","takeWhile"],(function(e,t){var n=t+1,r=1==n||3==n;Un.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:oo(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}})),kt(["head","last"],(function(e,t){var n="take"+(t?"Right":"");Un.prototype[e]=function(){return this[n](1).value()[0]}})),kt(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");Un.prototype[e]=function(){return this.__filtered__?new Un(this):this[n](1)}})),Un.prototype.compact=function(){return this.filter(nl)},Un.prototype.find=function(e){return this.filter(e).head()},Un.prototype.findLast=function(e){return this.reverse().find(e)},Un.prototype.invokeMap=Yr((function(e,t){return"function"==typeof e?new Un(this):this.map((function(n){return Ir(n,e,t)}))})),Un.prototype.reject=function(e){return this.filter(Rs(oo(e)))},Un.prototype.slice=function(e,t){e=da(e);var n=this;return n.__filtered__&&(e>0||t<0)?new Un(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==i&&(n=(t=da(t))<0?n.dropRight(-t):n.take(t-e)),n)},Un.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Un.prototype.toArray=function(){return this.take(d)},vr(Un.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),o=jn[r?"take"+("last"==t?"Right":""):t],s=r||/^find/.test(t);o&&(jn.prototype[t]=function(){var t=this.__wrapped__,a=r?[1]:arguments,l=t instanceof Un,c=a[0],u=l||Bs(t),h=function(e){var t=o.apply(jn,Ot([e],a));return r&&f?t[0]:t};u&&n&&"function"==typeof c&&1!=c.length&&(l=u=!1);var f=this.__chain__,d=!!this.__actions__.length,p=s&&!f,g=l&&!d;if(!s&&u){t=g?t:new Un(this);var m=e.apply(t,a);return m.__actions__.push({func:fs,args:[h],thisArg:i}),new qn(m,f)}return p&&g?e.apply(this,a):(m=this.thru(h),p?r?m.value()[0]:m.value():m)})})),kt(["pop","push","shift","sort","splice","unshift"],(function(e){var t=Ie[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);jn.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(Bs(i)?i:[],e)}return this[n]((function(n){return t.apply(Bs(n)?n:[],e)}))}})),vr(Un.prototype,(function(e,t){var n=jn[t];if(n){var r=n.name+"";Pe.call(An,r)||(An[r]=[]),An[r].push({name:t,func:n})}})),An[Li(i,2).name]=[{name:"wrapper",func:i}],Un.prototype.clone=function(){var e=new Un(this.__wrapped__);return e.__actions__=Ei(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Ei(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Ei(this.__views__),e},Un.prototype.reverse=function(){if(this.__filtered__){var e=new Un(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},Un.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=Bs(e),r=t<0,i=n?e.length:0,o=function(e,t,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],s=o.size;switch(o.type){case"drop":e+=s;break;case"dropRight":t-=s;break;case"take":t=_n(t,e+s);break;case"takeRight":e=mn(e,t-s)}}return{start:e,end:t}}(0,i,this.__views__),s=o.start,a=o.end,l=a-s,c=r?a:s-1,u=this.__iteratees__,h=u.length,f=0,d=_n(l,this.__takeCount__);if(!n||!r&&i==l&&d==l)return hi(e,this.__actions__);var p=[];e:for(;l--&&f<d;){for(var g=-1,m=e[c+=t];++g<h;){var _=u[g],v=_.iteratee,y=_.type,b=v(m);if(2==y)m=b;else if(!b){if(1==y)continue e;break e}}p[f++]=m}return p},jn.prototype.at=ds,jn.prototype.chain=function(){return hs(this)},jn.prototype.commit=function(){return new qn(this.value(),this.__chain__)},jn.prototype.next=function(){this.__values__===i&&(this.__values__=ha(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?i:this.__values__[this.__index__++]}},jn.prototype.plant=function(e){for(var t,n=this;n instanceof $n;){var r=jo(n);r.__index__=0,r.__values__=i,t?o.__wrapped__=r:t=r;var o=r;n=n.__wrapped__}return o.__wrapped__=e,t},jn.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof Un){var t=e;return this.__actions__.length&&(t=new Un(this)),(t=t.reverse()).__actions__.push({func:fs,args:[Zo],thisArg:i}),new qn(t,this.__chain__)}return this.thru(Zo)},jn.prototype.toJSON=jn.prototype.valueOf=jn.prototype.value=function(){return hi(this.__wrapped__,this.__actions__)},jn.prototype.first=jn.prototype.head,Ke&&(jn.prototype[Ke]=function(){return this}),jn}();ht._=pn,(r=function(){return pn}.call(t,n,t,e))===i||(e.exports=r)}.call(this)},379:e=>{"use strict";var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var o={},s=[],a=0;a<e.length;a++){var l=e[a],c=r.base?l[0]+r.base:l[0],u=o[c]||0,h="".concat(c," ").concat(u);o[c]=u+1;var f=n(h),d={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==f)t[f].references++,t[f].updater(d);else{var p=i(d,r);r.byIndex=a,t.splice(a,0,{identifier:h,updater:p,references:1})}s.push(h)}return s}function i(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,i){var o=r(e=e||[],i=i||{});return function(e){e=e||[];for(var s=0;s<o.length;s++){var a=n(o[s]);t[a].references--}for(var l=r(e,i),c=0;c<o.length;c++){var u=n(o[c]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}o=l}}},569:e=>{"use strict";var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},216:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,n)=>{"use strict";e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},795:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,i&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.nc=void 0,(()=>{"use strict";n(486);var e=n(379),t=n.n(e),r=n(795),i=n.n(r),o=n(569),s=n.n(o),a=n(565),l=n.n(a),c=n(216),u=n.n(c),h=n(589),f=n.n(h),d=n(760),p={};p.styleTagTransform=f(),p.setAttributes=l(),p.insert=s().bind(null,"head"),p.domAPI=i(),p.insertStyleElement=u(),t()(d.Z,p),d.Z&&d.Z.locals&&d.Z.locals;var g,m=1200,_=1252,v=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],y={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},b=function(e){-1!=v.indexOf(e)&&(_=y[0]=e)},w=function(e){m=e,b(e)};var x=function(e){return String.fromCharCode(e)},C=null,S="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function k(e){for(var t="",n=0,r=0,i=0,o=0,s=0,a=0,l=0,c=0;c<e.length;)o=(n=e.charCodeAt(c++))>>2,s=(3&n)<<4|(r=e.charCodeAt(c++))>>4,a=(15&r)<<2|(i=e.charCodeAt(c++))>>6,l=63&i,isNaN(r)?a=l=64:isNaN(i)&&(l=64),t+=S.charAt(o)+S.charAt(s)+S.charAt(a)+S.charAt(l);return t}function E(e){var t="",n=0,r=0,i=0,o=0,s=0,a=0;e=e.replace(/^data:([^\/]+\/[^\/]+)?;base64\,/,"").replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)n=S.indexOf(e.charAt(l++))<<2|(o=S.indexOf(e.charAt(l++)))>>4,t+=String.fromCharCode(n),r=(15&o)<<4|(s=S.indexOf(e.charAt(l++)))>>2,64!==s&&(t+=String.fromCharCode(r)),i=(3&s)<<6|(a=S.indexOf(e.charAt(l++))),64!==a&&(t+=String.fromCharCode(i));return t}var T=function(){return"undefined"!=typeof Buffer&&"undefined"!=typeof process&&void 0!==process.versions&&!!process.versions.node}(),I=function(){if("undefined"!=typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(t){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}(),A=function(){if("undefined"==typeof Buffer)return!1;var e=I([65,0]);return!!e&&1==e.toString("utf16le").length}();function D(e){return T?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function N(e){return T?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var O=function(e){return T?I(e,"binary"):e.split("").map((function(e){return 255&e.charCodeAt(0)}))};function P(e){if("undefined"==typeof ArrayBuffer)return O(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=255&e.charCodeAt(r);return t}var R=T?function(e){return Buffer.concat(e.map((function(e){return Buffer.isBuffer(e)?e:I(e)})))}:function(e){if("undefined"!=typeof Uint8Array){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var r=new Uint8Array(n),i=0;for(t=0,n=0;t<e.length;n+=i,++t)i=e[t].length,e[t]instanceof Uint8Array?r.set(e[t],n):"string"==typeof e[t]?r.set(new Uint8Array(O(e[t])),n):r.set(new Uint8Array(e[t]),n);return r}return[].concat.apply([],e.map((function(e){return Array.isArray(e)?e:[].slice.call(e)})))},M=/\u0000/g,F=/[\u0001-\u0006]/g;function L(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function j(e,t){var n=""+e;return n.length>=t?n:$e("0",t-n.length)+n}function z(e,t){var n=""+e;return n.length>=t?n:$e(" ",t-n.length)+n}function q(e,t){var n=""+e;return n.length>=t?n:n+$e(" ",t-n.length)}var U=Math.pow(2,32);function B(e,t){return e>U||e<-U?function(e,t){var n=""+Math.round(e);return n.length>=t?n:$e("0",t-n.length)+n}(e,t):function(e,t){var n=""+e;return n.length>=t?n:$e("0",t-n.length)+n}(Math.round(e),t)}function W(e,t){return t=t||0,e.length>=7+t&&103==(32|e.charCodeAt(t))&&101==(32|e.charCodeAt(t+1))&&110==(32|e.charCodeAt(t+2))&&101==(32|e.charCodeAt(t+3))&&114==(32|e.charCodeAt(t+4))&&97==(32|e.charCodeAt(t+5))&&108==(32|e.charCodeAt(t+6))}var H=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],V=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]],Y={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},G={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},K={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function X(e,t,n){for(var r=e<0?-1:1,i=e*r,o=0,s=1,a=0,l=1,c=0,u=0,h=Math.floor(i);c<t&&(a=(h=Math.floor(i))*s+o,u=h*c+l,!(i-h<5e-8));)i=1/(i-h),o=s,s=a,l=c,c=u;if(u>t&&(c>t?(u=l,a=o):(u=c,a=s)),!n)return[0,r*a,u];var f=Math.floor(r*a/u);return[f,r*a-f*u,u]}function J(e,t,n){if(e>2958465||e<0)return null;var r=0|e,i=Math.floor(86400*(e-r)),o=0,s=[],a={D:r,T:i,u:86400*(e-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(a.u)<1e-6&&(a.u=0),t&&t.date1904&&(r+=1462),a.u>.9999&&(a.u=0,86400==++i&&(a.T=i=0,++r,++a.D)),60===r)s=n?[1317,10,29]:[1900,2,29],o=3;else if(0===r)s=n?[1317,8,29]:[1900,1,0],o=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],o=l.getDay(),r<60&&(o=(o+6)%7),n&&(o=function(e,t){t[0]-=581;var n=e.getDay();return e<60&&(n=(n+6)%7),n}(l,s))}return a.y=s[0],a.m=s[1],a.d=s[2],a.S=i%60,i=Math.floor(i/60),a.M=i%60,i=Math.floor(i/60),a.H=i,a.q=o,a}var Q=new Date(1899,11,31,0,0,0),Z=Q.getTime(),ee=new Date(1900,2,1,0,0,0);function te(e,t){var n=e.getTime();return t?n-=1262304e5:e>=ee&&(n+=864e5),(n-(Z+6e4*(e.getTimezoneOffset()-Q.getTimezoneOffset())))/864e5}function ne(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function re(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):function(e){var t,n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=n>=-4&&n<=-1?e.toPrecision(10+n):Math.abs(n)<=9?function(e){var t=e<0?12:11,n=ne(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10)).length<=t?n:e.toExponential(5)}(e):10===n?e.toFixed(10).substr(0,12):function(e){var t=ne(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),ne(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return Ce(14,te(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function ie(e,t,n,r){var i,o="",s=0,a=0,l=n.y,c=0;switch(e){case 98:l=n.y+543;case 121:switch(t.length){case 1:case 2:i=l%100,c=2;break;default:i=l%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:i=n.m,c=t.length;break;case 3:return V[n.m-1][1];case 5:return V[n.m-1][0];default:return V[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:i=n.d,c=t.length;break;case 3:return H[n.q][0];default:return H[n.q][1]}break;case 104:switch(t.length){case 1:case 2:i=1+(n.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:i=n.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:i=n.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==n.u||"s"!=t&&"ss"!=t?(a=r>=2?3===r?1e3:100:1===r?10:1,(s=Math.round(a*(n.S+n.u)))>=60*a&&(s=0),"s"===t?0===s?"0":""+s/a:(o=j(s,2+r),"ss"===t?o.substr(0,2):"."+o.substr(2,t.length-1))):j(n.S,t.length);case 90:switch(t){case"[h]":case"[hh]":i=24*n.D+n.H;break;case"[m]":case"[mm]":i=60*(24*n.D+n.H)+n.M;break;case"[s]":case"[ss]":i=60*(60*(24*n.D+n.H)+n.M)+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:i=l,c=1}return c>0?j(i,c):""}function oe(e){if(e.length<=3)return e;for(var t=e.length%3,n=e.substr(0,t);t!=e.length;t+=3)n+=(n.length>0?",":"")+e.substr(t,3);return n}var se=/%/g;function ae(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+ae(e,-t);var i=e.indexOf(".");-1===i&&(i=e.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%i;if(o<0&&(o+=i),-1===(n=(t/Math.pow(10,o)).toPrecision(r+1+(i+o)%i)).indexOf("e")){var s=Math.floor(Math.log(t)*Math.LOG10E);for(-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(s-n.length+o):n+="E+"+(s-o);"0."===n.substr(0,2);)n=(n=n.charAt(0)+n.substr(2,i)+"."+n.substr(2+i)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,n,r){return t+n+r.substr(0,(i+o)%i)+"."+r.substr(o)+"E"}))}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var le=/# (\?+)( ?)\/( ?)(\d+)/,ce=/^#*0*\.([0#]+)/,ue=/\).*[0#]/,he=/\(###\) ###\\?-####/;function fe(e){for(var t,n="",r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function de(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function pe(e,t){var n=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(n*r)).length?0:Math.round(n*r)}function ge(e,t,n){if(40===e.charCodeAt(0)&&!t.match(ue)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?ge("n",r,n):"("+ge("n",r,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return ve(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}(e,t,n);if(-1!==t.indexOf("%"))return function(e,t,n){var r=t.replace(se,""),i=t.length-r.length;return ve(e,r,n*Math.pow(10,2*i))+$e("%",i)}(e,t,n);if(-1!==t.indexOf("E"))return ae(t,n);if(36===t.charCodeAt(0))return"$"+ge(e,t.substr(" "==t.charAt(1)?2:1),n);var i,o,s,a,l=Math.abs(n),c=n<0?"-":"";if(t.match(/^00+$/))return c+B(l,t.length);if(t.match(/^[#?]+$/))return"0"===(i=B(n,0))&&(i=""),i.length>t.length?i:fe(t.substr(0,t.length-i.length))+i;if(o=t.match(le))return function(e,t,n){var r=parseInt(e[4],10),i=Math.round(t*r),o=Math.floor(i/r),s=i-o*r,a=r;return n+(0===o?"":""+o)+" "+(0===s?$e(" ",e[1].length+1+e[4].length):z(s,e[1].length)+e[2]+"/"+e[3]+j(a,e[4].length))}(o,l,c);if(t.match(/^#+0+$/))return c+B(l,t.length-t.indexOf("0"));if(o=t.match(ce))return i=de(n,o[1].length).replace(/^([^\.]+)$/,"$1."+fe(o[1])).replace(/\.$/,"."+fe(o[1])).replace(/\.(\d*)$/,(function(e,t){return"."+t+$e("0",fe(o[1]).length-t.length)})),-1!==t.indexOf("0.")?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return c+de(l,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return c+oe(B(l,0));if(o=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+ge(e,t,-n):oe(""+(Math.floor(n)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(n,o[1].length)))+"."+j(pe(n,o[1].length),o[1].length);if(o=t.match(/^#,#*,#0/))return ge(e,t.replace(/^#,#*,/,""),n);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=L(ge(e,t.replace(/[\\-]/g,""),n)),s=0,L(L(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return s<i.length?i.charAt(s++):"0"===e?"0":""})));if(t.match(he))return"("+(i=ge(e,"##########",n)).substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(o[4].length,7),a=X(l,Math.pow(10,s)-1,!1),i=""+c," "==(u=ve("n",o[1],a[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),i+=u+o[2]+"/"+o[3],(u=q(a[2],s)).length<o[4].length&&(u=fe(o[4].substr(o[4].length-u.length))+u),i+=u;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(o[1].length,o[4].length),7),c+((a=X(l,Math.pow(10,s)-1,!0))[0]||(a[1]?"":"0"))+" "+(a[1]?z(a[1],s)+o[2]+"/"+o[3]+q(a[2],s):$e(" ",2*s+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return i=B(n,0),t.length<=i.length?i:fe(t.substr(0,t.length-i.length))+i;if(o=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var h=t.indexOf(".")-s,f=t.length-i.length-h;return fe(t.substr(0,h)+i+t.substr(t.length-f))}if(o=t.match(/^00,000\.([#0]*0)$/))return s=pe(n,o[1].length),n<0?"-"+ge(e,t,-n):oe(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?j(0,3-e.length):"")+e}))+"."+j(s,o[1].length);switch(t){case"###,##0.00":return ge(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var d=oe(B(l,0));return"0"!==d?c+d:"";case"###,###.00":return ge(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return ge(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function me(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+me(e,-t);var i=e.indexOf(".");-1===i&&(i=e.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%i;if(o<0&&(o+=i),!(n=(t/Math.pow(10,o)).toPrecision(r+1+(i+o)%i)).match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);-1===n.indexOf(".")?n=n.charAt(0)+"."+n.substr(1)+"E+"+(s-n.length+o):n+="E+"+(s-o),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,n,r){return t+n+r.substr(0,(i+o)%i)+"."+r.substr(o)+"E"}))}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function _e(e,t,n){if(40===e.charCodeAt(0)&&!t.match(ue)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?_e("n",r,n):"("+_e("n",r,-n)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,n){for(var r=t.length-1;44===t.charCodeAt(r-1);)--r;return ve(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}(e,t,n);if(-1!==t.indexOf("%"))return function(e,t,n){var r=t.replace(se,""),i=t.length-r.length;return ve(e,r,n*Math.pow(10,2*i))+$e("%",i)}(e,t,n);if(-1!==t.indexOf("E"))return me(t,n);if(36===t.charCodeAt(0))return"$"+_e(e,t.substr(" "==t.charAt(1)?2:1),n);var i,o,s,a,l=Math.abs(n),c=n<0?"-":"";if(t.match(/^00+$/))return c+j(l,t.length);if(t.match(/^[#?]+$/))return i=""+n,0===n&&(i=""),i.length>t.length?i:fe(t.substr(0,t.length-i.length))+i;if(o=t.match(le))return function(e,t,n){return n+(0===t?"":""+t)+$e(" ",e[1].length+2+e[4].length)}(o,l,c);if(t.match(/^#+0+$/))return c+j(l,t.length-t.indexOf("0"));if(o=t.match(ce))return i=(i=(""+n).replace(/^([^\.]+)$/,"$1."+fe(o[1])).replace(/\.$/,"."+fe(o[1]))).replace(/\.(\d*)$/,(function(e,t){return"."+t+$e("0",fe(o[1]).length-t.length)})),-1!==t.indexOf("0.")?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return c+oe(""+l);if(o=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+_e(e,t,-n):oe(""+n)+"."+$e("0",o[1].length);if(o=t.match(/^#,#*,#0/))return _e(e,t.replace(/^#,#*,/,""),n);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=L(_e(e,t.replace(/[\\-]/g,""),n)),s=0,L(L(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return s<i.length?i.charAt(s++):"0"===e?"0":""})));if(t.match(he))return"("+(i=_e(e,"##########",n)).substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(o[4].length,7),a=X(l,Math.pow(10,s)-1,!1),i=""+c," "==(u=ve("n",o[1],a[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),i+=u+o[2]+"/"+o[3],(u=q(a[2],s)).length<o[4].length&&(u=fe(o[4].substr(o[4].length-u.length))+u),i+=u;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(o[1].length,o[4].length),7),c+((a=X(l,Math.pow(10,s)-1,!0))[0]||(a[1]?"":"0"))+" "+(a[1]?z(a[1],s)+o[2]+"/"+o[3]+q(a[2],s):$e(" ",2*s+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return i=""+n,t.length<=i.length?i:fe(t.substr(0,t.length-i.length))+i;if(o=t.match(/^([#0]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var h=t.indexOf(".")-s,f=t.length-i.length-h;return fe(t.substr(0,h)+i+t.substr(t.length-f))}if(o=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+_e(e,t,-n):oe(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?j(0,3-e.length):"")+e}))+"."+j(0,o[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=oe(""+l);return"0"!==d?c+d:"";default:if(t.match(/\.[0#?]*$/))return _e(e,t.slice(0,t.lastIndexOf(".")),n)+fe(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ve(e,t,n){return(0|n)===n?_e(e,t,n):ge(e,t,n)}var ye=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function be(e){for(var t=0,n="",r="";t<e.length;)switch(n=e.charAt(t)){case"G":W(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("上午/下午"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(r=n;"]"!==e.charAt(t++)&&t<e.length;)r+=e.charAt(t);if(r.match(ye))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||"\\"==n&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var we=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function xe(e,t){if(null==t)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0}return!1}function Ce(e,t,n){null==n&&(n={});var r="";switch(typeof e){case"string":r="m/d/yy"==e&&n.dateNF?n.dateNF:e;break;case"number":null==(r=14==e&&n.dateNF?n.dateNF:(null!=n.table?n.table:Y)[e])&&(r=n.table&&n.table[G[e]]||Y[G[e]]),null==r&&(r=K[e]||"General")}if(W(r,0))return re(t,n);t instanceof Date&&(t=te(t,n.date1904));var i=function(e,t){var n=function(e){for(var t=[],n=!1,r=0,i=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(i,r-i),i=r+1}if(t[t.length]=e.substr(i),!0===n)throw new Error("Format |"+e+"| unterminated string ");return t}(e),r=n.length,i=n[r-1].indexOf("@");if(r<4&&i>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if("number"!=typeof t)return[4,4===n.length||i>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=i>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=i>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=i>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"]}var o=t>0?n[0]:t<0?n[1]:n[2];if(-1===n[0].indexOf("[")&&-1===n[1].indexOf("["))return[r,o];if(null!=n[0].match(/\[[=<>]/)||null!=n[1].match(/\[[=<>]/)){var s=n[0].match(we),a=n[1].match(we);return xe(t,s)?[r,n[0]]:xe(t,a)?[r,n[1]]:[r,n[null!=s&&null!=a?2:1]]}return[r,o]}(r,t);if(W(i[1]))return re(t,n);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,n,r){for(var i,o,s,a=[],l="",c=0,u="",h="t",f="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!W(e,c))throw new Error("unrecognized character "+u+" in "+e);a[a.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(s=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(s);a[a.length]={t:"t",v:l},++c;break;case"\\":var d=e.charAt(++c),p="("===d||")"===d?d:"t";a[a.length]={t:p,v:d},++c;break;case"_":a[a.length]={t:"t",v:" "},c+=2;break;case"@":a[a.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==i&&null==(i=J(t,n,"2"===e.charAt(c+1))))return"";a[a.length]={t:"X",v:e.substr(c,2)},h=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==i&&null==(i=J(t,n)))return"";for(l=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)l+=u;"m"===u&&"h"===h.toLowerCase()&&(u="M"),"h"===u&&(u=f),a[a.length]={t:u,v:l},h=u;break;case"A":case"a":case"上":var g={t:u,v:u};if(null==i&&(i=J(t,n)),"A/P"===e.substr(c,3).toUpperCase()?(null!=i&&(g.v=i.H>=12?e.charAt(c+2):u),g.t="T",f="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=i&&(g.v=i.H>=12?"PM":"AM"),g.t="T",c+=5,f="h"):"上午/下午"===e.substr(c,5).toUpperCase()?(null!=i&&(g.v=i.H>=12?"下午":"上午"),g.t="T",c+=5,f="h"):(g.t="t",++c),null==i&&"T"===g.t)return"";a[a.length]=g,h=u;break;case"[":for(l=u;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(ye)){if(null==i&&null==(i=J(t,n)))return"";a[a.length]={t:"Z",v:l.toLowerCase()},h=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",be(e)||(a[a.length]={t:"t",v:l}));break;case".":if(null!=i){for(l=u;++c<e.length&&"0"===(u=e.charAt(c));)l+=u;a[a.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++c<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(c))>-1;)l+=u;a[a.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++c)===u;)l+=u;a[a.length]={t:u,v:l},h=u;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":a[a.length]={t:1===r?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);a[a.length]={t:"D",v:l};break;case" ":a[a.length]={t:u,v:u},++c;break;case"$":a[a.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(u))throw new Error("unrecognized character "+u+" in "+e);a[a.length]={t:"t",v:u},++c}var m,_=0,v=0;for(c=a.length-1,h="t";c>=0;--c)switch(a[c].t){case"h":case"H":a[c].t=f,h="h",_<1&&(_=1);break;case"s":(m=a[c].v.match(/\.0+$/))&&(v=Math.max(v,m[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":h=a[c].t;break;case"m":"s"===h&&(a[c].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&a[c].v.match(/[Hh]/)&&(_=1),_<2&&a[c].v.match(/[Mm]/)&&(_=2),_<3&&a[c].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:i.u>=.5&&(i.u=0,++i.S),i.S>=60&&(i.S=0,++i.M),i.M>=60&&(i.M=0,++i.H);break;case 2:i.u>=.5&&(i.u=0,++i.S),i.S>=60&&(i.S=0,++i.M)}var y,b="";for(c=0;c<a.length;++c)switch(a[c].t){case"t":case"T":case" ":case"D":break;case"X":a[c].v="",a[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[c].v=ie(a[c].t.charCodeAt(0),a[c].v,i,v),a[c].t="t";break;case"n":case"?":for(y=c+1;null!=a[y]&&("?"===(u=a[y].t)||"D"===u||(" "===u||"t"===u)&&null!=a[y+1]&&("?"===a[y+1].t||"t"===a[y+1].t&&"/"===a[y+1].v)||"("===a[c].t&&(" "===u||"n"===u||")"===u)||"t"===u&&("/"===a[y].v||" "===a[y].v&&null!=a[y+1]&&"?"==a[y+1].t));)a[c].v+=a[y].v,a[y]={v:"",t:";"},++y;b+=a[c].v,c=y-1;break;case"G":a[c].t="t",a[c].v=re(t,n)}var w,x,C="";if(b.length>0){40==b.charCodeAt(0)?(w=t<0&&45===b.charCodeAt(0)?-t:t,x=ve("n",b,w)):(x=ve("n",b,w=t<0&&r>1?-t:t),w<0&&a[0]&&"t"==a[0].t&&(x=x.substr(1),a[0].v="-"+a[0].v)),y=x.length-1;var S=a.length;for(c=0;c<a.length;++c)if(null!=a[c]&&"t"!=a[c].t&&a[c].v.indexOf(".")>-1){S=c;break}var k=a.length;if(S===a.length&&-1===x.indexOf("E")){for(c=a.length-1;c>=0;--c)null!=a[c]&&-1!=="n?".indexOf(a[c].t)&&(y>=a[c].v.length-1?(y-=a[c].v.length,a[c].v=x.substr(y+1,a[c].v.length)):y<0?a[c].v="":(a[c].v=x.substr(0,y+1),y=-1),a[c].t="t",k=c);y>=0&&k<a.length&&(a[k].v=x.substr(0,y+1)+a[k].v)}else if(S!==a.length&&-1===x.indexOf("E")){for(y=x.indexOf(".")-1,c=S;c>=0;--c)if(null!=a[c]&&-1!=="n?".indexOf(a[c].t)){for(o=a[c].v.indexOf(".")>-1&&c===S?a[c].v.indexOf(".")-1:a[c].v.length-1,C=a[c].v.substr(o+1);o>=0;--o)y>=0&&("0"===a[c].v.charAt(o)||"#"===a[c].v.charAt(o))&&(C=x.charAt(y--)+C);a[c].v=C,a[c].t="t",k=c}for(y>=0&&k<a.length&&(a[k].v=x.substr(0,y+1)+a[k].v),y=x.indexOf(".")+1,c=S;c<a.length;++c)if(null!=a[c]&&(-1!=="n?(".indexOf(a[c].t)||c===S)){for(o=a[c].v.indexOf(".")>-1&&c===S?a[c].v.indexOf(".")+1:0,C=a[c].v.substr(0,o);o<a[c].v.length;++o)y<x.length&&(C+=x.charAt(y++));a[c].v=C,a[c].t="t",k=c}}}for(c=0;c<a.length;++c)null!=a[c]&&"n?".indexOf(a[c].t)>-1&&(w=r>1&&t<0&&c>0&&"-"===a[c-1].v?-t:t,a[c].v=ve(a[c].t,a[c].v,w),a[c].t="t");var E="";for(c=0;c!==a.length;++c)null!=a[c]&&(E+=a[c].v);return E}(i[1],t,n,i[0])}function Se(e,t){if("number"!=typeof t){t=+t||-1;for(var n=0;n<392;++n)if(null!=Y[n]){if(Y[n]==e){t=n;break}}else t<0&&(t=n);t<0&&(t=391)}return Y[t]=e,t}var ke={"d.m":"d\\.m"};var Ee,Te=function(){var e={version:"1.2.0"},t=function(){for(var e=0,t=new Array(256),n=0;256!=n;++n)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=n)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[n]=e;return"undefined"!=typeof Int32Array?new Int32Array(t):t}(),n=function(e){var t=0,n=0,r=0,i="undefined"!=typeof Int32Array?new Int32Array(4096):new Array(4096);for(r=0;256!=r;++r)i[r]=e[r];for(r=0;256!=r;++r)for(n=e[r],t=256+r;t<4096;t+=256)n=i[t]=n>>>8^e[255&n];var o=[];for(r=1;16!=r;++r)o[r-1]="undefined"!=typeof Int32Array&&"function"==typeof i.subarray?i.subarray(256*r,256*r+256):i.slice(256*r,256*r+256);return o}(t),r=n[0],i=n[1],o=n[2],s=n[3],a=n[4],l=n[5],c=n[6],u=n[7],h=n[8],f=n[9],d=n[10],p=n[11],g=n[12],m=n[13],_=n[14];return e.table=t,e.bstr=function(e,n){for(var r=-1^n,i=0,o=e.length;i<o;)r=r>>>8^t[255&(r^e.charCodeAt(i++))];return~r},e.buf=function(e,n){for(var v=-1^n,y=e.length-15,b=0;b<y;)v=_[e[b++]^255&v]^m[e[b++]^v>>8&255]^g[e[b++]^v>>16&255]^p[e[b++]^v>>>24]^d[e[b++]]^f[e[b++]]^h[e[b++]]^u[e[b++]]^c[e[b++]]^l[e[b++]]^a[e[b++]]^s[e[b++]]^o[e[b++]]^i[e[b++]]^r[e[b++]]^t[e[b++]];for(y+=15;b<y;)v=v>>>8^t[255&(v^e[b++])];return~v},e.str=function(e,n){for(var r=-1^n,i=0,o=e.length,s=0,a=0;i<o;)(s=e.charCodeAt(i++))<128?r=r>>>8^t[255&(r^s)]:s<2048?r=(r=r>>>8^t[255&(r^(192|s>>6&31))])>>>8^t[255&(r^(128|63&s))]:s>=55296&&s<57344?(s=64+(1023&s),a=1023&e.charCodeAt(i++),r=(r=(r=(r=r>>>8^t[255&(r^(240|s>>8&7))])>>>8^t[255&(r^(128|s>>2&63))])>>>8^t[255&(r^(128|a>>6&15|(3&s)<<4))])>>>8^t[255&(r^(128|63&a))]):r=(r=(r=r>>>8^t[255&(r^(224|s>>12&15))])>>>8^t[255&(r^(128|s>>6&63))])>>>8^t[255&(r^(128|63&s))];return~r},e}(),Ie=function(){var e,t={};function n(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:n(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function r(e){if("/"==e.charAt(e.length-1))return r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function i(e,t){"string"==typeof t&&(t=new Date(t));var n=t.getHours();n=(n=n<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,n);var r=t.getFullYear()-1980;r=(r=r<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,r)}function o(e){Vt(e,0);for(var t={},n=0;e.l<=e.length-4;){var r=e.read_shift(2),i=e.read_shift(2),o=e.l+i,s={};switch(r){case 21589:1&(n=e.read_shift(1))&&(s.mtime=e.read_shift(4)),i>5&&(2&n&&(s.atime=e.read_shift(4)),4&n&&(s.ctime=e.read_shift(4))),s.mtime&&(s.mt=new Date(1e3*s.mtime));break;case 1:var a=e.read_shift(4),l=e.read_shift(4);s.usz=l*Math.pow(2,32)+a,a=e.read_shift(4),l=e.read_shift(4),s.csz=l*Math.pow(2,32)+a}e.l=o,t[r]=s}return t}function s(){return e||(e=Ee)}function a(e,t){if(80==e[0]&&75==e[1])return de(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=x(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var n=t&&t.root||"",r=(T&&Buffer.isBuffer(e)?e.toString("binary"):x(e)).split("\r\n"),i=0,o="";for(i=0;i<r.length;++i)if(o=r[i],/^Content-Location:/i.test(o)&&(o=o.slice(o.indexOf("file")),n||(n=o.slice(0,o.lastIndexOf("/")+1)),o.slice(0,n.length)!=n))for(;n.length>0&&(n=(n=n.slice(0,n.length-1)).slice(0,n.lastIndexOf("/")+1),o.slice(0,n.length)!=n););var s=(r[1]||"").match(/boundary="(.*?)"/);if(!s)throw new Error("MAD cannot find boundary");var a="--"+(s[1]||""),l={FileIndex:[],FullPaths:[]};f(l);var c,u=0;for(i=0;i<r.length;++i){var h=r[i];h!==a&&h!==a+"--"||(u++&&ye(l,r.slice(c,i),n),c=i)}return l}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var n,r,i,o,s,a,d=512,p=[],g=e.slice(0,512);Vt(g,0);var m=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(v,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(g);switch(n=m[0]){case 3:d=512;break;case 4:d=4096;break;case 0:if(0==m[1])return de(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+n)}512!==d&&Vt(g=e.slice(0,d),28);var y=e.slice(0,d);!function(e,t){var n;switch(e.l+=2,n=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+n);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+n);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+n)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(g,n);var b=g.read_shift(4,"i");if(3===n&&0!==b)throw new Error("# Directory Sectors: Expected 0 saw "+b);g.l+=4,o=g.read_shift(4,"i"),g.l+=4,g.chk("00100000","Mini Stream Cutoff Size: "),s=g.read_shift(4,"i"),r=g.read_shift(4,"i"),a=g.read_shift(4,"i"),i=g.read_shift(4,"i");for(var w=-1,C=0;C<109&&!((w=g.read_shift(4,"i"))<0);++C)p[C]=w;var S=function(e,t){for(var n=Math.ceil(e.length/t)-1,r=[],i=1;i<n;++i)r[i-1]=e.slice(i*t,(i+1)*t);return r[n-1]=e.slice(n*t),r}(e,d);c(a,i,S,d,p);var k=function(e,t,n,r){var i=e.length,o=[],s=[],a=[],l=[],c=r-1,u=0,h=0,f=0,d=0;for(u=0;u<i;++u)if(a=[],(f=u+t)>=i&&(f-=i),!s[f]){l=[];var p=[];for(h=f;h>=0;){p[h]=!0,s[h]=!0,a[a.length]=h,l.push(e[h]);var g=n[Math.floor(4*h/r)];if(r<4+(d=4*h&c))throw new Error("FAT boundary crossed: "+h+" 4 "+r);if(!e[g])break;if(p[h=jt(e[g],d)])break}o[f]={nodes:a,data:gt([l])}}return o}(S,o,p,d);o<k.length&&(k[o].name="!Directory"),r>0&&s!==_&&(k[s].name="!MiniFAT"),k[p[0]].name="!FAT",k.fat_addrs=p,k.ssz=d;var E=[],I=[],A=[];!function(e,t,n,r,i,o,s,a){for(var c,f=0,d=r.length?2:0,p=t[e].data,g=0,m=0;g<p.length;g+=128){var v=p.slice(g,g+128);Vt(v,64),m=v.read_shift(2),c=_t(v,0,m-d),r.push(c);var y={name:c,type:v.read_shift(1),color:v.read_shift(1),L:v.read_shift(4,"i"),R:v.read_shift(4,"i"),C:v.read_shift(4,"i"),clsid:v.read_shift(16),state:v.read_shift(4,"i"),start:0,size:0};0!==v.read_shift(2)+v.read_shift(2)+v.read_shift(2)+v.read_shift(2)&&(y.ct=h(v,v.l-8)),0!==v.read_shift(2)+v.read_shift(2)+v.read_shift(2)+v.read_shift(2)&&(y.mt=h(v,v.l-8)),y.start=v.read_shift(4,"i"),y.size=v.read_shift(4,"i"),y.size<0&&y.start<0&&(y.size=y.type=0,y.start=_,y.name=""),5===y.type?(f=y.start,i>0&&f!==_&&(t[f].name="!StreamData")):y.size>=4096?(y.storage="fat",void 0===t[y.start]&&(t[y.start]=u(n,y.start,t.fat_addrs,t.ssz)),t[y.start].name=y.name,y.content=t[y.start].data.slice(0,y.size)):(y.storage="minifat",y.size<0?y.size=0:f!==_&&y.start!==_&&t[f]&&(y.content=l(y,t[f].data,(t[a]||{}).data))),y.content&&Vt(y.content,0),o[c]=y,s.push(y)}}(o,k,S,E,r,{},I,s),function(e,t,n){for(var r=0,i=0,o=0,s=0,a=0,l=n.length,c=[],u=[];r<l;++r)c[r]=u[r]=r,t[r]=n[r];for(;a<u.length;++a)i=e[r=u[a]].L,o=e[r].R,s=e[r].C,c[r]===r&&(-1!==i&&c[i]!==i&&(c[r]=c[i]),-1!==o&&c[o]!==o&&(c[r]=c[o])),-1!==s&&(c[s]=r),-1!==i&&r!=c[r]&&(c[i]=c[r],u.lastIndexOf(i)<a&&u.push(i)),-1!==o&&r!=c[r]&&(c[o]=c[r],u.lastIndexOf(o)<a&&u.push(o));for(r=1;r<l;++r)c[r]===r&&(-1!==o&&c[o]!==o?c[r]=c[o]:-1!==i&&c[i]!==i&&(c[r]=c[i]));for(r=1;r<l;++r)if(0!==e[r].type){if((a=r)!=c[a])do{a=c[a],t[r]=t[a]+"/"+t[r]}while(0!==a&&-1!==c[a]&&a!=c[a]);c[r]=-1}for(t[0]+="/",r=1;r<l;++r)2!==e[r].type&&(t[r]+="/")}(I,A,E),E.shift();var D={FileIndex:I,FullPaths:A};return t&&t.raw&&(D.raw={header:y,sectors:S}),D}function l(e,t,n){for(var r=e.start,i=e.size,o=[],s=r;n&&i>0&&s>=0;)o.push(t.slice(s*m,s*m+m)),i-=m,s=jt(n,4*s);return 0===o.length?Yt(0):R(o).slice(0,e.size)}function c(e,t,n,r,i){var o=_;if(e===_){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var s=n[e],a=(r>>>2)-1;if(!s)return;for(var l=0;l<a&&(o=jt(s,4*l))!==_;++l)i.push(o);t>=1&&c(jt(s,r-4),t-1,n,r,i)}}function u(e,t,n,r,i){var o=[],s=[];i||(i=[]);var a=r-1,l=0,c=0;for(l=t;l>=0;){i[l]=!0,o[o.length]=l,s.push(e[l]);var u=n[Math.floor(4*l/r)];if(r<4+(c=4*l&a))throw new Error("FAT boundary crossed: "+l+" 4 "+r);if(!e[u])break;l=jt(e[u],c)}return{nodes:o,data:gt([s])}}function h(e,t){return new Date(1e3*(Lt(e,t+4)/1e7*Math.pow(2,32)+Lt(e,t)/1e7-11644473600))}function f(e,t){var n=t||{},r=n.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=r+"/",e.FileIndex[0]={name:r,type:5}),n.CLSID&&(e.FileIndex[0].clsid=n.CLSID),function(e){var t="Sh33tJ5";if(!Ie.find(e,"/"+t)){var n=Yt(4);n[0]=55,n[1]=n[3]=50,n[2]=54,e.FileIndex.push({name:t,type:2,content:n,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),d(e)}}(e)}function d(e,t){f(e);for(var i=!1,o=!1,s=e.FullPaths.length-1;s>=0;--s){var a=e.FileIndex[s];switch(a.type){case 0:o?i=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:o=!0,isNaN(a.R*a.L*a.C)&&(i=!0),a.R>-1&&a.L>-1&&a.R==a.L&&(i=!0);break;default:i=!0}}if(i||t){var l=new Date(1987,1,19),c=0,u=Object.create?Object.create(null):{},h=[];for(s=0;s<e.FullPaths.length;++s)u[e.FullPaths[s]]=!0,0!==e.FileIndex[s].type&&h.push([e.FullPaths[s],e.FileIndex[s]]);for(s=0;s<h.length;++s){var d=n(h[s][0]);for(o=u[d];!o;){for(;n(d)&&!u[n(d)];)d=n(d);h.push([d,{name:r(d).replace("/",""),type:1,clsid:b,ct:l,mt:l,content:null}]),u[d]=!0,o=u[d=n(h[s][0])]}}for(h.sort((function(e,t){return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0,o=0,s=Math.min(n.length,r.length);i<s;++i){if(o=n[i].length-r[i].length)return o;if(n[i]!=r[i])return n[i]<r[i]?-1:1}return n.length-r.length}(e[0],t[0])})),e.FullPaths=[],e.FileIndex=[],s=0;s<h.length;++s)e.FullPaths[s]=h[s][0],e.FileIndex[s]=h[s][1];for(s=0;s<h.length;++s){var p=e.FileIndex[s],g=e.FullPaths[s];if(p.name=r(g).replace("/",""),p.L=p.R=p.C=-(p.color=1),p.size=p.content?p.content.length:0,p.start=0,p.clsid=p.clsid||b,0===s)p.C=h.length>1?1:-1,p.size=0,p.type=5;else if("/"==g.slice(-1)){for(c=s+1;c<h.length&&n(e.FullPaths[c])!=g;++c);for(p.C=c>=h.length?-1:c,c=s+1;c<h.length&&n(e.FullPaths[c])!=n(g);++c);p.R=c>=h.length?-1:c,p.type=1}else n(e.FullPaths[s+1]||"")==n(g)&&(p.R=s+1),p.type=2}}}function p(e,t){var n=t||{};if("mad"==n.fileType)return function(e,t){for(var n=t||{},r=n.boundary||"SheetJS",i=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(r="------="+r).slice(2)+'"',"","",""],o=e.FullPaths[0],s=o,a=e.FileIndex[0],l=1;l<e.FullPaths.length;++l)if(s=e.FullPaths[l].slice(o.length),(a=e.FileIndex[l]).size&&a.content&&"Sh33tJ5"!=s){s=s.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,(function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"})).replace(/[\u0080-\uFFFF]/g,(function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"}));for(var c=a.content,u=T&&Buffer.isBuffer(c)?c.toString("binary"):x(c),h=0,f=Math.min(1024,u.length),d=0,p=0;p<=f;++p)(d=u.charCodeAt(p))>=32&&d<128&&++h;var g=h>=4*f/5;i.push(r),i.push("Content-Location: "+(n.root||"file:///C:/SheetJS/")+s),i.push("Content-Transfer-Encoding: "+(g?"quoted-printable":"base64")),i.push("Content-Type: "+me(a,s)),i.push(""),i.push(g?ve(u):_e(u))}return i.push(r+"--\r\n"),i.join("\r\n")}(e,n);if(d(e),"zip"===n.fileType)return function(e,t){var n,r=t||{},o=[],s=[],a=Yt(1),l=r.compression?8:0,c=0,u=0,h=0,f=0,d=e.FullPaths[0],p=d,m=e.FileIndex[0],_=[],v=0;for(c=1;c<e.FullPaths.length;++c)if(p=e.FullPaths[c].slice(d.length),(m=e.FileIndex[c]).size&&m.content&&"Sh33tJ5"!=p){var y=h,b=Yt(p.length);for(u=0;u<p.length;++u)b.write_shift(1,127&p.charCodeAt(u));b=b.slice(0,b.l),_[f]="string"==typeof m.content?Te.bstr(m.content,0):Te.buf(m.content,0);var w="string"==typeof m.content?O(m.content):m.content;8==l&&(n=w,w=g?g.deflateRawSync(n):ie(n)),(a=Yt(30)).write_shift(4,67324752),a.write_shift(2,20),a.write_shift(2,0),a.write_shift(2,l),m.mt?i(a,m.mt):a.write_shift(4,0),a.write_shift(-4,_[f]),a.write_shift(4,w.length),a.write_shift(4,m.content.length),a.write_shift(2,b.length),a.write_shift(2,0),h+=a.length,o.push(a),h+=b.length,o.push(b),h+=w.length,o.push(w),(a=Yt(46)).write_shift(4,33639248),a.write_shift(2,0),a.write_shift(2,20),a.write_shift(2,0),a.write_shift(2,l),a.write_shift(4,0),a.write_shift(-4,_[f]),a.write_shift(4,w.length),a.write_shift(4,m.content.length),a.write_shift(2,b.length),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(4,0),a.write_shift(4,y),v+=a.l,s.push(a),v+=b.length,s.push(b),++f}return(a=Yt(22)).write_shift(4,101010256),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,f),a.write_shift(2,f),a.write_shift(4,v),a.write_shift(4,h),a.write_shift(2,0),R([R(o),R(s),a])}(e,n);var r=function(e){for(var t=0,n=0,r=0;r<e.FileIndex.length;++r){var i=e.FileIndex[r];if(i.content){var o=i.content.length;o>0&&(o<4096?t+=o+63>>6:n+=o+511>>9)}}for(var s=e.FullPaths.length+3>>2,a=t+127>>7,l=(t+7>>3)+n+s+a,c=l+127>>7,u=c<=109?0:Math.ceil((c-109)/127);l+c+u+127>>7>c;)u=++c<=109?0:Math.ceil((c-109)/127);var h=[1,u,c,a,s,n,t,0];return e.FileIndex[0].size=t<<6,h[7]=(e.FileIndex[0].start=h[0]+h[1]+h[2]+h[3]+h[4]+h[5])+(h[6]+7>>3),h}(e),o=Yt(r[7]<<9),s=0,a=0;for(s=0;s<8;++s)o.write_shift(1,y[s]);for(s=0;s<8;++s)o.write_shift(2,0);for(o.write_shift(2,62),o.write_shift(2,3),o.write_shift(2,65534),o.write_shift(2,9),o.write_shift(2,6),s=0;s<3;++s)o.write_shift(2,0);for(o.write_shift(4,0),o.write_shift(4,r[2]),o.write_shift(4,r[0]+r[1]+r[2]+r[3]-1),o.write_shift(4,0),o.write_shift(4,4096),o.write_shift(4,r[3]?r[0]+r[1]+r[2]-1:_),o.write_shift(4,r[3]),o.write_shift(-4,r[1]?r[0]-1:_),o.write_shift(4,r[1]),s=0;s<109;++s)o.write_shift(-4,s<r[2]?r[1]+s:-1);if(r[1])for(a=0;a<r[1];++a){for(;s<236+127*a;++s)o.write_shift(-4,s<r[2]?r[1]+s:-1);o.write_shift(-4,a===r[1]-1?_:a+1)}var l=function(e){for(a+=e;s<a-1;++s)o.write_shift(-4,s+1);e&&(++s,o.write_shift(-4,_))};for(a=s=0,a+=r[1];s<a;++s)o.write_shift(-4,w.DIFSECT);for(a+=r[2];s<a;++s)o.write_shift(-4,w.FATSECT);l(r[3]),l(r[4]);for(var c=0,u=0,h=e.FileIndex[0];c<e.FileIndex.length;++c)(h=e.FileIndex[c]).content&&((u=h.content.length)<4096||(h.start=a,l(u+511>>9)));for(l(r[6]+7>>3);511&o.l;)o.write_shift(-4,w.ENDOFCHAIN);for(a=s=0,c=0;c<e.FileIndex.length;++c)(h=e.FileIndex[c]).content&&(!(u=h.content.length)||u>=4096||(h.start=a,l(u+63>>6)));for(;511&o.l;)o.write_shift(-4,w.ENDOFCHAIN);for(s=0;s<r[4]<<2;++s){var f=e.FullPaths[s];if(f&&0!==f.length){h=e.FileIndex[s],0===s&&(h.start=h.size?h.start-1:_);var p=0===s&&n.root||h.name;if(p.length>32&&(console.error("Name "+p+" will be truncated to "+p.slice(0,32)),p=p.slice(0,32)),u=2*(p.length+1),o.write_shift(64,p,"utf16le"),o.write_shift(2,u),o.write_shift(1,h.type),o.write_shift(1,h.color),o.write_shift(-4,h.L),o.write_shift(-4,h.R),o.write_shift(-4,h.C),h.clsid)o.write_shift(16,h.clsid,"hex");else for(c=0;c<4;++c)o.write_shift(4,0);o.write_shift(4,h.state||0),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(4,h.start),o.write_shift(4,h.size),o.write_shift(4,0)}else{for(c=0;c<17;++c)o.write_shift(4,0);for(c=0;c<3;++c)o.write_shift(4,-1);for(c=0;c<12;++c)o.write_shift(4,0)}}for(s=1;s<e.FileIndex.length;++s)if((h=e.FileIndex[s]).size>=4096)if(o.l=h.start+1<<9,T&&Buffer.isBuffer(h.content))h.content.copy(o,o.l,0,h.size),o.l+=h.size+511&-512;else{for(c=0;c<h.size;++c)o.write_shift(1,h.content[c]);for(;511&c;++c)o.write_shift(1,0)}for(s=1;s<e.FileIndex.length;++s)if((h=e.FileIndex[s]).size>0&&h.size<4096)if(T&&Buffer.isBuffer(h.content))h.content.copy(o,o.l,0,h.size),o.l+=h.size+63&-64;else{for(c=0;c<h.size;++c)o.write_shift(1,h.content[c]);for(;63&c;++c)o.write_shift(1,0)}if(T)o.l=o.length;else for(;o.l<o.length;)o.write_shift(1,0);return o}t.version="1.2.2";var g,m=64,_=-2,v="d0cf11e0a1b11ae1",y=[208,207,17,224,161,177,26,225],b="00000000000000000000000000000000",w={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:_,FREESECT:-1,HEADER_SIGNATURE:v,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:b,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function x(e){for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}for(var C,S,A=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],P=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],L=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],j="undefined"!=typeof Uint8Array,z=j?new Uint8Array(256):[],$=0;$<256;++$)z[$]=(void 0,255&((S=139536&((C=$)<<1|C<<11)|558144&(C<<5|C<<15))>>16|S>>8|S));function q(e,t){var n=z[255&e];return t<=8?n>>>8-t:(n=n<<8|z[e>>8&255],t<=16?n>>>16-t:(n=n<<8|z[e>>16&255])>>>24-t)}function U(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=6?0:e[r+1]<<8))>>>n&3}function B(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=5?0:e[r+1]<<8))>>>n&7}function W(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=3?0:e[r+1]<<8))>>>n&31}function H(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=1?0:e[r+1]<<8))>>>n&127}function V(e,t,n){var r=7&t,i=t>>>3,o=(1<<n)-1,s=e[i]>>>r;return n<8-r?s&o:(s|=e[i+1]<<8-r,n<16-r?s&o:(s|=e[i+2]<<16-r,n<24-r?s&o:(s|=e[i+3]<<24-r)&o))}function Y(e,t,n){var r=7&t,i=t>>>3;return r<=5?e[i]|=(7&n)<<r:(e[i]|=n<<r&255,e[i+1]=(7&n)>>8-r),t+3}function G(e,t,n){return n=(1&n)<<(7&t),e[t>>>3]|=n,t+1}function K(e,t,n){var r=t>>>3;return n<<=7&t,e[r]|=255&n,n>>>=8,e[r+1]=n,t+8}function X(e,t,n){var r=t>>>3;return n<<=7&t,e[r]|=255&n,n>>>=8,e[r+1]=255&n,e[r+2]=n>>>8,t+16}function J(e,t){var n=e.length,r=2*n>t?2*n:t+5,i=0;if(n>=t)return e;if(T){var o=N(r);if(e.copy)e.copy(o);else for(;i<e.length;++i)o[i]=e[i];return o}if(j){var s=new Uint8Array(r);if(s.set)s.set(e);else for(;i<n;++i)s[i]=e[i];return s}return e.length=r,e}function Q(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=0;return t}function Z(e,t,n){var r=1,i=0,o=0,s=0,a=0,l=e.length,c=j?new Uint16Array(32):Q(32);for(o=0;o<32;++o)c[o]=0;for(o=l;o<n;++o)e[o]=0;l=e.length;var u=j?new Uint16Array(l):Q(l);for(o=0;o<l;++o)c[i=e[o]]++,r<i&&(r=i),u[o]=0;for(c[0]=0,o=1;o<=r;++o)c[o+16]=a=a+c[o-1]<<1;for(o=0;o<l;++o)0!=(a=e[o])&&(u[o]=c[a+16]++);var h=0;for(o=0;o<l;++o)if(0!=(h=e[o]))for(a=q(u[o],r)>>r-h,s=(1<<r+4-h)-1;s>=0;--s)t[a|s<<h]=15&h|o<<4;return r}var ee=j?new Uint16Array(512):Q(512),te=j?new Uint16Array(32):Q(32);if(!j){for(var ne=0;ne<512;++ne)ee[ne]=0;for(ne=0;ne<32;++ne)te[ne]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);Z(e,te,32);var n=[];for(t=0;t<=143;t++)n.push(8);for(;t<=255;t++)n.push(9);for(;t<=279;t++)n.push(7);for(;t<=287;t++)n.push(8);Z(n,ee,288)}();var re=function(){for(var e=j?new Uint8Array(32768):[],t=0,n=0;t<L.length-1;++t)for(;n<L[t+1];++n)e[n]=t;for(;n<32768;++n)e[n]=29;var r=j?new Uint8Array(259):[];for(t=0,n=0;t<P.length-1;++t)for(;n<P[t+1];++n)r[n]=t;return function(t,n){return t.length<8?function(e,t){for(var n=0;n<e.length;){var r=Math.min(65535,e.length-n),i=n+r==e.length;for(t.write_shift(1,+i),t.write_shift(2,r),t.write_shift(2,65535&~r);r-- >0;)t[t.l++]=e[n++]}return t.l}(t,n):function(t,n){for(var i=0,o=0,s=j?new Uint16Array(32768):[];o<t.length;){var a=Math.min(65535,t.length-o);if(a<10){for(7&(i=Y(n,i,+!(o+a!=t.length)))&&(i+=8-(7&i)),n.l=i/8|0,n.write_shift(2,a),n.write_shift(2,65535&~a);a-- >0;)n[n.l++]=t[o++];i=8*n.l}else{i=Y(n,i,+!(o+a!=t.length)+2);for(var l=0;a-- >0;){var c=t[o],u=-1,h=0;if((u=s[l=32767&(l<<5^c)])&&((u|=-32768&o)>o&&(u-=32768),u<o))for(;t[u+h]==t[o+h]&&h<250;)++h;if(h>2){(c=r[h])<=22?i=K(n,i,z[c+1]>>1)-1:(K(n,i,3),K(n,i+=5,z[c-23]>>5),i+=3);var f=c<8?0:c-4>>2;f>0&&(X(n,i,h-P[c]),i+=f),c=e[o-u],i=K(n,i,z[c]>>3),i-=3;var d=c<4?0:c-2>>1;d>0&&(X(n,i,o-u-L[c]),i+=d);for(var p=0;p<h;++p)s[l]=32767&o,l=32767&(l<<5^t[o]),++o;a-=h-1}else c<=143?c+=48:i=G(n,i,1),i=K(n,i,z[c]),s[l]=32767&o,++o}i=K(n,i,0)-1}}return n.l=(i+7)/8|0,n.l}(t,n)}}();function ie(e){var t=Yt(50+Math.floor(1.1*e.length)),n=re(e,t);return t.slice(0,n)}var oe=j?new Uint16Array(32768):Q(32768),se=j?new Uint16Array(32768):Q(32768),ae=j?new Uint16Array(128):Q(128),le=1,ce=1;function ue(e,t){var n=W(e,t)+257,r=W(e,t+=5)+1,i=function(e,t){var n=7&t,r=t>>>3;return(e[r]|(n<=4?0:e[r+1]<<8))>>>n&15}(e,t+=5)+4;t+=4;for(var o=0,s=j?new Uint8Array(19):Q(19),a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,c=j?new Uint8Array(8):Q(8),u=j?new Uint8Array(8):Q(8),h=s.length,f=0;f<i;++f)s[A[f]]=o=B(e,t),l<o&&(l=o),c[o]++,t+=3;var d=0;for(c[0]=0,f=1;f<=l;++f)u[f]=d=d+c[f-1]<<1;for(f=0;f<h;++f)0!=(d=s[f])&&(a[f]=u[d]++);var p=0;for(f=0;f<h;++f)if(0!=(p=s[f])){d=z[a[f]]>>8-p;for(var g=(1<<7-p)-1;g>=0;--g)ae[d|g<<p]=7&p|f<<3}var m=[];for(l=1;m.length<n+r;)switch(t+=7&(d=ae[H(e,t)]),d>>>=3){case 16:for(o=3+U(e,t),t+=2,d=m[m.length-1];o-- >0;)m.push(d);break;case 17:for(o=3+B(e,t),t+=3;o-- >0;)m.push(0);break;case 18:for(o=11+H(e,t),t+=7;o-- >0;)m.push(0);break;default:m.push(d),l<d&&(l=d)}var _=m.slice(0,n),v=m.slice(n);for(f=n;f<286;++f)_[f]=0;for(f=r;f<30;++f)v[f]=0;return le=Z(_,oe,286),ce=Z(v,se,30),t}function he(e,t){var n=function(e,t){if(3==e[0]&&!(3&e[1]))return[D(t),2];for(var n=0,r=0,i=N(t||1<<18),o=0,s=i.length>>>0,a=0,l=0;0==(1&r);)if(r=B(e,n),n+=3,r>>>1!=0)for(r>>1==1?(a=9,l=5):(n=ue(e,n),a=le,l=ce);;){!t&&s<o+32767&&(s=(i=J(i,o+32767)).length);var c=V(e,n,a),u=r>>>1==1?ee[c]:oe[c];if(n+=15&u,0==((u>>>=4)>>>8&255))i[o++]=u;else{if(256==u)break;var h=(u-=257)<8?0:u-4>>2;h>5&&(h=0);var f=o+P[u];h>0&&(f+=V(e,n,h),n+=h),c=V(e,n,l),n+=15&(u=r>>>1==1?te[c]:se[c]);var d=(u>>>=4)<4?0:u-2>>1,p=L[u];for(d>0&&(p+=V(e,n,d),n+=d),!t&&s<f&&(s=(i=J(i,f+100)).length);o<f;)i[o]=i[o-p],++o}}else{7&n&&(n+=8-(7&n));var g=e[n>>>3]|e[1+(n>>>3)]<<8;if(n+=32,g>0)for(!t&&s<o+g&&(s=(i=J(i,o+g)).length);g-- >0;)i[o++]=e[n>>>3],n+=8}return t?[i,n+7>>>3]:[i.slice(0,o),n+7>>>3]}(e.slice(e.l||0),t);return e.l+=n[1],n[0]}function fe(e,t){if(!e)throw new Error(t);"undefined"!=typeof console&&console.error(t)}function de(e,t){var n=e;Vt(n,0);var r={FileIndex:[],FullPaths:[]};f(r,{root:t.root});for(var i=n.length-4;(80!=n[i]||75!=n[i+1]||5!=n[i+2]||6!=n[i+3])&&i>=0;)--i;n.l=i+4,n.l+=4;var s=n.read_shift(2);n.l+=6;var a=n.read_shift(4);for(n.l=a,i=0;i<s;++i){n.l+=20;var l=n.read_shift(4),c=n.read_shift(4),u=n.read_shift(2),h=n.read_shift(2),d=n.read_shift(2);n.l+=8;var p=n.read_shift(4),g=o(n.slice(n.l+u,n.l+u+h));n.l+=u+h+d;var m=n.l;n.l=p+4,g&&g[1]&&((g[1]||{}).usz&&(c=g[1].usz),(g[1]||{}).csz&&(l=g[1].csz)),pe(n,l,c,r,g),n.l=m}return r}function pe(e,t,n,r,i){e.l+=2;var s=e.read_shift(2),a=e.read_shift(2),l=function(e){var t=65535&e.read_shift(2),n=65535&e.read_shift(2),r=new Date,i=31&n,o=15&(n>>>=5);n>>>=4,r.setMilliseconds(0),r.setFullYear(n+1980),r.setMonth(o-1),r.setDate(i);var s=31&t,a=63&(t>>>=5);return t>>>=6,r.setHours(t),r.setMinutes(a),r.setSeconds(s<<1),r}(e);if(8257&s)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var c=e.read_shift(4),u=e.read_shift(4),h=e.read_shift(2),f=e.read_shift(2),d="",p=0;p<h;++p)d+=String.fromCharCode(e[e.l++]);if(f){var m=o(e.slice(e.l,e.l+f));(m[21589]||{}).mt&&(l=m[21589].mt),(m[1]||{}).usz&&(u=m[1].usz),(m[1]||{}).csz&&(c=m[1].csz),i&&((i[21589]||{}).mt&&(l=i[21589].mt),(i[1]||{}).usz&&(u=m[1].usz),(i[1]||{}).csz&&(c=m[1].csz))}e.l+=f;var _=e.slice(e.l,e.l+c);switch(a){case 8:_=function(e,t){if(!g)return he(e,t);var n=new(0,g.InflateRaw),r=n._processChunk(e.slice(e.l),n._finishFlushFlag);return e.l+=n.bytesRead,r}(e,u);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+a)}var v=!1;8&s&&(134695760==e.read_shift(4)&&(e.read_shift(4),v=!0),c=e.read_shift(4),u=e.read_shift(4)),c!=t&&fe(v,"Bad compressed size: "+t+" != "+c),u!=n&&fe(v,"Bad uncompressed size: "+n+" != "+u),be(r,d,_,{unsafe:!0,mt:l})}var ge={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function me(e,t){if(e.ctype)return e.ctype;var n=e.name||"",r=n.match(/\.([^\.]+)$/);return r&&ge[r[1]]||t&&(r=(n=t).match(/[\.\\]([^\.\\])+$/))&&ge[r[1]]?ge[r[1]]:"application/octet-stream"}function _e(e){for(var t=k(e),n=[],r=0;r<t.length;r+=76)n.push(t.slice(r,r+76));return n.join("\r\n")+"\r\n"}function ve(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,(function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)}));"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var n=[],r=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),i=0;i<r.length;++i){var o=r[i];if(0!=o.length)for(var s=0;s<o.length;){var a=76,l=o.slice(s,s+a);"="==l.charAt(a-1)?a--:"="==l.charAt(a-2)?a-=2:"="==l.charAt(a-3)&&(a-=3),l=o.slice(s,s+a),(s+=a)<o.length&&(l+="="),n.push(l)}else n.push("")}return n.join("\r\n")}function ye(e,t,n){for(var r,i="",o="",s="",a=0;a<10;++a){var l=t[a];if(!l||l.match(/^\s*$/))break;var c=l.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":i=c[2].trim();break;case"content-type":s=c[2].trim();break;case"content-transfer-encoding":o=c[2].trim()}}switch(++a,o.toLowerCase()){case"base64":r=O(E(t.slice(a).join("")));break;case"quoted-printable":r=function(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n];n<=e.length&&"="==r.charAt(r.length-1);)r=r.slice(0,r.length-1)+e[++n];t.push(r)}for(var i=0;i<t.length;++i)t[i]=t[i].replace(/[=][0-9A-Fa-f]{2}/g,(function(e){return String.fromCharCode(parseInt(e.slice(1),16))}));return O(t.join("\r\n"))}(t.slice(a));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+o)}var u=be(e,i.slice(n.length),r,{unsafe:!0});s&&(u.ctype=s)}function be(e,t,n,i){var o=i&&i.unsafe;o||f(e);var s=!o&&Ie.find(e,t);if(!s){var a=e.FullPaths[0];t.slice(0,a.length)==a?a=t:("/"!=a.slice(-1)&&(a+="/"),a=(a+t).replace("//","/")),s={name:r(t),type:2},e.FileIndex.push(s),e.FullPaths.push(a),o||Ie.utils.cfb_gc(e)}return s.content=n,s.size=n?n.length:0,i&&(i.CLSID&&(s.clsid=i.CLSID),i.mt&&(s.mt=i.mt),i.ct&&(s.ct=i.ct)),s}return t.find=function(e,t){var n=e.FullPaths.map((function(e){return e.toUpperCase()})),r=n.map((function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]})),i=!1;47===t.charCodeAt(0)?(i=!0,t=n[0].slice(0,-1)+t):i=-1!==t.indexOf("/");var o=t.toUpperCase(),s=!0===i?n.indexOf(o):r.indexOf(o);if(-1!==s)return e.FileIndex[s];var a=!o.match(F);for(o=o.replace(M,""),a&&(o=o.replace(F,"!")),s=0;s<n.length;++s){if((a?n[s].replace(F,"!"):n[s]).replace(M,"")==o)return e.FileIndex[s];if((a?r[s].replace(F,"!"):r[s]).replace(M,"")==o)return e.FileIndex[s]}return null},t.read=function(t,n){var r=n&&n.type;switch(r||T&&Buffer.isBuffer(t)&&(r="buffer"),r||"base64"){case"file":return function(t,n){return s(),a(e.readFileSync(t),n)}(t,n);case"base64":return a(O(E(t)),n);case"binary":return a(O(t),n)}return a(t,n)},t.parse=a,t.write=function(t,n){var r=p(t,n);switch(n&&n.type||"buffer"){case"file":return s(),e.writeFileSync(n.filename,r),r;case"binary":return"string"==typeof r?r:x(r);case"base64":return k("string"==typeof r?r:x(r));case"buffer":if(T)return Buffer.isBuffer(r)?r:I(r);case"array":return"string"==typeof r?O(r):r}return r},t.writeFile=function(t,n,r){s();var i=p(t,r);e.writeFileSync(n,i)},t.utils={cfb_new:function(e){var t={};return f(t,e),t},cfb_add:be,cfb_del:function(e,t){f(e);var n=Ie.find(e,t);if(n)for(var r=0;r<e.FileIndex.length;++r)if(e.FileIndex[r]==n)return e.FileIndex.splice(r,1),e.FullPaths.splice(r,1),!0;return!1},cfb_mov:function(e,t,n){f(e);var i=Ie.find(e,t);if(i)for(var o=0;o<e.FileIndex.length;++o)if(e.FileIndex[o]==i)return e.FileIndex[o].name=r(n),e.FullPaths[o]=n,!0;return!1},cfb_gc:function(e){d(e,!0)},ReadShift:$t,CheckField:Ht,prep_blob:Vt,bconcat:R,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");g=e}catch(e){console.error("cannot use native zlib: "+(e.message||e))}},_deflateRaw:ie,_inflateRaw:he,consts:w},t}();function Ae(e){return"string"==typeof e?P(e):Array.isArray(e)?function(e){if("undefined"==typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(e)}(e):e}function De(e,t,n){if(void 0!==Ee&&Ee.writeFileSync)return n?Ee.writeFileSync(e,t,n):Ee.writeFileSync(e,t);if("undefined"!=typeof Deno){if(n&&"string"==typeof t)switch(n){case"utf8":t=new TextEncoder(n).encode(t);break;case"binary":t=P(t);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(e,t)}var r="utf8"==n?it(t):t;if("undefined"!=typeof IE_SaveFile)return IE_SaveFile(r,e);if("undefined"!=typeof Blob){var i=new Blob([Ae(r)],{type:"application/octet-stream"});if("undefined"!=typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if("undefined"!=typeof saveAs)return saveAs(i,e);if("undefined"!=typeof URL&&"undefined"!=typeof document&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(i);if("object"==typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout((function(){URL.revokeObjectURL(o)}),6e4),chrome.downloads.download({url:o,filename:e,saveAs:!0});var s=document.createElement("a");if(null!=s.download)return s.download=e,s.href=o,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&"undefined"!=typeof setTimeout&&setTimeout((function(){URL.revokeObjectURL(o)}),6e4),o}}if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var a=File(e);return a.open("w"),a.encoding="binary",Array.isArray(t)&&(t=function(e){if(Array.isArray(e))return e.map((function(e){return String.fromCharCode(e)})).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}(t)),a.write(t),a.close(),t}catch(e){if(!e.message||!e.message.match(/onstruct/))throw e}throw new Error("cannot save file "+e)}function Ne(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&n.push(t[r]);return n}function Oe(e){for(var t=[],n=Ne(e),r=0;r!==n.length;++r)t[e[n[r]]]=n[r];return t}var Pe=new Date(1899,11,30,0,0,0);function Re(e,t){var n=e.getTime();return t&&(n-=1263168e5),(n-(Pe.getTime()+6e4*(e.getTimezoneOffset()-Pe.getTimezoneOffset())))/864e5}var Me=new Date("2017-02-19T19:06:09.000Z"),Fe=isNaN(Me.getFullYear())?new Date("2/19/17"):Me,Le=2017==Fe.getFullYear();function je(e,t){var n=new Date(e);if(Le)return t>0?n.setTime(n.getTime()+60*n.getTimezoneOffset()*1e3):t<0&&n.setTime(n.getTime()-60*n.getTimezoneOffset()*1e3),n;if(e instanceof Date)return e;if(1917==Fe.getFullYear()&&!isNaN(n.getFullYear())){var r=n.getFullYear();return e.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-60*o.getTimezoneOffset()*1e3)),o}function ze(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=ze(e[n]));return t}function $e(e,t){for(var n="";n.length<t;)n+=e;return n}function qe(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,(function(){return n*=100,""}));return isNaN(t=Number(r))?(r=r.replace(/[(](.*)[)]/,(function(e,t){return n=-n,t})),isNaN(t=Number(r))?t:t/n):t/n}var Ue=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/,Be=["january","february","march","april","may","june","july","august","september","october","november","december"];function We(e){var t=e.toLowerCase(),n=t.replace(/\s+/g," ").trim().match(Ue);if(n)return function(e){return e[2]?e[3]?e[4]?new Date(1899,11,30,+e[1]%12+("p"==e[7]?12:0),+e[2],+e[4],1e3*parseFloat(e[3])):new Date(1899,11,30,"p"==e[7]?12:0,+e[1],+e[2],1e3*parseFloat(e[3])):e[5]?new Date(1899,11,30,+e[1]%12+("p"==e[7]?12:0),+e[2],+e[5],e[6]?1e3*parseFloat(e[6]):0):new Date(1899,11,30,+e[1]%12+("p"==e[7]?12:0),+e[2],0,0):new Date(1899,11,30,+e[1]%12+("p"==e[7]?12:0),0,0,0)}(n);var r=new Date(e),i=new Date(NaN),o=r.getYear(),s=(r.getMonth(),r.getDate());if(isNaN(s))return i;if(t.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((t=t.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==Be.indexOf(t))return i}else if(t.replace(/[ap]m?/,"").match(/[a-z]/))return i;return o<0||o>8099||e.match(/[^-0-9:,\/\\]/)?i:r}function He(e,t,n){if(e.FullPaths){var r;if("string"==typeof n)return r=T?I(n):function(e){for(var t=[],n=0,r=e.length+250,i=D(e.length+255),o=0;o<e.length;++o){var s=e.charCodeAt(o);if(s<128)i[n++]=s;else if(s<2048)i[n++]=192|s>>6&31,i[n++]=128|63&s;else if(s>=55296&&s<57344){s=64+(1023&s);var a=1023&e.charCodeAt(++o);i[n++]=240|s>>8&7,i[n++]=128|s>>2&63,i[n++]=128|a>>6&15|(3&s)<<4,i[n++]=128|63&a}else i[n++]=224|s>>12&15,i[n++]=128|s>>6&63,i[n++]=128|63&s;n>r&&(t.push(i.slice(0,n)),n=0,i=D(65535),r=65530)}return t.push(i.slice(0,n)),R(t)}(n),Ie.utils.cfb_add(e,t,r);Ie.utils.cfb_add(e,t,n)}else e.file(t,n)}var Ve='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',Ye=Oe({"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"}),Ge=/[&<>'"]/g,Ke=/[\u0000-\u0008\u000b-\u001f\uFFFE-\uFFFF]/g;function Xe(e){return(e+"").replace(Ge,(function(e){return Ye[e]})).replace(Ke,(function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"}))}var Je=/[\u0000-\u001f]/g;function Qe(e){return(e+"").replace(Ge,(function(e){return Ye[e]})).replace(/\n/g,"<br/>").replace(Je,(function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"}))}function Ze(e){for(var t="",n=0,r=0,i=0,o=0,s=0,a=0;n<e.length;)(r=e.charCodeAt(n++))<128?t+=String.fromCharCode(r):(i=e.charCodeAt(n++),r>191&&r<224?(s=(31&r)<<6,s|=63&i,t+=String.fromCharCode(s)):(o=e.charCodeAt(n++),r<240?t+=String.fromCharCode((15&r)<<12|(63&i)<<6|63&o):(a=((7&r)<<18|(63&i)<<12|(63&o)<<6|63&(s=e.charCodeAt(n++)))-65536,t+=String.fromCharCode(55296+(a>>>10&1023)),t+=String.fromCharCode(56320+(1023&a)))));return t}function et(e){var t,n,r,i=D(2*e.length),o=1,s=0,a=0;for(n=0;n<e.length;n+=o)o=1,(r=e.charCodeAt(n))<128?t=r:r<224?(t=64*(31&r)+(63&e.charCodeAt(n+1)),o=2):r<240?(t=4096*(15&r)+64*(63&e.charCodeAt(n+1))+(63&e.charCodeAt(n+2)),o=3):(o=4,t=262144*(7&r)+4096*(63&e.charCodeAt(n+1))+64*(63&e.charCodeAt(n+2))+(63&e.charCodeAt(n+3)),a=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==a&&(i[s++]=255&a,i[s++]=a>>>8,a=0),i[s++]=t%256,i[s++]=t>>>8;return i.slice(0,s).toString("ucs2")}function tt(e){return I(e,"binary").toString("utf8")}var nt="foo bar bazâð£",rt=T&&(tt(nt)==Ze(nt)&&tt||et(nt)==Ze(nt)&&et)||Ze,it=T?function(e){return I(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,r=0,i=0;n<e.length;)switch(r=e.charCodeAt(n++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(63&r)));break;case r>=55296&&r<57344:r-=55296,i=e.charCodeAt(n++)-56320+(r<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(63&i)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(63&r)))}return t.join("")},ot=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map((function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]}));return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),r=0;r<e.length;++r)n=n.replace(e[r][0],e[r][1]);return n}}(),st=/(^\s|\s$|\n)/;function at(e,t){return"<"+e+(t.match(st)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function lt(e){return Ne(e).map((function(t){return" "+t+'="'+e[t]+'"'})).join("")}function ct(e,t,n){return"<"+e+(null!=n?lt(n):"")+(null!=t?(t.match(st)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function ut(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(e){if(t)throw e}return""}var ht={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ft=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],dt={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"},pt=function(e){for(var t=[],n=0;n<e[0].length;++n)if(e[0][n])for(var r=0,i=e[0][n].length;r<i;r+=10240)t.push.apply(t,e[0][n].slice(r,r+10240));return t},gt=T?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map((function(e){return Buffer.isBuffer(e)?e:I(e)}))):pt(e)}:pt,mt=function(e,t,n){for(var r=[],i=t;i<n;i+=2)r.push(String.fromCharCode(Mt(e,i)));return r.join("").replace(M,"")},_t=T?function(e,t,n){return Buffer.isBuffer(e)&&A?e.toString("utf16le",t,n).replace(M,""):mt(e,t,n)}:mt,vt=function(e,t,n){for(var r=[],i=t;i<t+n;++i)r.push(("0"+e[i].toString(16)).slice(-2));return r.join("")},yt=T?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):vt(e,t,n)}:vt,bt=function(e,t,n){for(var r=[],i=t;i<n;i++)r.push(String.fromCharCode(Rt(e,i)));return r.join("")},wt=T?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf8",t,n):bt(e,t,n)}:bt,xt=function(e,t){var n=Lt(e,t);return n>0?wt(e,t+4,t+4+n-1):""},Ct=xt,St=function(e,t){var n=Lt(e,t);return n>0?wt(e,t+4,t+4+n-1):""},kt=St,Et=function(e,t){var n=2*Lt(e,t);return n>0?wt(e,t+4,t+4+n-1):""},Tt=Et,It=function(e,t){var n=Lt(e,t);return n>0?_t(e,t+4,t+4+n):""},At=It,Dt=function(e,t){var n=Lt(e,t);return n>0?wt(e,t+4,t+4+n):""},Nt=Dt,Ot=function(e,t){return function(e,t){for(var n=1-2*(e[t+7]>>>7),r=((127&e[t+7])<<4)+(e[t+6]>>>4&15),i=15&e[t+6],o=5;o>=0;--o)i=256*i+e[t+o];return 2047==r?0==i?n*(1/0):NaN:(0==r?r=-1022:(r-=1023,i+=Math.pow(2,52)),n*Math.pow(2,r-52)*i)}(e,t)},Pt=Ot;T&&(Ct=function(e,t){if(!Buffer.isBuffer(e))return xt(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},kt=function(e,t){if(!Buffer.isBuffer(e))return St(e,t);var n=e.readUInt32LE(t);return n>0?e.toString("utf8",t+4,t+4+n-1):""},Tt=function(e,t){if(!Buffer.isBuffer(e)||!A)return Et(e,t);var n=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n-1)},At=function(e,t){if(!Buffer.isBuffer(e)||!A)return It(e,t);var n=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+n)},Nt=function(e,t){if(!Buffer.isBuffer(e))return Dt(e,t);var n=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+n)},Pt=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):Ot(e,t)}),void 0!==g&&(_t=function(e,t,n){return g.utils.decode(1200,e.slice(t,n)).replace(M,"")},wt=function(e,t,n){return g.utils.decode(65001,e.slice(t,n))},Ct=function(e,t){var n=Lt(e,t);return n>0?g.utils.decode(_,e.slice(t+4,t+4+n-1)):""},kt=function(e,t){var n=Lt(e,t);return n>0?g.utils.decode(m,e.slice(t+4,t+4+n-1)):""},Tt=function(e,t){var n=2*Lt(e,t);return n>0?g.utils.decode(1200,e.slice(t+4,t+4+n-1)):""},At=function(e,t){var n=Lt(e,t);return n>0?g.utils.decode(1200,e.slice(t+4,t+4+n)):""},Nt=function(e,t){var n=Lt(e,t);return n>0?g.utils.decode(65001,e.slice(t+4,t+4+n)):""});var Rt=function(e,t){return e[t]},Mt=function(e,t){return 256*e[t+1]+e[t]},Ft=function(e,t){var n=256*e[t+1]+e[t];return n<32768?n:-1*(65535-n+1)},Lt=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},jt=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},zt=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function $t(e,t){var n,r,i,o,s,a,l="",c=[];switch(t){case"dbcs":if(a=this.l,T&&Buffer.isBuffer(this)&&A)l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(s=0;s<e;++s)l+=String.fromCharCode(Mt(this,a)),a+=2;e*=2;break;case"utf8":l=wt(this,this.l,this.l+e);break;case"utf16le":e*=2,l=_t(this,this.l,this.l+e);break;case"wstr":if(void 0===g)return $t.call(this,e,"dbcs");l=g.utils.decode(m,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":l=Ct(this,this.l),e=4+Lt(this,this.l);break;case"lpstr-cp":l=kt(this,this.l),e=4+Lt(this,this.l);break;case"lpwstr":l=Tt(this,this.l),e=4+2*Lt(this,this.l);break;case"lpp4":e=4+Lt(this,this.l),l=At(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+Lt(this,this.l),l=Nt(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(i=Rt(this,this.l+e++));)c.push(x(i));l=c.join("");break;case"_wstr":for(e=0,l="";0!==(i=Mt(this,this.l+e));)c.push(x(i)),e+=2;e+=2,l=c.join("");break;case"dbcs-cont":for(l="",a=this.l,s=0;s<e;++s){if(this.lens&&-1!==this.lens.indexOf(a))return i=Rt(this,a),this.l=a+1,o=$t.call(this,e-s,i?"dbcs-cont":"sbcs-cont"),c.join("")+o;c.push(x(Mt(this,a))),a+=2}l=c.join(""),e*=2;break;case"cpstr":if(void 0!==g){l=g.utils.decode(m,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(l="",a=this.l,s=0;s!=e;++s){if(this.lens&&-1!==this.lens.indexOf(a))return i=Rt(this,a),this.l=a+1,o=$t.call(this,e-s,i?"dbcs-cont":"sbcs-cont"),c.join("")+o;c.push(x(Rt(this,a))),a+=1}l=c.join("");break;default:switch(e){case 1:return n=Rt(this,this.l),this.l++,n;case 2:return n=("i"===t?Ft:Mt)(this,this.l),this.l+=2,n;case 4:case-4:return"i"===t||0==(128&this[this.l+3])?(n=(e>0?jt:zt)(this,this.l),this.l+=4,n):(r=Lt(this,this.l),this.l+=4,r);case 8:case-8:if("f"===t)return r=8==e?Pt(this,this.l):Pt([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;e=8;case 16:l=yt(this,this.l,e)}}return this.l+=e,l}var qt=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},Ut=function(e,t,n){e[n]=255&t,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},Bt=function(e,t,n){e[n]=255&t,e[n+1]=t>>>8&255};function Wt(e,t,n){var r=0,i=0;if("dbcs"===n){for(i=0;i!=t.length;++i)Bt(this,t.charCodeAt(i),this.l+2*i);r=2*t.length}else if("sbcs"===n||"cpstr"==n)if(void 0!==g&&874==_){for(i=0;i!=t.length;++i){var o=g.utils.encode(_,t.charAt(i));this[this.l+i]=o[0]}r=t.length}else if(void 0!==g&&"cpstr"==n){if((o=g.utils.encode(m,t)).length==t.length)for(i=0;i<t.length;++i)0==o[i]&&0!=t.charCodeAt(i)&&(o[i]=95);if(o.length==2*t.length)for(i=0;i<t.length;++i)0==o[2*i]&&0==o[2*i+1]&&0!=t.charCodeAt(i)&&(o[2*i]=95);for(i=0;i<o.length;++i)this[this.l+i]=o[i];r=o.length}else{for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=255&t.charCodeAt(i);r=t.length}else{if("hex"===n){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}if("utf16le"===n){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var a=t.charCodeAt(i);this[this.l++]=255&a,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}switch(e){case 1:r=1,this[this.l]=255&t;break;case 2:r=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:r=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:r=4,qt(this,t,this.l);break;case 8:if(r=8,"f"===n){!function(e,t,n){var r=(t<0||1/t==-1/0?1:0)<<7,i=0,o=0,s=r?-t:t;isFinite(s)?0==s?i=o=0:(i=Math.floor(Math.log(s)/Math.LN2),o=s*Math.pow(2,52-i),i<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?i=-1022:(o-=Math.pow(2,52),i+=1023)):(i=2047,o=isNaN(t)?26985:0);for(var a=0;a<=5;++a,o/=256)e[n+a]=255&o;e[n+6]=(15&i)<<4|15&o,e[n+7]=i>>4|r}(this,t,this.l);break}case 16:break;case-4:r=4,Ut(this,t,this.l)}}return this.l+=r,this}function Ht(e,t){var n=yt(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function Vt(e,t){e.l=t,e.read_shift=$t,e.chk=Ht,e.write_shift=Wt}function Yt(e){var t=D(e);return Vt(t,0),t}function Gt(e){return""+(e+1)}function Kt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Xt(e){for(var t=0,n=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(n=26*n+(i-64))}return{c:n-1,r:t-1}}function Jt(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function Qt(e){var t=e.indexOf(":");return-1==t?{s:Xt(e),e:Xt(e)}:{s:Xt(e.slice(0,t)),e:Xt(e.slice(t+1))}}function Zt(e,t){return void 0===t||"number"==typeof t?Zt(e.s,e.e):("string"!=typeof e&&(e=Jt(e)),"string"!=typeof t&&(t=Jt(t)),e==t?e:e+":"+t)}function en(e){var t=Qt(e);return"$"+Kt(t.s.c)+"$"+Gt(t.s.r)+":$"+Kt(t.e.c)+"$"+Gt(t.e.r)}function tn(e,t){if(!(e||t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e.replace(/'/g,"''")+"'":e}function nn(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,i=0,o=e.length;for(n=0;r<o&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(t.s.c=--n,n=0;r<o&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;if(t.s.r=--n,r===o||10!=i)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,n=0;r!=o&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(t.e.c=--n,n=0;r!=o&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;return t.e.r=--n,t}function rn(e,t,n){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),"e"==e.t?sn[e.v]||e.v:function(e,t){var n="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=Ce(e.z,n?Re(t):t)}catch(e){}try{return e.w=Ce((e.XF||{}).numFmtId||(n?14:0),n?Re(t):t)}catch(e){return""+t}}(e,null==t?e.v:t))}function on(e,t,n){var r=n||{},i=e?null!=e["!data"]:r.dense;null!=C&&null==i&&(i=C);var o=e||{};i&&!o["!data"]&&(o["!data"]=[]);var s=0,a=0;if(o&&null!=r.origin){if("number"==typeof r.origin)s=r.origin;else{var l="string"==typeof r.origin?Xt(r.origin):r.origin;s=l.r,a=l.c}o["!ref"]||(o["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var u=nn(o["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),-1==s&&(c.e.r=s=u.e.r+1)}for(var h=[],f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");var d=s+f,p=""+(d+1);i&&(o["!data"][d]||(o["!data"][d]=[]),h=o["!data"][d]);for(var g=0;g!=t[f].length;++g)if(void 0!==t[f][g]){var m={v:t[f][g]},_=a+g;if(c.s.r>d&&(c.s.r=d),c.s.c>_&&(c.s.c=_),c.e.r<d&&(c.e.r=d),c.e.c<_&&(c.e.c=_),!t[f][g]||"object"!=typeof t[f][g]||Array.isArray(t[f][g])||t[f][g]instanceof Date)if(Array.isArray(m.v)&&(m.f=t[f][g][1],m.v=m.v[0]),null===m.v)if(m.f)m.t="n";else if(r.nullError)m.t="e",m.v=0;else{if(!r.sheetStubs)continue;m.t="z"}else"number"==typeof m.v?m.t="n":"boolean"==typeof m.v?m.t="b":m.v instanceof Date?(m.z=r.dateNF||Y[14],r.cellDates?(m.t="d",m.w=Ce(m.z,Re(m.v,r.date1904))):(m.t="n",m.v=Re(m.v,r.date1904),m.w=Ce(m.z,m.v))):m.t="s";else m=t[f][g];if(i)h[_]&&h[_].z&&(m.z=h[_].z),h[_]=m;else{var v=Kt(_)+p;o[v]&&o[v].z&&(m.z=o[v].z),o[v]=m}}}return c.s.c<1e7&&(o["!ref"]=Zt(c)),o}var sn={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},an={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ln={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};var cn={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",CONN:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/connections",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function un(e){var t=[Ve,ct("Relationships",null,{xmlns:ht.RELS})];return Ne(e["!id"]).forEach((function(n){t[t.length]=ct("Relationship",null,e["!id"][n])})),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function hn(e,t,n,r,i,o){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=r,i.Target=n,o?i.TargetMode=o:[cn.HLINK,cn.XPATH,cn.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}var fn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function dn(e,t,n,r,i){null==i[e]&&null!=t&&""!==t&&(i[e]=t,t=Xe(t),r[r.length]=n?ct(e,t,n):at(e,t))}var pn=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];var gn=/^\s|\s$|[\t\n\r]/;function mn(e){var t,n,r=0,i=function(e){if(void 0!==g)return g.utils.encode(_,e);for(var t=[],n=e.split(""),r=0;r<n.length;++r)t[r]=n[r].charCodeAt(0);return t}(e),o=i.length+1;for((t=D(o))[0]=i.length,n=1;n!=o;++n)t[n]=i[n-1];for(n=o-1;n>=0;--n)r=((0==(16384&r)?0:1)|r<<1&32767)^t[n];return 52811^r}var _n=6;var vn=96;function yn(e){return 96*e/vn}function bn(e,t){var n=[21600,21600],r=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),i=[ct("xml",null,{"xmlns:v":dt.v,"xmlns:o":dt.o,"xmlns:x":dt.x,"xmlns:mv":dt.mv}).replace(/\/>/,">"),ct("o:shapelayout",ct("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"})],o=65536*e,s=t||[];return s.length>0&&i.push(ct("v:shapetype",[ct("v:stroke",null,{joinstyle:"miter"}),ct("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202",coordsize:n.join(","),"o:spt":202,path:r})),s.forEach((function(e){++o,i.push(function(e,t){var n=Xt(e[0]),r={color2:"#BEFF82",type:"gradient"};"gradient"==r.type&&(r.angle="-180");var i="gradient"==r.type?ct("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,o=ct("v:fill",i,r);return["<v:shape"+lt({id:"_x0000_s"+t,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",o,ct("v:shadow",null,{on:"t",obscured:"t"}),ct("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",at("x:Anchor",[n.c+1,0,n.r+1,0,n.c+3,20,n.r+5,20].join(",")),at("x:AutoFill","False"),at("x:Row",String(n.r)),at("x:Column",String(n.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"].join("")}(e,o))})),i.push("</xml>"),i.join("")}function wn(e){var t=[Ve,ct("comments",null,{xmlns:ft[0]})],n=[];return t.push("<authors>"),e.forEach((function(e){e[1].forEach((function(e){var r=Xe(e.a);-1==n.indexOf(r)&&(n.push(r),t.push("<author>"+r+"</author>")),e.T&&e.ID&&-1==n.indexOf("tc="+e.ID)&&(n.push("tc="+e.ID),t.push("<author>tc="+e.ID+"</author>"))}))})),0==n.length&&(n.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach((function(e){var r=0,i=[],o=0;if(e[1][0]&&e[1][0].T&&e[1][0].ID&&(r=n.indexOf("tc="+e[1][0].ID)),e[1].forEach((function(e){e.a&&(r=n.indexOf(Xe(e.a))),e.T&&++o,i.push(null==e.t?"":Xe(e.t))})),0===o)e[1].forEach((function(r){t.push('<comment ref="'+e[0]+'" authorId="'+n.indexOf(Xe(r.a))+'"><text>'),t.push(at("t",null==r.t?"":Xe(r.t))),t.push("</text></comment>")}));else{t.push('<comment ref="'+e[0]+'" authorId="'+r+'"><text>');for(var s="Comment:\n    "+i[0]+"\n",a=1;a<i.length;++a)s+="Reply:\n    "+i[a]+"\n";t.push(at("t",Xe(s))),t.push("</text></comment>")}})),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function xn(e,t,n){var r=[Ve,ct("ThreadedComments",null,{xmlns:ht.TCMNT}).replace(/[\/]>/,">")];return e.forEach((function(e){var i="";(e[1]||[]).forEach((function(o,s){if(o.T){o.a&&-1==t.indexOf(o.a)&&t.push(o.a);var a={ref:e[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};0==s?i=a.id:a.parentId=i,o.ID=a.id,o.a&&(a.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),r.push(ct("threadedComment",at("text",o.t||""),a))}else delete o.ID}))})),r.push("</ThreadedComments>"),r.join("")}var Cn=["xlsb","xlsm","xlam","biff8","xla"],Sn="undefined"!=typeof Map;function kn(e,t){var n,r,i={min:e+1,max:e+1},o=-1;return t.MDW&&(_n=t.MDW),null!=t.width?i.customWidth=1:null!=t.wpx?(r=t.wpx,o=Math.floor((r-5)/_n*100+.5)/100):null!=t.wch&&(o=t.wch),o>-1?(i.width=(n=o,Math.round((n*_n+5)/_n*256)/256),i.customWidth=1):null!=t.width&&(i.width=t.width),t.hidden&&(i.hidden=!0),null!=t.level&&(i.outlineLevel=i.level=t.level),i}function En(e,t,n){var r,i,o=n.revssf[null!=t.z?t.z:"General"],s=60,a=e.length;if(null==o&&n.ssf)for(;s<392;++s)if(null==n.ssf[s]){r=t.z,i=s,Se(ke[r]||r,i),n.ssf[s]=t.z,n.revssf[t.z]=o=s;break}for(s=0;s!=a;++s)if(e[s].numFmtId===o)return s;return e[a]={numFmtId:o,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function Tn(e,t,n){if(e&&e["!ref"]){var r=nn(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+n+"): "+e["!ref"])}}var In=["objects","scenarios","selectLockedCells","selectUnlockedCells"],An=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Dn(e,t,n,r){if(e.c&&n["!comments"].push([t,e.c]),(void 0===e.v||"z"===e.t&&!(r||{}).sheetStubs)&&"string"!=typeof e.f&&void 0===e.z)return"";var i="",o=e.t,s=e.v;if("z"!==e.t)switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=sn[e.v];break;case"d":r&&r.cellDates?i=je(e.v,-1).toISOString():((e=ze(e)).t="n",i=""+(e.v=Re(je(e.v)))),void 0===e.z&&(e.z=Y[14]);break;default:i=e.v}var a="z"==e.t||null==e.v?"":at("v",Xe(i)),l={r:t},c=En(r.cellXfs,e,r);switch(0!==c&&(l.s=c),e.t){case"n":case"z":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;default:if(null==e.v){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){a=at("v",""+function(e,t,n){var r=0,i=e.length;if(n){if(Sn?n.has(t):Object.prototype.hasOwnProperty.call(n,t))for(var o=Sn?n.get(t):n[t];r<o.length;++r)if(e[o[r]].t===t)return e.Count++,o[r]}else for(;r<i;++r)if(e[r].t===t)return e.Count++,r;return e[i]={t},e.Count++,e.Unique++,n&&(Sn?(n.has(t)||n.set(t,[]),n.get(t).push(i)):(Object.prototype.hasOwnProperty.call(n,t)||(n[t]=[]),n[t].push(i))),i}(r.Strings,e.v,r.revStrings)),l.t="s";break}l.t="str"}if(e.t!=o&&(e.t=o,e.v=s),"string"==typeof e.f&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;a=ct("f",Xe(e.f),u)+(null!=e.v?a:"")}return e.l&&(e.l.display=Xe(i),n["!links"].push([t,e.l])),e.D&&(l.cm=1),ct("c",a,l)}function Nn(e,t,n,r){var i,o=[Ve,ct("worksheet",null,{xmlns:ft[0],"xmlns:r":ht.r})],s=n.SheetNames[e],a="",l=n.Sheets[s];null==l&&(l={});var c=l["!ref"]||"A1",u=nn(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=Zt(u)}r||(r={}),l["!comments"]=[];var h=[];!function(e,t,n,r,i){var o=!1,s={},a=null;if("xlsx"!==r.bookType&&t.vbaraw){var l=t.SheetNames[n];try{t.Workbook&&(l=t.Workbook.Sheets[n].CodeName||l)}catch(e){}o=!0,s.codeName=it(Xe(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),a=(a||"")+ct("outlinePr",null,c)}(o||a)&&(i[i.length]=ct("sheetPr",a,s))}(l,n,e,t,o),o[o.length]=ct("dimension",null,{ref:c}),o[o.length]=function(e,t,n,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),ct("sheetViews",ct("sheetView",null,i),{})}(0,0,0,n),t.sheetFormat&&(o[o.length]=ct("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=l["!cols"]&&l["!cols"].length>0&&(o[o.length]=function(e,t){for(var n,r=["<cols>"],i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=ct("col",null,kn(i,n)));return r[r.length]="</cols>",r.join("")}(0,l["!cols"])),o[i=o.length]="<sheetData/>",l["!links"]=[],null!=l["!ref"]&&(a=function(e,t,n,r){var i,o,s=[],a=[],l=nn(e["!ref"]),c="",u="",h=[],f=0,d=0,p=e["!rows"],g=null!=e["!data"],m={r:u},_=-1;for(d=l.s.c;d<=l.e.c;++d)h[d]=Kt(d);for(f=l.s.r;f<=l.e.r;++f){for(a=[],u=Gt(f),d=l.s.c;d<=l.e.c;++d){i=h[d]+u;var v=g?(e["!data"][f]||[])[d]:e[i];void 0!==v&&null!=(c=Dn(v,i,e,t))&&a.push(c)}(a.length>0||p&&p[f])&&(m={r:u},p&&p[f]&&((o=p[f]).hidden&&(m.hidden=1),_=-1,o.hpx?_=yn(o.hpx):o.hpt&&(_=o.hpt),_>-1&&(m.ht=_,m.customHeight=1),o.level&&(m.outlineLevel=o.level)),s[s.length]=ct("row",a.join(""),m))}if(p)for(;f<p.length;++f)p&&p[f]&&(m={r:f+1},(o=p[f]).hidden&&(m.hidden=1),_=-1,o.hpx?_=yn(o.hpx):o.hpt&&(_=o.hpt),_>-1&&(m.ht=_,m.customHeight=1),o.level&&(m.outlineLevel=o.level),s[s.length]=ct("row","",m));return s.join("")}(l,t),a.length>0&&(o[o.length]=a)),o.length>i+1&&(o[o.length]="</sheetData>",o[i]=o[i].replace("/>",">")),l["!protect"]&&(o[o.length]=function(e){var t={sheet:1};return In.forEach((function(n){null!=e[n]&&e[n]&&(t[n]="1")})),An.forEach((function(n){null==e[n]||e[n]||(t[n]="0")})),e.password&&(t.password=mn(e.password).toString(16).toUpperCase()),ct("sheetProtection",null,t)}(l["!protect"])),null!=l["!autofilter"]&&(o[o.length]=function(e,t,n,r){var i="string"==typeof e.ref?e.ref:Zt(e.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var o=n.Workbook.Names,s=Qt(i);s.s.r==s.e.r&&(s.e.r=Qt(t["!ref"]).e.r,i=Zt(s));for(var a=0;a<o.length;++a){var l=o[a];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==r){l.Ref=tn(n.SheetNames[r])+"!"+en(i);break}}return a==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+i}),ct("autoFilter",null,{ref:i})}(l["!autofilter"],l,n,e)),null!=l["!merges"]&&l["!merges"].length>0&&(o[o.length]=function(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',n=0;n!=e.length;++n)t+='<mergeCell ref="'+Zt(e[n])+'"/>';return t+"</mergeCells>"}(l["!merges"]));var f,d,p=-1,g=-1;return l["!links"].length>0&&(o[o.length]="<hyperlinks>",l["!links"].forEach((function(e){e[1].Target&&(f={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(g=hn(r,-1,Xe(e[1].Target).replace(/#.*$/,""),cn.HLINK),f["r:id"]="rId"+g),(p=e[1].Target.indexOf("#"))>-1&&(f.location=Xe(e[1].Target.slice(p+1))),e[1].Tooltip&&(f.tooltip=Xe(e[1].Tooltip)),f.display=e[1].display,o[o.length]=ct("hyperlink",null,f))})),o[o.length]="</hyperlinks>"),delete l["!links"],null!=l["!margins"]&&(o[o.length]=(function(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(n=[1,1,1,1,.5,.5]),null==e.left&&(e.left=n[0]),null==e.right&&(e.right=n[1]),null==e.top&&(e.top=n[2]),null==e.bottom&&(e.bottom=n[3]),null==e.header&&(e.header=n[4]),null==e.footer&&(e.footer=n[5])}}(d=l["!margins"]),ct("pageMargins",null,d))),t&&!t.ignoreEC&&null!=t.ignoreEC||(o[o.length]=at("ignoredErrors",ct("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(g=hn(r,-1,"../drawings/drawing"+(e+1)+".xml",cn.DRAW),o[o.length]=ct("drawing",null,{"r:id":"rId"+g}),l["!drawing"]=h),l["!comments"].length>0&&(g=hn(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",cn.VML),o[o.length]=ct("legacyDrawing",null,{"r:id":"rId"+g}),l["!legacy"]=g),o.length>1&&(o[o.length]="</worksheet>",o[1]=o[1].replace("/>",">")),o.join("")}var On=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Pn=":][*?/\\".split("");function Rn(e,t){try{if(""==e)throw new Error("Sheet name cannot be blank");if(e.length>31)throw new Error("Sheet name cannot exceed 31 chars");if(39==e.charCodeAt(0)||39==e.charCodeAt(e.length-1))throw new Error("Sheet name cannot start or end with apostrophe (')");if("history"==e.toLowerCase())throw new Error("Sheet name cannot be 'History'");Pn.forEach((function(t){if(-1!=e.indexOf(t))throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}))}catch(e){if(t)return!1;throw e}return!0}function Mn(e,t,n,r){for(var i=e["!merges"]||[],o=[],s={},a=null!=e["!data"],l=t.s.c;l<=t.e.c;++l){for(var c=0,u=0,h=0;h<i.length;++h)if(!(i[h].s.r>n||i[h].s.c>l||i[h].e.r<n||i[h].e.c<l)){if(i[h].s.r<n||i[h].s.c<l){c=-1;break}c=i[h].e.r-i[h].s.r+1,u=i[h].e.c-i[h].s.c+1;break}if(!(c<0)){var f=Kt(l)+Gt(n),d=a?(e["!data"][n]||[])[l]:e[f],p=d&&null!=d.v&&(d.h||Qe(d.w||(rn(d),d.w)||""))||"";s={},c>1&&(s.rowspan=c),u>1&&(s.colspan=u),r.editable?p='<span contenteditable="true">'+p+"</span>":d&&(s["data-t"]=d&&d.t||"z",null!=d.v&&(s["data-v"]=d.v),null!=d.z&&(s["data-z"]=d.z),d.l&&"#"!=(d.l.Target||"#").charAt(0)&&(p='<a href="'+Qe(d.l.Target)+'">'+p+"</a>")),s.id=(r.id||"sjs")+"-"+f,o.push(ct("td",p,s))}}return"<tr>"+o.join("")+"</tr>"}function Fn(e,t,n){var r=t.rows;if(!r)throw"Unsupported origin when "+t.tagName+" is not a TABLE";var i=n||{},o=null!=e["!data"],s=0,a=0;if(null!=i.origin)if("number"==typeof i.origin)s=i.origin;else{var l="string"==typeof i.origin?Xt(i.origin):i.origin;s=l.r,a=l.c}var c=Math.min(i.sheetRows||1e7,r.length),u={s:{r:0,c:0},e:{r:s,c:a}};if(e["!ref"]){var h=Qt(e["!ref"]);u.s.r=Math.min(u.s.r,h.s.r),u.s.c=Math.min(u.s.c,h.s.c),u.e.r=Math.max(u.e.r,h.e.r),u.e.c=Math.max(u.e.c,h.e.c),-1==s&&(u.e.r=s=h.e.r+1)}var f=[],d=0,p=e["!rows"]||(e["!rows"]=[]),g=0,m=0,_=0,v=0,y=0,b=0;for(e["!cols"]||(e["!cols"]=[]);g<r.length&&m<c;++g){var w=r[g];if(jn(w)){if(i.display)continue;p[m]={hidden:!0}}var x=w.cells;for(_=v=0;_<x.length;++_){var C=x[_];if(!i.display||!jn(C)){var S=C.hasAttribute("data-v")?C.getAttribute("data-v"):C.hasAttribute("v")?C.getAttribute("v"):ot(C.innerHTML),k=C.getAttribute("data-z")||C.getAttribute("z");for(d=0;d<f.length;++d){var E=f[d];E.s.c==v+a&&E.s.r<m+s&&m+s<=E.e.r&&(v=E.e.c+1-a,d=-1)}b=+C.getAttribute("colspan")||1,((y=+C.getAttribute("rowspan")||1)>1||b>1)&&f.push({s:{r:m+s,c:v+a},e:{r:m+s+(y||1)-1,c:v+a+(b||1)-1}});var T={t:"s",v:S},I=C.getAttribute("data-t")||C.getAttribute("t")||"";null!=S&&(0==S.length?T.t=I||"z":i.raw||0==S.trim().length||"s"==I||("TRUE"===S?T={t:"b",v:!0}:"FALSE"===S?T={t:"b",v:!1}:isNaN(qe(S))?isNaN(We(S).getDate())||(T={t:"d",v:je(S)},i.cellDates||(T={t:"n",v:Re(T.v)}),T.z=i.dateNF||Y[14]):T={t:"n",v:qe(S)})),void 0===T.z&&null!=k&&(T.z=k);var A="",D=C.getElementsByTagName("A");if(D&&D.length)for(var N=0;N<D.length&&(!D[N].hasAttribute("href")||"#"==(A=D[N].getAttribute("href")).charAt(0));++N);A&&"#"!=A.charAt(0)&&"javascript:"!=A.slice(0,11).toLowerCase()&&(T.l={Target:A}),o?(e["!data"][m+s]||(e["!data"][m+s]=[]),e["!data"][m+s][v+a]=T):e[Jt({c:v+a,r:m+s})]=T,u.e.c<v+a&&(u.e.c=v+a),v+=b}}++m}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,m-1+s),e["!ref"]=Zt(u),m>=c&&(e["!fullref"]=Zt((u.e.r=r.length-g+m-1+s,u))),e}function Ln(e,t){var n={};return(t||{}).dense&&(n["!data"]=[]),Fn(n,e,t)}function jn(e){var t="",n=function(e){return e.ownerDocument.defaultView&&"function"==typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null}(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}function zn(e){var t;(t=[["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]],function(e){for(var n=0;n!=t.length;++n){var r=t[n];void 0===e[r[0]]&&(e[r[0]]=r[1]),"n"===r[2]&&(e[r[0]]=Number(e[r[0]]))}})(e)}function $n(e,t){var n;e&&!e.SSF&&(e.SSF=ze(Y)),e&&e.SSF&&(n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',Y=n,function(e){for(var t=0;392!=t;++t)void 0!==e[t]&&Se(e[t],t)}(e.SSF),t.revssf=function(e){for(var t=[],n=Ne(e),r=0;r!==n.length;++r)t[e[n[r]]]=parseInt(n[r],10);return t}(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Sn?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",i=Cn.indexOf(t.bookType)>-1,o={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};zn(t=t||{});var s=Ie.utils.cfb_new(),a="",l=0;if(t.cellXfs=[],En(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),He(s,a="docProps/core.xml",function(e,t){var n=t||{},r=[Ve,ct("cp:coreProperties",null,{"xmlns:cp":ht.CORE_PROPS,"xmlns:dc":ht.dc,"xmlns:dcterms":ht.dcterms,"xmlns:dcmitype":ht.dcmitype,"xmlns:xsi":ht.xsi})],i={};if(!e&&!n.Props)return r.join("");e&&(null!=e.CreatedDate&&dn("dcterms:created","string"==typeof e.CreatedDate?e.CreatedDate:ut(e.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),null!=e.ModifiedDate&&dn("dcterms:modified","string"==typeof e.ModifiedDate?e.ModifiedDate:ut(e.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var o=0;o!=fn.length;++o){var s=fn[o],a=n.Props&&null!=n.Props[s[1]]?n.Props[s[1]]:e?e[s[1]]:null;!0===a?a="1":!1===a?a="0":"number"==typeof a&&(a=String(a)),null!=a&&dn(s[0],a,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}(e.Props,t)),o.coreprops.push(a),hn(t.rels,2,a,cn.CORE_PROPS),a="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var c=[],u=0;u<e.SheetNames.length;++u)2!=(e.Workbook.Sheets[u]||{}).Hidden&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,He(s,a,function(e){var t=[],n=ct;return e||(e={}),e.Application="SheetJS",t[t.length]=Ve,t[t.length]=ct("Properties",null,{xmlns:ht.EXT_PROPS,"xmlns:vt":ht.vt}),pn.forEach((function(r){if(void 0!==e[r[1]]){var i;switch(r[2]){case"string":i=Xe(String(e[r[1]]));break;case"bool":i=e[r[1]]?"true":"false"}void 0!==i&&(t[t.length]=n(r[0],i))}})),t[t.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=n("TitlesOfParts",n("vt:vector",e.SheetNames.map((function(e){return"<vt:lpstr>"+Xe(e)+"</vt:lpstr>"})).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}(e.Props)),o.extprops.push(a),hn(t.rels,3,a,cn.EXT_PROPS),e.Custprops!==e.Props&&Ne(e.Custprops||{}).length>0&&(He(s,a="docProps/custom.xml",function(e){var t=[Ve,ct("Properties",null,{xmlns:ht.CUST_PROPS,"xmlns:vt":ht.vt})];if(!e)return t.join("");var n=1;return Ne(e).forEach((function(r){++n,t[t.length]=ct("property",function(e,t){switch(typeof e){case"string":var n=ct("vt:lpwstr",Xe(e));return n.replace(/&quot;/g,"_x0022_");case"number":return ct((0|e)==e?"vt:i4":"vt:r8",Xe(String(e)));case"boolean":return ct("vt:bool",e?"true":"false")}if(e instanceof Date)return ct("vt:filetime",ut(e));throw new Error("Unable to serialize "+e)}(e[r]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:Xe(r)})})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}(e.Custprops)),o.custprops.push(a),hn(t.rels,4,a,cn.CUST_PROPS));var h,f,d,p=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var g={"!id":{}},m=e.Sheets[e.SheetNames[l-1]];if((m||{})["!type"],He(s,a="xl/worksheets/sheet"+l+"."+r,Nn(l-1,t,e,g)),o.sheets.push(a),hn(t.wbrels,-1,"worksheets/sheet"+l+"."+r,cn.WS[0]),m){var _=m["!comments"],v=!1,y="";if(_&&_.length>0){var b=!1;_.forEach((function(e){e[1].forEach((function(e){1==e.T&&(b=!0)}))})),b&&(He(s,y="xl/threadedComments/threadedComment"+l+".xml",xn(_,p,t)),o.threadedcomments.push(y),hn(g,-1,"../threadedComments/threadedComment"+l+".xml",cn.TCMNT)),He(s,y="xl/comments"+l+"."+r,wn(_)),o.comments.push(y),hn(g,-1,"../comments"+l+"."+r,cn.CMNT),v=!0}m["!legacy"]&&v&&He(s,"xl/drawings/vmlDrawing"+l+".vml",bn(l,m["!comments"])),delete m["!comments"],delete m["!legacy"]}g["!id"].rId1&&He(s,(d=void 0,d=(f=a).lastIndexOf("/"),f.slice(0,d+1)+"_rels/"+f.slice(d+1)+".rels"),un(g))}return null!=t.Strings&&t.Strings.length>0&&(He(s,a="xl/sharedStrings."+r,function(e,t){if(!t.bookSST)return"";var n=[Ve];n[n.length]=ct("sst",null,{xmlns:ft[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(null!=e[r]){var i=e[r],o="<si>";i.r?o+=i.r:(o+="<t",i.t||(i.t=""),"string"!=typeof i.t&&(i.t=String(i.t)),i.t.match(gn)&&(o+=' xml:space="preserve"'),o+=">"+Xe(i.t)+"</t>"),o+="</si>",n[n.length]=o}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}(t.Strings,t)),o.strs.push(a),hn(t.wbrels,-1,"sharedStrings."+r,cn.SST)),He(s,a="xl/workbook."+r,function(e){var t=[Ve];t[t.length]=ct("workbook",null,{xmlns:ft[0],"xmlns:r":ht.r});var n=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(On.forEach((function(t){null!=e.Workbook.WBProps[t[0]]&&e.Workbook.WBProps[t[0]]!=t[1]&&(r[t[0]]=e.Workbook.WBProps[t[0]])})),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),t[t.length]=ct("workbookPr",null,r);var i=e.Workbook&&e.Workbook.Sheets||[],o=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",o=0;o!=e.SheetNames.length&&i[o]&&i[o].Hidden;++o);o==e.SheetNames.length&&(o=0),t[t.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",o=0;o!=e.SheetNames.length;++o){var s={name:Xe(e.SheetNames[o].slice(0,31))};if(s.sheetId=""+(o+1),s["r:id"]="rId"+(o+1),i[o])switch(i[o].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden"}t[t.length]=ct("sheet",null,s)}return t[t.length]="</sheets>",n&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach((function(e){var n={name:e.Name};e.Comment&&(n.comment=e.Comment),null!=e.Sheet&&(n.localSheetId=""+e.Sheet),e.Hidden&&(n.hidden="1"),e.Ref&&(t[t.length]=ct("definedName",Xe(e.Ref),n))})),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}(e)),o.workbooks.push(a),hn(t.rels,1,a,cn.WB),He(s,a="xl/theme/theme1.xml",function(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var n=[Ve];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',n[n.length]='<a:font script="Hang" typeface="맑은 고딕"/>',n[n.length]='<a:font script="Hans" typeface="宋体"/>',n[n.length]='<a:font script="Hant" typeface="新細明體"/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',n[n.length]='<a:font script="Hang" typeface="맑은 고딕"/>',n[n.length]='<a:font script="Hans" typeface="宋体"/>',n[n.length]='<a:font script="Hant" typeface="新細明體"/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}(e.Themes,t)),o.themes.push(a),hn(t.wbrels,-1,"theme/theme1.xml",cn.THEME),He(s,a="xl/styles."+r,function(e,t){var n,r=[Ve,ct("styleSheet",null,{xmlns:ft[0],"xmlns:vt":ht.vt})];return e.SSF&&null!=(n=function(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach((function(n){for(var r=n[0];r<=n[1];++r)null!=e[r]&&(t[t.length]=ct("numFmt",null,{numFmtId:r,formatCode:Xe(e[r])}))})),1===t.length?"":(t[t.length]="</numFmts>",t[0]=ct("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(e.SSF))&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=function(e){var t=[];return t[t.length]=ct("cellXfs",null),e.forEach((function(e){t[t.length]=ct("xf",null,e)})),t[t.length]="</cellXfs>",2===t.length?"":(t[0]=ct("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}(e,t)),o.styles.push(a),hn(t.wbrels,-1,"styles."+r,cn.STY),e.vbaraw&&i&&(He(s,a="xl/vbaProject.bin",e.vbaraw),o.vba.push(a),hn(t.wbrels,-1,"vbaProject.bin",cn.VBA)),He(s,a="xl/metadata."+r,((h=[Ve]).push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),h.join(""))),o.metadata.push(a),hn(t.wbrels,-1,"metadata."+r,cn.XLMETA),p.length>1&&(He(s,a="xl/persons/person.xml",function(e){var t=[Ve,ct("personList",null,{xmlns:ht.TCMNT,"xmlns:x":ft[0]}).replace(/[\/]>/,">")];return e.forEach((function(e,n){t.push(ct("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:e,providerId:"None"}))})),t.push("</personList>"),t.join("")}(p)),o.people.push(a),hn(t.wbrels,-1,"persons/person.xml",cn.PEOPLE)),He(s,"[Content_Types].xml",function(e,t,n){var r,i=function(e){for(var t=[],n=Ne(e),r=0;r!==n.length;++r)null==t[e[n[r]]]&&(t[e[n[r]]]=[]),t[e[n[r]]].push(n[r]);return t}(an),o=[];n||(o[o.length]=Ve,o[o.length]=ct("Types",null,{xmlns:ht.CT,"xmlns:xsd":ht.xsd,"xmlns:xsi":ht.xsi}),o=o.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map((function(e){return ct("Default",null,{Extension:e[0],ContentType:e[1]})}))));var s=function(n){e[n]&&e[n].length>0&&(r=e[n][0],o[o.length]=ct("Override",null,{PartName:("/"==r[0]?"":"/")+r,ContentType:ln[n][t.bookType]||ln[n].xlsx}))},a=function(n){(e[n]||[]).forEach((function(e){o[o.length]=ct("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:ln[n][t.bookType]||ln[n].xlsx})}))},l=function(t){(e[t]||[]).forEach((function(e){o[o.length]=ct("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:i[t][0]})}))};return s("workbooks"),a("sheets"),a("charts"),l("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),a("metadata"),l("people"),!n&&o.length>2&&(o[o.length]="</Types>",o[1]=o[1].replace("/>",">")),o.join("")}(o,t)),He(s,"_rels/.rels",un(t.rels)),He(s,"xl/_rels/workbook.xml.rels",un(t.wbrels)),delete t.revssf,delete t.ssf,s}function qn(e,t){var n={},r=T?"nodebuffer":"undefined"!=typeof Uint8Array?"array":"string";if(t.compression&&(n.compression="DEFLATE"),t.password)n.type=r;else switch(t.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":n.type=r;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?Ie.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!t.compression}):e.generate(n);if("undefined"!=typeof Deno&&"string"==typeof i){if("binary"==t.type||"base64"==t.type)return i;i=new Uint8Array(P(i))}return t.password&&"undefined"!=typeof encrypt_agile?function(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return De(t.file,Ie.write(e,{type:T?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ie.write(e,t)}(encrypt_agile(i,t.password),t):"file"===t.type?De(t.file,i):"string"==t.type?rt(i):i}function Un(e,t){w(1200),b(1252),function(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t,n,r,i=e.Workbook&&e.Workbook.Sheets||[];t=e.SheetNames,n=i,r=!!e.vbaraw,t.forEach((function(e,i){Rn(e);for(var o=0;o<i;++o)if(e==t[o])throw new Error("Duplicate Sheet Name: "+e);if(r){var s=n&&n[i]&&n[i].CodeName||e;if(95==s.charCodeAt(0)&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}}));for(var o=0;o<e.SheetNames.length;++o)Tn(e.Sheets[e.SheetNames[o]],e.SheetNames[o],o);e.SheetNames.forEach((function(t,n){var r=e.Sheets[t];if(r&&r["!autofilter"]){var i;e.Workbook||(e.Workbook={}),e.Workbook.Names||(e.Workbook.Names=[]),e.Workbook.Names.forEach((function(e){"_xlnm._FilterDatabase"==e.Name&&e.Sheet==n&&(i=e)}));var o=tn(t)+"!"+en(r["!autofilter"].ref);i?i.Ref=o:e.Workbook.Names.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:o})}}))}(e);var n=ze(t||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),"array"==n.type){n.type="binary";var r=Un(e,n);return n.type="array",P(r)}return function(e,t){var n=ze(t||{});return qn($n(e,n),n)}(e,n)}function Bn(e,t,n,r,i,o,s){var a=Gt(n),l=s.defval,c=s.raw||!Object.prototype.hasOwnProperty.call(s,"raw"),u=!0,h=null!=e["!data"],f=1===i?[]:{};if(1!==i)if(Object.defineProperty)try{Object.defineProperty(f,"__rowNum__",{value:n,enumerable:!1})}catch(e){f.__rowNum__=n}else f.__rowNum__=n;if(!h||e["!data"][n])for(var d=t.s.c;d<=t.e.c;++d){var p=h?(e["!data"][n]||[])[d]:e[r[d]+a];if(void 0!==p&&void 0!==p.t){var g=p.v;switch(p.t){case"z":if(null==g)break;continue;case"e":g=0==g?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(null!=o[d]){if(null==g)if("e"==p.t&&null===g)f[o[d]]=null;else if(void 0!==l)f[o[d]]=l;else{if(!c||null!==g)continue;f[o[d]]=null}else f[o[d]]=c&&("n"!==p.t||"n"===p.t&&!1!==s.rawNumbers)?g:rn(p,g,s);null!=g&&(u=!1)}}else{if(void 0===l)continue;null!=o[d]&&(f[o[d]]=l)}}return{row:f,isempty:u}}function Wn(e,t){if(null==e||null==e["!ref"])return[];var n={t:"n",v:0},r=0,i=1,o=[],s=0,a="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=null!=c.range?c.range:e["!ref"];switch(1===c.header?r=1:"A"===c.header?r=2:Array.isArray(c.header)?r=3:null==c.header&&(r=0),typeof u){case"string":l=nn(u);break;case"number":(l=nn(e["!ref"])).s.r=u;break;default:l=u}r>0&&(i=0);var h=Gt(l.s.r),f=[],d=[],p=0,g=0,m=null!=e["!data"],_=l.s.r,v=0,y={};m&&!e["!data"][_]&&(e["!data"][_]=[]);var b=c.skipHidden&&e["!cols"]||[],w=c.skipHidden&&e["!rows"]||[];for(v=l.s.c;v<=l.e.c;++v)if(!(b[v]||{}).hidden)switch(f[v]=Kt(v),n=m?e["!data"][_][v]:e[f[v]+h],r){case 1:o[v]=v-l.s.c;break;case 2:o[v]=f[v];break;case 3:o[v]=c.header[v-l.s.c];break;default:if(null==n&&(n={w:"__EMPTY",t:"s"}),a=s=rn(n,null,c),g=y[s]||0){do{a=s+"_"+g++}while(y[a]);y[s]=g,y[a]=1}else y[s]=1;o[v]=a}for(_=l.s.r+i;_<=l.e.r;++_)if(!(w[_]||{}).hidden){var x=Bn(e,l,_,f,r,o,c);(!1===x.isempty||(1===r?!1!==c.blankrows:c.blankrows))&&(d[p++]=x.row)}return d.length=p,d}!function(){try{return"undefined"==typeof Uint8Array||void 0===Uint8Array.prototype.subarray?"slice":"undefined"!=typeof Buffer?void 0===Buffer.prototype.subarray?"slice":("function"==typeof Buffer.from?Buffer.from([72,62]):new Buffer([72,62]))instanceof Uint8Array?"subarray":"slice":"subarray"}catch(e){return"slice"}}();var Hn=/"/g;function Vn(e,t,n,r,i,o,s,a){for(var l=!0,c=[],u="",h=Gt(n),f=null!=e["!data"],d=f&&e["!data"][n]||[],p=t.s.c;p<=t.e.c;++p)if(r[p]){var g=f?d[p]:e[r[p]+h];if(null==g)u="";else if(null!=g.v){l=!1,u=""+(a.rawNumbers&&"n"==g.t?g.v:rn(g,null,a));for(var m=0,_=0;m!==u.length;++m)if((_=u.charCodeAt(m))===i||_===o||34===_||a.forceQuotes){u='"'+u.replace(Hn,'""')+'"';break}"ID"==u&&(u='"ID"')}else null==g.f||g.F?u="":(l=!1,(u="="+g.f).indexOf(",")>=0&&(u='"'+u.replace(Hn,'""')+'"'));c.push(u)}return!1===a.blankrows&&l?null:c.join(s)}function Yn(e,t){var n=[],r=null==t?{}:t;if(null==e||null==e["!ref"])return"";for(var i=nn(e["!ref"]),o=void 0!==r.FS?r.FS:",",s=o.charCodeAt(0),a=void 0!==r.RS?r.RS:"\n",l=a.charCodeAt(0),c=new RegExp(("|"==o?"\\|":o)+"+$"),u="",h=[],f=r.skipHidden&&e["!cols"]||[],d=r.skipHidden&&e["!rows"]||[],p=i.s.c;p<=i.e.c;++p)(f[p]||{}).hidden||(h[p]=Kt(p));for(var g=0,m=i.s.r;m<=i.e.r;++m)(d[m]||{}).hidden||null!=(u=Vn(e,i,m,h,s,l,o,r))&&(r.strip&&(u=u.replace(c,"")),(u||!1!==r.blankrows)&&n.push((g++?a:"")+u));return n.join("")}function Gn(e,t,n){var r=n||{},i=e?null!=e["!data"]:r.dense;null!=C&&null==i&&(i=C);var o=+!r.skipHeader,s=e||{};!e&&i&&(s["!data"]=[]);var a=0,l=0;if(s&&null!=r.origin)if("number"==typeof r.origin)a=r.origin;else{var c="string"==typeof r.origin?Xt(r.origin):r.origin;a=c.r,l=c.c}var u={s:{c:0,r:0},e:{c:l,r:a+t.length-1+o}};if(s["!ref"]){var h=nn(s["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),-1==a&&(a=h.e.r+1,u.e.r=a+t.length-1+o)}else-1==a&&(a=0,u.e.r=t.length-1+o);var f=r.header||[],d=0,p=[];t.forEach((function(e,t){i&&!s["!data"][a+t+o]&&(s["!data"][a+t+o]=[]),i&&(p=s["!data"][a+t+o]),Ne(e).forEach((function(n){-1==(d=f.indexOf(n))&&(f[d=f.length]=n);var c=e[n],u="z",h="",g=i?"":Kt(l+d)+Gt(a+t+o),m=i?p[l+d]:s[g];!c||"object"!=typeof c||c instanceof Date?("number"==typeof c?u="n":"boolean"==typeof c?u="b":"string"==typeof c?u="s":c instanceof Date?(u="d",r.cellDates||(u="n",c=Re(c)),h=null!=m&&m.z&&be(m.z)?m.z:r.dateNF||Y[14]):null===c&&r.nullError&&(u="e",c=0),m?(m.t=u,m.v=c,delete m.w,delete m.R,h&&(m.z=h)):i?p[l+d]=m={t:u,v:c}:s[g]=m={t:u,v:c},h&&(m.z=h)):i?p[l+d]=c:s[g]=c}))})),u.e.c=Math.max(u.e.c,l+f.length-1);var g=Gt(a);if(i&&!s["!data"][a]&&(s["!data"][a]=[]),o)for(d=0;d<f.length;++d)i?s["!data"][a][d+l]={t:"s",v:f[d]}:s[Kt(d+l)+g]={t:"s",v:f[d]};return s["!ref"]=Zt(u),s}function Kn(e,t,n){if("string"==typeof t){if(null!=e["!data"]){var r=Xt(t);return e["!data"][r.r]||(e["!data"][r.r]=[]),e["!data"][r.r][r.c]||(e["!data"][r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return Kn(e,"number"!=typeof t?Jt(t):Kt(n||0)+Gt(t))}function Xn(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}var Jn={encode_col:Kt,encode_row:Gt,encode_cell:Jt,encode_range:Zt,decode_col:function(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),n=0,r=0;r!==t.length;++r)n=26*n+t.charCodeAt(r)-64;return n-1},decode_row:function(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1},split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:Xt,decode_range:Qt,format_cell:rn,sheet_add_aoa:on,sheet_add_json:Gn,sheet_add_dom:Fn,aoa_to_sheet:function(e,t){return on(null,e,t)},json_to_sheet:function(e,t){return Gn(null,e,t)},table_to_sheet:Ln,table_to_book:function(e,t){return function(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",r={};return r[n]=e,{SheetNames:[n],Sheets:r}}(Ln(e,t),t)},sheet_to_csv:Yn,sheet_to_txt:function(e,t){t||(t={}),t.FS="\t",t.RS="\n";var n=Yn(e,t);if(void 0===g||"string"==t.type)return n;var r=g.utils.encode(1200,n,"str");return String.fromCharCode(255)+String.fromCharCode(254)+r},sheet_to_json:Wn,sheet_to_html:function(e,t){var n=t||{},r=null!=n.header?n.header:'<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',i=null!=n.footer?n.footer:"</body></html>",o=[r],s=Qt(e["!ref"]);o.push(function(e,t,n){return[].join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}(0,0,n));for(var a=s.s.r;a<=s.e.r;++a)o.push(Mn(e,s,a,n));return o.push("</table>"+i),o.join("")},sheet_to_formulae:function(e){var t,n="",r="";if(null==e||null==e["!ref"])return[];var i,o=nn(e["!ref"]),s="",a=[],l=[],c=null!=e["!data"];for(i=o.s.c;i<=o.e.c;++i)a[i]=Kt(i);for(var u=o.s.r;u<=o.e.r;++u)for(s=Gt(u),i=o.s.c;i<=o.e.c;++i)if(n=a[i]+s,r="",void 0!==(t=c?(e["!data"][u]||[])[i]:e[n])){if(null!=t.F){if(n=t.F,!t.f)continue;r=t.f,-1==n.indexOf(":")&&(n=n+":"+n)}if(null!=t.f)r=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)r=""+t.v;else if("b"==t.t)r=t.v?"TRUE":"FALSE";else if(void 0!==t.w)r="'"+t.w;else{if(void 0===t.v)continue;r="s"==t.t?"'"+t.v:""+t.v}}l[l.length]=n+"="+r}return l},sheet_to_row_object_array:Wn,sheet_get_cell:Kn,book_new:function(){return{SheetNames:[],Sheets:{}}},book_append_sheet:function(e,t,n,r){var i=1;if(!n)for(;i<=65535&&-1!=e.SheetNames.indexOf(n="Sheet"+i);++i,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(n)>=0){var o=n.match(/(^.*?)(\d+)$/);i=o&&+o[2]||0;var s=o&&o[1]||n;for(++i;i<=65535&&-1!=e.SheetNames.indexOf(n=s+i);++i);}if(Rn(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n},book_set_sheet_visibility:function(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[r].Hidden=n},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:Xn,cell_set_internal_link:function(e,t,n){return Xn(e,"#"+t,n)},cell_add_comment:function(e,t,n){e.c||(e.c=[]),e.c.push({t,a:n||"SheetJS"})},sheet_set_array_formula:function(e,t,n,r){for(var i="string"!=typeof t?t:nn(t),o="string"==typeof t?t:Zt(t),s=i.s.r;s<=i.e.r;++s)for(var a=i.s.c;a<=i.e.c;++a){var l=Kn(e,s,a);l.t="n",l.F=o,delete l.v,s==i.s.r&&a==i.s.c&&(l.f=n,r&&(l.D=!0))}var c=Qt(e["!ref"]);return c.s.r>i.s.r&&(c.s.r=i.s.r),c.s.c>i.s.c&&(c.s.c=i.s.c),c.e.r<i.e.r&&(c.e.r=i.e.r),c.e.c<i.e.c&&(c.e.c=i.e.c),e["!ref"]=Zt(c),e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Qn=function(e,t){if(!e)throw Zn(t)},Zn=function(e){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+e)},er=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},tr={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){const i=e[t],o=t+1<e.length,s=o?e[t+1]:0,a=t+2<e.length,l=a?e[t+2]:0,c=i>>2,u=(3&i)<<4|s>>4;let h=(15&s)<<2|l>>6,f=63&l;a||(f=64,o||(h=64)),r.push(n[c],n[u],n[h],n[f])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(er(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){const o=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{const o=e[n++],s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){const i=n[e.charAt(t++)],o=t<e.length?n[e.charAt(t)]:0;++t;const s=t<e.length?n[e.charAt(t)]:64;++t;const a=t<e.length?n[e.charAt(t)]:64;if(++t,null==i||null==o||null==s||null==a)throw new nr;const l=i<<2|o>>4;if(r.push(l),64!==s){const e=o<<4&240|s>>2;if(r.push(e),64!==a){const e=s<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class nr extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const rr=function(e){const t=er(e);return tr.encodeByteArray(t,!0)},ir=function(e){return rr(e).replace(/\./g,"")},or=function(e){try{return tr.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function sr(e){return ar(void 0,e)}function ar(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=ar(e[n],t[n]));return e}const lr=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const e=process.env.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}const t=e&&or(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},cr=()=>{var e;return null===(e=lr())||void 0===e?void 0:e.config};class ur{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function hr(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test("undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:"")}class fr extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,fr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,dr.prototype.create)}}class dr{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?function(e,t){return e.replace(pr,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(i,n):"Error",s=`${this.serviceName}: ${o} (${r}).`;return new fr(r,s,n)}}const pr=/\{\$([^}]+)}/g;function gr(e){return JSON.parse(e)}function mr(e){return JSON.stringify(e)}const _r=function(e){let t={},n={},r={},i="";try{const o=e.split(".");t=gr(or(o[0])||""),n=gr(or(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}};function vr(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function yr(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function br(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function wr(e,t,n){const r={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function xr(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],o=t[i];if(Cr(n)&&Cr(o)){if(!xr(n,o))return!1}else if(n!==o)return!1}for(const e of r)if(!n.includes(e))return!1;return!0}function Cr(e){return null!==e&&"object"==typeof e}class Sr{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const n=this.W_;if("string"==typeof e)for(let r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let e=16;e<80;e++){const t=n[e-3]^n[e-8]^n[e-14]^n[e-16];n[e]=4294967295&(t<<1|t>>>31)}let r,i,o=this.chain_[0],s=this.chain_[1],a=this.chain_[2],l=this.chain_[3],c=this.chain_[4];for(let e=0;e<80;e++){e<40?e<20?(r=l^s&(a^l),i=1518500249):(r=s^a^l,i=1859775393):e<60?(r=s&a|l&(s|a),i=2400959708):(r=s^a^l,i=3395469782);const t=(o<<5|o>>>27)+r+c+i+n[e]&4294967295;c=l,l=a,a=4294967295&(s<<30|s>>>2),s=o,o=t}this.chain_[0]=this.chain_[0]+o&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const n=t-this.blockSize;let r=0;const i=this.buf_;let o=this.inbuf_;for(;r<t;){if(0===o)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[o]=e.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<t;)if(i[o]=e[r],++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let e=this.blockSize-1;e>=56;e--)this.buf_[e]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let t=0;t<5;t++)for(let r=24;r>=0;r-=8)e[n]=this.chain_[t]>>r&255,++n;return e}}function kr(e,t){return`${e} failed: ${t} argument `}const Er=function(e){let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function Tr(e){return e&&e._delegate?e._delegate:e}class Ir{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Ar="[DEFAULT]";class Dr{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new ur;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:Ar})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e=Ar){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e=Ar){return this.instances.has(e)}getOptions(e=Ar){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(e)&&t.resolve(r);return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===Ar?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}var r;return n||null}normalizeInstanceIdentifier(e=Ar){return this.component?this.component.multipleInstances?e:Ar:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Nr{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Dr(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const Or=[];var Pr;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(Pr||(Pr={}));const Rr={debug:Pr.DEBUG,verbose:Pr.VERBOSE,info:Pr.INFO,warn:Pr.WARN,error:Pr.ERROR,silent:Pr.SILENT},Mr=Pr.INFO,Fr={[Pr.DEBUG]:"log",[Pr.VERBOSE]:"log",[Pr.INFO]:"info",[Pr.WARN]:"warn",[Pr.ERROR]:"error"},Lr=(e,t,...n)=>{if(t<e.logLevel)return;const r=(new Date).toISOString(),i=Fr[t];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[i](`[${r}]  ${e.name}:`,...n)};class jr{constructor(e){this.name=e,this._logLevel=Mr,this._logHandler=Lr,this._userLogHandler=null,Or.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Pr))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?Rr[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Pr.DEBUG,...e),this._logHandler(this,Pr.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Pr.VERBOSE,...e),this._logHandler(this,Pr.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Pr.INFO,...e),this._logHandler(this,Pr.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Pr.WARN,...e),this._logHandler(this,Pr.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Pr.ERROR,...e),this._logHandler(this,Pr.ERROR,...e)}}const zr=(e,t)=>t.some((t=>e instanceof t));let $r,qr;const Ur=new WeakMap,Br=new WeakMap,Wr=new WeakMap,Hr=new WeakMap,Vr=new WeakMap;let Yr={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return Br.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Wr.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Kr(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function Gr(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(qr||(qr=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(Xr(this),e),Kr(Ur.get(this))}:function(...e){return Kr(t.apply(Xr(this),e))}:function(e,...n){const r=t.call(Xr(this),e,...n);return Wr.set(r,e.sort?e.sort():[e]),Kr(r)}:(e instanceof IDBTransaction&&function(e){if(Br.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",o),e.removeEventListener("abort",o)},i=()=>{t(),r()},o=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",o),e.addEventListener("abort",o)}));Br.set(e,t)}(e),zr(e,$r||($r=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,Yr):e);var t}function Kr(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",o)},i=()=>{t(Kr(e.result)),r()},o=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",o)}));return t.then((t=>{t instanceof IDBCursor&&Ur.set(t,e)})).catch((()=>{})),Vr.set(t,e),t}(e);if(Hr.has(e))return Hr.get(e);const t=Gr(e);return t!==e&&(Hr.set(e,t),Vr.set(t,e)),t}const Xr=e=>Vr.get(e),Jr=["get","getKey","getAll","getAllKeys","count"],Qr=["put","add","delete","clear"],Zr=new Map;function ei(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(Zr.get(t))return Zr.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=Qr.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!Jr.includes(n))return;const o=async function(e,...t){const o=this.transaction(e,i?"readwrite":"readonly");let s=o.store;return r&&(s=s.index(t.shift())),(await Promise.all([s[n](...t),i&&o.done]))[0]};return Zr.set(t,o),o}var ti;ti=Yr,Yr={...ti,get:(e,t,n)=>ei(e,t)||ti.get(e,t,n),has:(e,t)=>!!ei(e,t)||ti.has(e,t)};class ni{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const ri="@firebase/app",ii="0.9.13",oi=new jr("@firebase/app"),si="[DEFAULT]",ai={[ri]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},li=new Map,ci=new Map;function ui(e,t){try{e.container.addComponent(t)}catch(n){oi.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function hi(e){const t=e.name;if(ci.has(t))return oi.debug(`There were multiple attempts to register component ${t}.`),!1;ci.set(t,e);for(const t of li.values())ui(t,e);return!0}const fi=new dr("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class di{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Ir("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw fi.create("app-deleted",{appName:this._name})}}function pi(e,t={}){let n=e;"object"!=typeof t&&(t={name:t});const r=Object.assign({name:si,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!=typeof i||!i)throw fi.create("bad-app-name",{appName:String(i)});if(n||(n=cr()),!n)throw fi.create("no-options");const o=li.get(i);if(o){if(xr(n,o.options)&&xr(r,o.config))return o;throw fi.create("duplicate-app",{appName:i})}const s=new Nr(i);for(const e of ci.values())s.addComponent(e);const a=new di(n,r,s);return li.set(i,a),a}function gi(e,t,n){var r;let i=null!==(r=ai[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const o=i.match(/\s|\//),s=t.match(/\s|\//);if(o||s){const e=[`Unable to register library "${i}" with version "${t}":`];return o&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&s&&e.push("and"),s&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void oi.warn(e.join(" "))}hi(new Ir(`${i}-version`,(()=>({library:i,version:t})),"VERSION"))}const mi="firebase-heartbeat-database",_i=1,vi="firebase-heartbeat-store";let yi=null;function bi(){return yi||(yi=function(e,t,{blocked:n,upgrade:r,blocking:i,terminated:o}={}){const s=indexedDB.open(e,t),a=Kr(s);return r&&s.addEventListener("upgradeneeded",(e=>{r(Kr(s.result),e.oldVersion,e.newVersion,Kr(s.transaction),e)})),n&&s.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{o&&e.addEventListener("close",(()=>o())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}(mi,_i,{upgrade:(e,t)=>{0===t&&e.createObjectStore(vi)}}).catch((e=>{throw fi.create("idb-open",{originalErrorMessage:e.message})}))),yi}async function wi(e,t){try{const n=(await bi()).transaction(vi,"readwrite"),r=n.objectStore(vi);await r.put(t,xi(e)),await n.done}catch(e){if(e instanceof fr)oi.warn(e.message);else{const t=fi.create("idb-set",{originalErrorMessage:null==e?void 0:e.message});oi.warn(t.message)}}}function xi(e){return`${e.name}!${e.options.appId}`}class Ci{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new ki(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=Si();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==t&&!this._heartbeatsCache.heartbeats.some((e=>e.date===t)))return this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const e=Si(),{heartbeatsToSend:t,unsentEntries:n}=function(e,t=1024){const n=[];let r=e.slice();for(const i of e){const e=n.find((e=>e.agent===i.agent));if(e){if(e.dates.push(i.date),Ei(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Ei(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),r=ir(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function Si(){return(new Date).toISOString().substring(0,10)}class ki{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!function(){try{return"object"==typeof indexedDB}catch(e){return!1}}()&&new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){return await async function(e){try{const t=await bi();return await t.transaction(vi).objectStore(vi).get(xi(e))}catch(e){if(e instanceof fr)oi.warn(e.message);else{const t=fi.create("idb-get",{originalErrorMessage:null==e?void 0:e.message});oi.warn(t.message)}}}(this.app)||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return wi(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return wi(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Ei(e){return ir(JSON.stringify({version:2,heartbeats:e})).length}hi(new Ir("platform-logger",(e=>new ni(e)),"PRIVATE")),hi(new Ir("heartbeat",(e=>new Ci(e)),"PRIVATE")),gi(ri,ii,""),gi(ri,ii,"esm2017"),gi("fire-js",""),gi("firebase","9.23.0","app");const Ti="@firebase/database",Ii="0.14.4";let Ai="";class Di{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),mr(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:gr(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class Ni{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return vr(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const Oi=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){const t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new Di(t)}}catch(e){}return new Ni},Pi=Oi("localStorage"),Ri=Oi("sessionStorage"),Mi=new jr("@firebase/database"),Fi=function(){let e=1;return function(){return e++}}(),Li=function(e){const t=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);if(i>=55296&&i<=56319){const t=i-55296;r++,Qn(r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(t<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t}(e),n=new Sr;n.update(t);const r=n.digest();return tr.encodeByteArray(r)},ji=function(...e){let t="";for(let n=0;n<e.length;n++){const r=e[n];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?t+=ji.apply(null,r):t+="object"==typeof r?mr(r):r,t+=" "}return t};let zi=null,$i=!0;const qi=function(...e){if(!0===$i&&($i=!1,null===zi&&!0===Ri.get("logging_enabled")&&(t=!0,Qn(!n||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(Mi.logLevel=Pr.VERBOSE,zi=Mi.log.bind(Mi),n&&Ri.set("logging_enabled",!0)):"function"==typeof t?zi=t:(zi=null,Ri.remove("logging_enabled")))),zi){const t=ji.apply(null,e);zi(t)}var t,n},Ui=function(e){return function(...t){qi(e,...t)}},Bi=function(...e){const t="FIREBASE INTERNAL ERROR: "+ji(...e);Mi.error(t)},Wi=function(...e){const t=`FIREBASE FATAL ERROR: ${ji(...e)}`;throw Mi.error(t),new Error(t)},Hi=function(...e){const t="FIREBASE WARNING: "+ji(...e);Mi.warn(t)},Vi=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},Yi="[MIN_NAME]",Gi="[MAX_NAME]",Ki=function(e,t){if(e===t)return 0;if(e===Yi||t===Gi)return-1;if(t===Yi||e===Gi)return 1;{const n=ro(e),r=ro(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1}},Xi=function(e,t){return e===t?0:e<t?-1:1},Ji=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+mr(t))},Qi=function(e){if("object"!=typeof e||null===e)return mr(e);const t=[];for(const n in e)t.push(n);t.sort();let n="{";for(let r=0;r<t.length;r++)0!==r&&(n+=","),n+=mr(t[r]),n+=":",n+=Qi(e[t[r]]);return n+="}",n},Zi=function(e,t){const n=e.length;if(n<=t)return[e];const r=[];for(let i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};function eo(e,t){for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])}const to=function(e){Qn(!Vi(e),"Invalid JSON number");let t,n,r,i,o;0===e?(n=0,r=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(i=Math.min(Math.floor(Math.log(e)/Math.LN2),1023),n=i+1023,r=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(e/Math.pow(2,-1074))));const s=[];for(o=52;o;o-=1)s.push(r%2?1:0),r=Math.floor(r/2);for(o=11;o;o-=1)s.push(n%2?1:0),n=Math.floor(n/2);s.push(t?1:0),s.reverse();const a=s.join("");let l="";for(o=0;o<64;o+=8){let e=parseInt(a.substr(o,8),2).toString(16);1===e.length&&(e="0"+e),l+=e}return l.toLowerCase()},no=new RegExp("^-?(0*)\\d{1,10}$"),ro=function(e){if(no.test(e)){const t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},io=function(e){try{e()}catch(e){setTimeout((()=>{const t=e.stack||"";throw Hi("Exception was thrown by user callback.",t),e}),Math.floor(0))}},oo=function(e,t){const n=setTimeout(e,t);return"number"==typeof n&&"undefined"!=typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"==typeof n&&n.unref&&n.unref(),n};class so{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then((e=>this.appCheck=e))}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise(((t,n)=>{setTimeout((()=>{this.appCheck?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then((t=>t.addTokenListener(e)))}notifyForInvalidToken(){Hi(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class ao{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((e=>this.auth_=e))}getToken(e){return this.auth_?this.auth_.getToken(e).catch((e=>e&&"auth/token-not-initialized"===e.code?(qi("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e))):new Promise(((t,n)=>{setTimeout((()=>{this.auth_?this.getToken(e).then(t,n):t(null)}),0)}))}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then((t=>t.addAuthTokenListener(e)))}removeTokenChangeListener(e){this.authProvider_.get().then((t=>t.removeAuthTokenListener(e)))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Hi(e)}}class lo{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}lo.OWNER="owner";const co="5",uo=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,ho="ac",fo="websocket",po="long_polling";class go{constructor(e,t,n,r,i=!1,o="",s=!1,a=!1){this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=s,this.isUsingEmulator=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Pi.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Pi.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function mo(e,t,n){let r;if(Qn("string"==typeof t,"typeof type must == string"),Qn("object"==typeof n,"typeof params must == object"),t===fo)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==po)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);const i=[];return eo(n,((e,t)=>{i.push(e+"="+t)})),r+i.join("&")}class _o{constructor(){this.counters_={}}incrementCounter(e,t=1){vr(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return sr(this.counters_)}}const vo={},yo={};function bo(e){const t=e.toString();return vo[t]||(vo[t]=new _o),vo[t]}class wo{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&io((()=>{this.onMessage_(e[t])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const xo="start";class Co{constructor(e,t,n,r,i,o,s){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=o,this.lastSessionId=s,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Ui(e),this.stats_=bo(t),this.urlFn=e=>(this.appCheckToken&&(e[ho]=this.appCheckToken),mo(t,po,e))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new wo(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if("complete"===document.readyState)e();else{let t=!1;const n=function(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new So(((...e)=>{const[t,n,r,i,o]=e;if(this.incrementIncomingBytes_(e),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,t===xo)this.id=n,this.password=r;else{if("close"!==t)throw new Error("Unrecognized command received: "+t);n?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(n,(()=>{this.onClosed_()}))):this.onClosed_()}}),((...e)=>{const[t,n]=e;this.incrementIncomingBytes_(e),this.myPacketOrderer.handleResponse(t,n)}),(()=>{this.onClosed_()}),this.urlFn);const e={};e[xo]="t",e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v=co,this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e[ho]=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&uo.test(location.hostname)&&(e.r="f");const t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Co.forceAllow_=!0}static forceDisallow(){Co.forceDisallow_=!0}static isAvailable(){return!(!Co.forceAllow_&&(Co.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=mr(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=rr(t),r=Zi(n,1840);for(let e=0;e<r.length;e++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[e]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=mr(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class So{constructor(e,t,n,r){this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=Fi(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=So.createIFrame_();let n="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(n='<script>document.domain="'+document.domain+'";<\/script>');const r="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(e){qi("frame writing exception"),e.stack&&qi(e.stack),qi(e)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||qi("No IE domain setting required")}catch(t){const n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){const e=this.pendingSegs.shift();n=n+"&seg"+r+"="+e.seg+"&ts"+r+"="+e.ts+"&d"+r+"="+e.d,r++}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(n,Math.floor(25e3));this.addTag(e,(()=>{clearTimeout(r),n()}))}addTag(e,t){setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){const e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{qi("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(e){}}),Math.floor(1))}}let ko=null;"undefined"!=typeof MozWebSocket?ko=MozWebSocket:"undefined"!=typeof WebSocket&&(ko=WebSocket);class Eo{constructor(e,t,n,r,i,o,s){this.connId=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Ui(this.connId),this.stats_=bo(t),this.connURL=Eo.connectionURL_(t,o,s,r,n),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,r,i){const o={};return o.v=co,"undefined"!=typeof location&&location.hostname&&uo.test(location.hostname)&&(o.r="f"),t&&(o.s=t),n&&(o.ls=n),r&&(o[ho]=r),i&&(o.p=i),mo(e,fo,o)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Pi.set("previous_websocket_failure",!0);try{let e;0,this.mySock=new ko(this.connURL,[],e)}catch(e){this.log_("Error instantiating WebSocket.");const t=e.message||e.data;return t&&this.log_(t),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");const t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){Eo.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const t=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(t);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==ko&&!Eo.forceDisallow_}static previouslyFailed(){return Pi.isInMemoryStorage||!0===Pi.get("previous_websocket_failure")}markConnectionHealthy(){Pi.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const e=this.frames.join("");this.frames=null;const t=gr(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(Qn(null===this.frames,"We already have a frame buffer"),e.length<=6){const t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;const t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{const e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();const t=mr(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const n=Zi(t,16384);n.length>1&&this.sendString_(String(n.length));for(let e=0;e<n.length;e++)this.sendString_(n[e])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Eo.responsesRequiredToBeHealthy=2,Eo.healthyTimeout=3e4;class To{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Co,Eo]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const t=Eo&&Eo.isAvailable();let n=t&&!Eo.previouslyFailed();if(e.webSocketOnly&&(t||Hi("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[Eo];else{const e=this.transports_=[];for(const t of To.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t);To.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}To.globalTransportInitialized_=!1;class Io{constructor(e,t,n,r,i,o,s,a,l,c){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=o,this.onReady_=s,this.onDisconnect_=a,this.onKill_=l,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Ui("c:"+this.id+":"),this.transportManager_=new To(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(t,n)}),Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=oo((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){const t={t:"d",d:e};this.sendData_(t)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=Ji("t",e),n=Ji("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=Ji("t",e),n=Ji("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=Ji("t",e);if("d"in e){const n=e.d;if("h"===t){const e=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(e.h=this.repoInfo_.host),this.onHandshake_(e)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?Bi("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Bi("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),co!==n&&Hi("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),oo((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):oo((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Pi.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class Ao{put(e,t,n,r){}merge(e,t,n,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}class Do{constructor(e){this.allowedEvents_=e,this.listeners_={},Qn(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const n=[...this.listeners_[e]];for(let e=0;e<n.length;e++)n[e].callback.apply(n[e].context,t)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});const r=this.getInitialEvent(e);r&&t.apply(n,r)}off(e,t,n){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let e=0;e<r.length;e++)if(r[e].callback===t&&(!n||n===r[e].context))return void r.splice(e,1)}validateEventType_(e){Qn(this.allowedEvents_.find((t=>t===e)),"Unknown event: "+e)}}class No extends Do{constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||hr()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new No}getInitialEvent(e){return Qn("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class Oo{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function Po(){return new Oo("")}function Ro(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function Mo(e){return e.pieces_.length-e.pieceNum_}function Fo(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new Oo(e.pieces_,t)}function Lo(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function jo(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function zo(e){if(e.pieceNum_>=e.pieces_.length)return null;const t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new Oo(t,0)}function $o(e,t){const n=[];for(let t=e.pieceNum_;t<e.pieces_.length;t++)n.push(e.pieces_[t]);if(t instanceof Oo)for(let e=t.pieceNum_;e<t.pieces_.length;e++)n.push(t.pieces_[e]);else{const e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&n.push(e[t])}return new Oo(n,0)}function qo(e){return e.pieceNum_>=e.pieces_.length}function Uo(e,t){const n=Ro(e),r=Ro(t);if(null===n)return t;if(n===r)return Uo(Fo(e),Fo(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function Bo(e,t){if(Mo(e)!==Mo(t))return!1;for(let n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function Wo(e,t){let n=e.pieceNum_,r=t.pieceNum_;if(Mo(e)>Mo(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}class Ho{constructor(e,t){this.errorPrefix_=t,this.parts_=jo(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let e=0;e<this.parts_.length;e++)this.byteLength_+=Er(this.parts_[e]);Vo(this)}}function Vo(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Yo(e))}function Yo(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}class Go extends Do{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,(()=>{const t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))}),!1)}static getInstance(){return new Go}getInitialEvent(e){return Qn("visible"===e,"Unknown event type: "+e),[this.visible_]}}const Ko=1e3;class Xo extends Ao{constructor(e,t,n,r,i,o,s,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=o,this.appCheckTokenProvider_=s,this.authOverride_=a,this.id=Xo.nextPersistentConnectionId_++,this.log_=Ui("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Ko,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Go.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&No.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){const r=++this.requestNumber_,i={r,a:e,b:t};this.log_(mr(i)),Qn(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}get(e){this.initConnection_();const t=new ur,n={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:e=>{const n=e.d;"ok"===e.s?t.resolve(n):t.reject(n)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),t.promise}listen(e,t,n,r){this.initConnection_();const i=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),Qn(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Qn(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");const s={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(o).set(i,s),this.connected_&&this.sendListen_(s)}sendGet_(e){const t=this.outstandingGets_[e];this.sendRequest("g",t.request,(n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)}))}sendListen_(e){const t=e.query,n=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+n+" for "+r);const i={p:n};e.tag&&(i.q=t._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest("q",i,(i=>{const o=i.d,s=i.s;Xo.warnOnListenWarnings_(o,t),(this.listens.get(n)&&this.listens.get(n).get(r))===e&&(this.log_("listen response",i),"ok"!==s&&this.removeListen_(n,r),e.onComplete&&e.onComplete(s,o))}))}static warnOnListenWarnings_(e,t){if(e&&"object"==typeof e&&vr(e,"w")){const n=yr(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();Hi(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${e} at ${n} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&40===e.length||function(e){const t=_r(e).claims;return"object"==typeof t&&!0===t.admin}(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,t=function(e){const t=_r(e).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")}(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,(t=>{const n=t.s,r=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,r))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(e=>{const t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)}))}unlisten(e,t){const n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),Qn(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}sendUnlisten_(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);const i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,r){const i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(e=>{r&&setTimeout((()=>{r(e.s,e.d)}),Math.floor(0))}))}put(e,t,n,r){this.putInternal("p",e,t,n,r)}merge(e,t,n,r){this.putInternal("m",e,t,n,r)}putInternal(e,t,n,r,i){this.initConnection_();const o={p:t,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:r}),this.outstandingPutCount_++;const s=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(s):this.log_("Buffering put: "+t)}sendPut_(e){const t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,(n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),r&&r(n.s,n.d)}))}reportStats(e){if(this.connected_){const t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,(e=>{if("ok"!==e.s){const t=e.d;this.log_("reportStats","Error sending stats: "+t)}}))}}onDataMessage_(e){if("r"in e){this.log_("from server: "+mr(e));const t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):Bi("Unrecognized action received from server: "+mr(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){Qn(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Ko,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Ko,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Ko),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const e=(new Date).getTime()-this.lastConnectionAttemptTime_;let t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+Xo.nextConnectionId_++,i=this.lastSessionId;let o=!1,s=null;const a=function(){s?s.close():(o=!0,n())},l=function(e){Qn(s,"sendRequest call when we're not connected not allowed."),s.sendRequest(e)};this.realtime_={close:a,sendRequest:l};const c=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[a,l]=await Promise.all([this.authTokenProvider_.getToken(c),this.appCheckTokenProvider_.getToken(c)]);o?qi("getToken() completed but was canceled"):(qi("getToken() completed. Creating connection."),this.authToken_=a&&a.accessToken,this.appCheckToken_=l&&l.token,s=new Io(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,(e=>{Hi(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),i))}catch(e){this.log_("Failed to get token: "+e),o||(this.repoInfo_.nodeAdmin&&Hi(e),a())}}}interrupt(e){qi("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){qi("Resuming connection for reason: "+e),delete this.interruptReasons_[e],br(this.interruptReasons_)&&(this.reconnectDelay_=Ko,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map((e=>Qi(e))).join("$"):"default";const r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){const n=new Oo(e).toString();let r;if(this.listens.has(n)){const e=this.listens.get(n);r=e.get(t),e.delete(t),0===e.size&&this.listens.delete(n)}else r=void 0;return r}onAuthRevoked_(e,t){qi("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){qi("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let t="js";e["sdk."+t+"."+Ai.replace(/\./g,"-")]=1,hr()?e["framework.cordova"]=1:"object"==typeof navigator&&"ReactNative"===navigator.product&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=No.getInstance().currentlyOnline();return br(this.interruptReasons_)&&e}}Xo.nextPersistentConnectionId_=0,Xo.nextConnectionId_=0;class Jo{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Jo(e,t)}}class Qo{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const n=new Jo(Yi,e),r=new Jo(Yi,t);return 0!==this.compare(n,r)}minPost(){return Jo.MIN}}let Zo;class es extends Qo{static get __EMPTY_NODE(){return Zo}static set __EMPTY_NODE(e){Zo=e}compare(e,t){return Ki(e.name,t.name)}isDefinedOn(e){throw Zn("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Jo.MIN}maxPost(){return new Jo(Gi,Zo)}makePost(e,t){return Qn("string"==typeof e,"KeyIndex indexValue must always be a string."),new Jo(e,Zo)}toString(){return".key"}}const ts=new es;class ns{constructor(e,t,n,r,i=null){this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(o=t?n(e.key,t):1,r&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class rs{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:rs.RED,this.left=null!=r?r:is.EMPTY_NODE,this.right=null!=i?i:is.EMPTY_NODE}copy(e,t,n,r,i){return new rs(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return is.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,t){let n,r;if(n=this,t(e,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return is.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,rs.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,rs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}rs.RED=!0,rs.BLACK=!1;class is{constructor(e,t=is.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new is(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,rs.BLACK,null,null))}remove(e){return new is(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,rs.BLACK,null,null))}get(e){let t,n=this.root_;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t)return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,r=null;for(;!n.isEmpty();){if(t=this.comparator_(e,n.key),0===t){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new ns(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new ns(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new ns(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new ns(this.root_,null,this.comparator_,!0,e)}}function os(e,t){return Ki(e.name,t.name)}function ss(e,t){return Ki(e,t)}let as;is.EMPTY_NODE=new class{copy(e,t,n,r,i){return this}insert(e,t,n){return new rs(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const ls=function(e){return"number"==typeof e?"number:"+to(e):"string:"+e},cs=function(e){if(e.isLeafNode()){const t=e.val();Qn("string"==typeof t||"number"==typeof t||"object"==typeof t&&vr(t,".sv"),"Priority must be a string or number.")}else Qn(e===as||e.isEmpty(),"priority of unexpected type.");Qn(e===as||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let us,hs,fs;class ds{constructor(e,t=ds.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,Qn(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),cs(this.priorityNode_)}static set __childrenNodeConstructor(e){us=e}static get __childrenNodeConstructor(){return us}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new ds(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:ds.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return qo(e)?this:".priority"===Ro(e)?this.priorityNode_:ds.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:ds.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){const n=Ro(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:(Qn(".priority"!==n||1===Mo(e),".priority must be the last token in a path"),this.updateImmediateChild(n,ds.__childrenNodeConstructor.EMPTY_NODE.updateChild(Fo(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+ls(this.priorityNode_.val())+":");const t=typeof this.value_;e+=t+":",e+="number"===t?to(this.value_):this.value_,this.lazyHash_=Li(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===ds.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof ds.__childrenNodeConstructor?-1:(Qn(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const t=typeof e.value_,n=typeof this.value_,r=ds.VALUE_TYPE_ORDER.indexOf(t),i=ds.VALUE_TYPE_ORDER.indexOf(n);return Qn(r>=0,"Unknown leaf type: "+t),Qn(i>=0,"Unknown leaf type: "+n),r===i?"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1}}ds.VALUE_TYPE_ORDER=["object","boolean","number","string"];const ps=new class extends Qo{compare(e,t){const n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?Ki(e.name,t.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Jo.MIN}maxPost(){return new Jo(Gi,new ds("[PRIORITY-POST]",fs))}makePost(e,t){const n=hs(e);return new Jo(t,new ds("[PRIORITY-POST]",n))}toString(){return".priority"}},gs=Math.log(2);class ms{constructor(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/gs,10)),this.current_=this.count-1;const n=(r=this.count,parseInt(Array(r+1).join("1"),2));var r;this.bits_=e+1&n}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const _s=function(e,t,n,r){e.sort(t);const i=function(t,r){const o=r-t;let s,a;if(0===o)return null;if(1===o)return s=e[t],a=n?n(s):s,new rs(a,s.node,rs.BLACK,null,null);{const l=parseInt(o/2,10)+t,c=i(t,l),u=i(l+1,r);return s=e[l],a=n?n(s):s,new rs(a,s.node,rs.BLACK,c,u)}},o=function(t){let r=null,o=null,s=e.length;const a=function(t,r){const o=s-t,a=s;s-=t;const c=i(o+1,a),u=e[o],h=n?n(u):u;l(new rs(h,u.node,r,null,c))},l=function(e){r?(r.left=e,r=e):(o=e,r=e)};for(let e=0;e<t.count;++e){const n=t.nextBitIsOne(),r=Math.pow(2,t.count-(e+1));n?a(r,rs.BLACK):(a(r,rs.BLACK),a(r,rs.RED))}return o}(new ms(e.length));return new is(r||t,o)};let vs;const ys={};class bs{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return Qn(ys&&ps,"ChildrenNode.ts has not been loaded"),vs=vs||new bs({".priority":ys},{".priority":ps}),vs}get(e){const t=yr(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof is?t:null}hasIndex(e){return vr(this.indexSet_,e.toString())}addIndex(e,t){Qn(e!==ts,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let r=!1;const i=t.getIterator(Jo.Wrap);let o,s=i.getNext();for(;s;)r=r||e.isDefinedOn(s.node),n.push(s),s=i.getNext();o=r?_s(n,e.getCompare()):ys;const a=e.toString(),l=Object.assign({},this.indexSet_);l[a]=e;const c=Object.assign({},this.indexes_);return c[a]=o,new bs(c,l)}addToIndexes(e,t){const n=wr(this.indexes_,((n,r)=>{const i=yr(this.indexSet_,r);if(Qn(i,"Missing index implementation for "+r),n===ys){if(i.isDefinedOn(e.node)){const n=[],r=t.getIterator(Jo.Wrap);let o=r.getNext();for(;o;)o.name!==e.name&&n.push(o),o=r.getNext();return n.push(e),_s(n,i.getCompare())}return ys}{const r=t.get(e.name);let i=n;return r&&(i=i.remove(new Jo(e.name,r))),i.insert(e,e.node)}}));return new bs(n,this.indexSet_)}removeFromIndexes(e,t){const n=wr(this.indexes_,(n=>{if(n===ys)return n;{const r=t.get(e.name);return r?n.remove(new Jo(e.name,r)):n}}));return new bs(n,this.indexSet_)}}let ws;class xs{constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&cs(this.priorityNode_),this.children_.isEmpty()&&Qn(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return ws||(ws=new xs(new is(ss),null,bs.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||ws}updatePriority(e){return this.children_.isEmpty()?this:new xs(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{const t=this.children_.get(e);return null===t?ws:t}}getChild(e){const t=Ro(e);return null===t?this:this.getImmediateChild(t).getChild(Fo(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if(Qn(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{const n=new Jo(e,t);let r,i;t.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(e,t),i=this.indexMap_.addToIndexes(n,this.children_));const o=r.isEmpty()?ws:this.priorityNode_;return new xs(r,o,i)}}updateChild(e,t){const n=Ro(e);if(null===n)return t;{Qn(".priority"!==Ro(e)||1===Mo(e),".priority must be the last token in a path");const r=this.getImmediateChild(n).updateChild(Fo(e),t);return this.updateImmediateChild(n,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const t={};let n=0,r=0,i=!0;if(this.forEachChild(ps,((o,s)=>{t[o]=s.val(e),n++,i&&xs.INTEGER_REGEXP_.test(o)?r=Math.max(r,Number(o)):i=!1})),!e&&i&&r<2*n){const e=[];for(const n in t)e[n]=t[n];return e}return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+ls(this.getPriority().val())+":"),this.forEachChild(ps,((t,n)=>{const r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":Li(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){const r=this.resolveIndex_(n);if(r){const n=r.getPredecessorKey(new Jo(e,t));return n?n.name:null}return this.children_.getPredecessorKey(e)}getFirstChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.minKey();return e&&e.name}return this.children_.minKey()}getFirstChild(e){const t=this.getFirstChildName(e);return t?new Jo(t,this.children_.get(t)):null}getLastChildName(e){const t=this.resolveIndex_(e);if(t){const e=t.maxKey();return e&&e.name}return this.children_.maxKey()}getLastChild(e){const t=this.getLastChildName(e);return t?new Jo(t,this.children_.get(t)):null}forEachChild(e,t){const n=this.resolveIndex_(e);return n?n.inorderTraversal((e=>t(e.name,e.node))):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(e=>e));{const n=this.children_.getIteratorFrom(e.name,Jo.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)<0;)n.getNext(),r=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){const n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(e=>e));{const n=this.children_.getReverseIteratorFrom(e.name,Jo.Wrap);let r=n.peek();for(;null!=r&&t.compare(r,e)>0;)n.getNext(),r=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Cs?-1:0}withIndex(e){if(e===ts||this.indexMap_.hasIndex(e))return this;{const t=this.indexMap_.addIndex(e,this.children_);return new xs(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===ts||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){const e=this.getIterator(ps),n=t.getIterator(ps);let r=e.getNext(),i=n.getNext();for(;r&&i;){if(r.name!==i.name||!r.node.equals(i.node))return!1;r=e.getNext(),i=n.getNext()}return null===r&&null===i}return!1}return!1}}resolveIndex_(e){return e===ts?null:this.indexMap_.get(e.toString())}}xs.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const Cs=new class extends xs{constructor(){super(new is(ss),xs.EMPTY_NODE,bs.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return xs.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(Jo,{MIN:{value:new Jo(Yi,xs.EMPTY_NODE)},MAX:{value:new Jo(Gi,Cs)}}),es.__EMPTY_NODE=xs.EMPTY_NODE,ds.__childrenNodeConstructor=xs,as=Cs,fs=Cs;const Ss=!0;function ks(e,t=null){if(null===e)return xs.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),Qn(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e)return new ds(e,ks(t));if(e instanceof Array||!Ss){let n=xs.EMPTY_NODE;return eo(e,((t,r)=>{if(vr(e,t)&&"."!==t.substring(0,1)){const e=ks(r);!e.isLeafNode()&&e.isEmpty()||(n=n.updateImmediateChild(t,e))}})),n.updatePriority(ks(t))}{const n=[];let r=!1;if(eo(e,((e,t)=>{if("."!==e.substring(0,1)){const i=ks(t);i.isEmpty()||(r=r||!i.getPriority().isEmpty(),n.push(new Jo(e,i)))}})),0===n.length)return xs.EMPTY_NODE;const i=_s(n,os,(e=>e.name),ss);if(r){const e=_s(n,ps.getCompare());return new xs(i,ks(t),new bs({".priority":e},{".priority":ps}))}return new xs(i,ks(t),bs.Default)}}!function(e){hs=e}(ks);class Es extends Qo{constructor(e){super(),this.indexPath_=e,Qn(!qo(e)&&".priority"!==Ro(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?Ki(e.name,t.name):i}makePost(e,t){const n=ks(e),r=xs.EMPTY_NODE.updateChild(this.indexPath_,n);return new Jo(t,r)}maxPost(){const e=xs.EMPTY_NODE.updateChild(this.indexPath_,Cs);return new Jo(Gi,e)}toString(){return jo(this.indexPath_,0).join("/")}}const Ts=new class extends Qo{compare(e,t){const n=e.node.compareTo(t.node);return 0===n?Ki(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Jo.MIN}maxPost(){return Jo.MAX}makePost(e,t){const n=ks(e);return new Jo(t,n)}toString(){return".value"}};function Is(e){return{type:"value",snapshotNode:e}}function As(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function Ds(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function Ns(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}class Os{constructor(e){this.index_=e}updateChild(e,t,n,r,i,o){Qn(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const s=e.getImmediateChild(t);return s.getChild(r).equals(n.getChild(r))&&s.isEmpty()===n.isEmpty()?e:(null!=o&&(n.isEmpty()?e.hasChild(t)?o.trackChildChange(Ds(t,s)):Qn(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):s.isEmpty()?o.trackChildChange(As(t,n)):o.trackChildChange(Ns(t,n,s))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))}updateFullNode(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(ps,((e,r)=>{t.hasChild(e)||n.trackChildChange(Ds(e,r))})),t.isLeafNode()||t.forEachChild(ps,((t,r)=>{if(e.hasChild(t)){const i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(Ns(t,r,i))}else n.trackChildChange(As(t,r))}))),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?xs.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class Ps{constructor(e){this.indexedFilter_=new Os(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Ps.getStartPost_(e),this.endPost_=Ps.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,n=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&n}updateChild(e,t,n,r,i,o){return this.matches(new Jo(t,n))||(n=xs.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,o)}updateFullNode(e,t,n){t.isLeafNode()&&(t=xs.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(xs.EMPTY_NODE);const i=this;return t.forEachChild(ps,((e,t)=>{i.matches(new Jo(e,t))||(r=r.updateImmediateChild(e,xs.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class Rs{constructor(e){this.withinDirectionalStart=e=>this.reverse_?this.withinEndPost(e):this.withinStartPost(e),this.withinDirectionalEnd=e=>this.reverse_?this.withinStartPost(e):this.withinEndPost(e),this.withinStartPost=e=>{const t=this.index_.compare(this.rangedFilter_.getStartPost(),e);return this.startIsInclusive_?t<=0:t<0},this.withinEndPost=e=>{const t=this.index_.compare(e,this.rangedFilter_.getEndPost());return this.endIsInclusive_?t<=0:t<0},this.rangedFilter_=new Ps(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,n,r,i,o){return this.rangedFilter_.matches(new Jo(t,n))||(n=xs.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,o):this.fullLimitUpdateChild_(e,t,n,i,o)}updateFullNode(e,t,n){let r;if(t.isLeafNode()||t.isEmpty())r=xs.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;r=xs.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;e.hasNext()&&n<this.limit_;){const t=e.getNext();if(this.withinDirectionalStart(t)){if(!this.withinDirectionalEnd(t))break;r=r.updateImmediateChild(t.name,t.node),n++}}}else{let e;r=t.withIndex(this.index_),r=r.updatePriority(xs.EMPTY_NODE),e=this.reverse_?r.getReverseIterator(this.index_):r.getIterator(this.index_);let n=0;for(;e.hasNext();){const t=e.getNext();n<this.limit_&&this.withinDirectionalStart(t)&&this.withinDirectionalEnd(t)?n++:r=r.updateImmediateChild(t.name,xs.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,n,r,i){let o;if(this.reverse_){const e=this.index_.getCompare();o=(t,n)=>e(n,t)}else o=this.index_.getCompare();const s=e;Qn(s.numChildren()===this.limit_,"");const a=new Jo(t,n),l=this.reverse_?s.getFirstChild(this.index_):s.getLastChild(this.index_),c=this.rangedFilter_.matches(a);if(s.hasChild(t)){const e=s.getImmediateChild(t);let u=r.getChildAfterChild(this.index_,l,this.reverse_);for(;null!=u&&(u.name===t||s.hasChild(u.name));)u=r.getChildAfterChild(this.index_,u,this.reverse_);const h=null==u?1:o(u,a);if(c&&!n.isEmpty()&&h>=0)return null!=i&&i.trackChildChange(Ns(t,n,e)),s.updateImmediateChild(t,n);{null!=i&&i.trackChildChange(Ds(t,e));const n=s.updateImmediateChild(t,xs.EMPTY_NODE);return null!=u&&this.rangedFilter_.matches(u)?(null!=i&&i.trackChildChange(As(u.name,u.node)),n.updateImmediateChild(u.name,u.node)):n}}return n.isEmpty()?e:c&&o(l,a)>=0?(null!=i&&(i.trackChildChange(Ds(l.name,l.node)),i.trackChildChange(As(t,n))),s.updateImmediateChild(t,n).updateImmediateChild(l.name,xs.EMPTY_NODE)):e}}class Ms{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ps}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return Qn(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return Qn(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Yi}hasEnd(){return this.endSet_}getIndexEndValue(){return Qn(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return Qn(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Gi}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return Qn(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===ps}copy(){const e=new Ms;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function Fs(e){const t={};if(e.isDefault())return t;let n;if(e.index_===ps?n="$priority":e.index_===Ts?n="$value":e.index_===ts?n="$key":(Qn(e.index_ instanceof Es,"Unrecognized index type!"),n=e.index_.toString()),t.orderBy=mr(n),e.startSet_){const n=e.startAfterSet_?"startAfter":"startAt";t[n]=mr(e.indexStartValue_),e.startNameSet_&&(t[n]+=","+mr(e.indexStartName_))}if(e.endSet_){const n=e.endBeforeSet_?"endBefore":"endAt";t[n]=mr(e.indexEndValue_),e.endNameSet_&&(t[n]+=","+mr(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?t.limitToFirst=e.limit_:t.limitToLast=e.limit_),t}function Ls(e){const t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==ps&&(t.i=e.index_.toString()),t}class js extends Ao{constructor(e,t,n,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=r,this.log_=Ui("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:(Qn(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,n,r){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const o=js.getListenId_(e,n),s={};this.listens_[o]=s;const a=Fs(e._queryParams);this.restRequest_(i+".json",a,((e,t)=>{let a=t;if(404===e&&(a=null,e=null),null===e&&this.onDataUpdate_(i,a,!1,n),yr(this.listens_,o)===s){let t;t=e?401===e?"permission_denied":"rest_error:"+e:"ok",r(t,null)}}))}unlisten(e,t){const n=js.getListenId_(e,t);delete this.listens_[n]}get(e){const t=Fs(e._queryParams),n=e._path.toString(),r=new ur;return this.restRequest_(n+".json",t,((e,t)=>{let i=t;404===e&&(i=null,e=null),null===e?(this.onDataUpdate_(n,i,!1,null),r.resolve(i)):r.reject(new Error(i))})),r.promise}refreshAuthToken(e){}restRequest_(e,t={},n){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((([r,i])=>{r&&r.accessToken&&(t.auth=r.accessToken),i&&i.token&&(t.ac=i.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+function(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}(t);this.log_("Sending REST request for "+o);const s=new XMLHttpRequest;s.onreadystatechange=()=>{if(n&&4===s.readyState){this.log_("REST Response for "+o+" received. status:",s.status,"response:",s.responseText);let e=null;if(s.status>=200&&s.status<300){try{e=gr(s.responseText)}catch(e){Hi("Failed to parse JSON response for "+o+": "+s.responseText)}n(null,e)}else 401!==s.status&&404!==s.status&&Hi("Got unsuccessful REST response for "+o+" Status: "+s.status),n(s.status);n=null}},s.open("GET",o,!0),s.send()}))}}class zs{constructor(){this.rootNode_=xs.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function $s(){return{value:null,children:new Map}}function qs(e,t,n){if(qo(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{const r=Ro(t);e.children.has(r)||e.children.set(r,$s()),qs(e.children.get(r),t=Fo(t),n)}}function Us(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach(((e,n)=>{t(n,e)}))}(e,((e,r)=>{Us(r,new Oo(t.toString()+"/"+e),n)}))}class Bs{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&eo(this.last_,((e,n)=>{t[e]=t[e]-n})),this.last_=e,t}}class Ws{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Bs(e);const n=1e4+2e4*Math.random();oo(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const e=this.statsListener_.get(),t={};let n=!1;eo(e,((e,r)=>{r>0&&vr(this.statsToReport_,e)&&(t[e]=r,n=!0)})),n&&this.server_.reportStats(t),oo(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Hs;function Vs(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Hs||(Hs={}));class Ys{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=Hs.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(qo(this.path)){if(null!=this.affectedTree.value)return Qn(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new Oo(e));return new Ys(Po(),t,this.revert)}}return Qn(Ro(this.path)===e,"operationForChild called for unrelated child."),new Ys(Fo(this.path),this.affectedTree,this.revert)}}class Gs{constructor(e,t){this.source=e,this.path=t,this.type=Hs.LISTEN_COMPLETE}operationForChild(e){return qo(this.path)?new Gs(this.source,Po()):new Gs(this.source,Fo(this.path))}}class Ks{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=Hs.OVERWRITE}operationForChild(e){return qo(this.path)?new Ks(this.source,Po(),this.snap.getImmediateChild(e)):new Ks(this.source,Fo(this.path),this.snap)}}class Xs{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=Hs.MERGE}operationForChild(e){if(qo(this.path)){const t=this.children.subtree(new Oo(e));return t.isEmpty()?null:t.value?new Ks(this.source,Po(),t.value):new Xs(this.source,Po(),t)}return Qn(Ro(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Xs(this.source,Fo(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Js{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(qo(e))return this.isFullyInitialized()&&!this.filtered_;const t=Ro(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class Qs{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function Zs(e,t,n,r,i,o){const s=r.filter((e=>e.type===n));s.sort(((t,n)=>function(e,t,n){if(null==t.childName||null==n.childName)throw Zn("Should only compare child_ events.");const r=new Jo(t.childName,t.snapshotNode),i=new Jo(n.childName,n.snapshotNode);return e.index_.compare(r,i)}(e,t,n))),s.forEach((n=>{const r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,o);i.forEach((i=>{i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))}))}))}function ea(e,t){return{eventCache:e,serverCache:t}}function ta(e,t,n,r){return ea(new Js(t,n,r),e.serverCache)}function na(e,t,n,r){return ea(e.eventCache,new Js(t,n,r))}function ra(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function ia(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}let oa;class sa{constructor(e,t=(()=>(oa||(oa=new is(Xi)),oa))()){this.value=e,this.children=t}static fromObject(e){let t=new sa(null);return eo(e,((e,n)=>{t=t.set(new Oo(e),n)})),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:Po(),value:this.value};if(qo(e))return null;{const n=Ro(e),r=this.children.get(n);if(null!==r){const i=r.findRootMostMatchingPathAndValue(Fo(e),t);return null!=i?{path:$o(new Oo(n),i.path),value:i.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,(()=>!0))}subtree(e){if(qo(e))return this;{const t=Ro(e),n=this.children.get(t);return null!==n?n.subtree(Fo(e)):new sa(null)}}set(e,t){if(qo(e))return new sa(t,this.children);{const n=Ro(e),r=(this.children.get(n)||new sa(null)).set(Fo(e),t),i=this.children.insert(n,r);return new sa(this.value,i)}}remove(e){if(qo(e))return this.children.isEmpty()?new sa(null):new sa(null,this.children);{const t=Ro(e),n=this.children.get(t);if(n){const r=n.remove(Fo(e));let i;return i=r.isEmpty()?this.children.remove(t):this.children.insert(t,r),null===this.value&&i.isEmpty()?new sa(null):new sa(this.value,i)}return this}}get(e){if(qo(e))return this.value;{const t=Ro(e),n=this.children.get(t);return n?n.get(Fo(e)):null}}setTree(e,t){if(qo(e))return t;{const n=Ro(e),r=(this.children.get(n)||new sa(null)).setTree(Fo(e),t);let i;return i=r.isEmpty()?this.children.remove(n):this.children.insert(n,r),new sa(this.value,i)}}fold(e){return this.fold_(Po(),e)}fold_(e,t){const n={};return this.children.inorderTraversal(((r,i)=>{n[r]=i.fold_($o(e,r),t)})),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,Po(),t)}findOnPath_(e,t,n){const r=!!this.value&&n(t,this.value);if(r)return r;if(qo(e))return null;{const r=Ro(e),i=this.children.get(r);return i?i.findOnPath_(Fo(e),$o(t,r),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Po(),t)}foreachOnPath_(e,t,n){if(qo(e))return this;{this.value&&n(t,this.value);const r=Ro(e),i=this.children.get(r);return i?i.foreachOnPath_(Fo(e),$o(t,r),n):new sa(null)}}foreach(e){this.foreach_(Po(),e)}foreach_(e,t){this.children.inorderTraversal(((n,r)=>{r.foreach_($o(e,n),t)})),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal(((t,n)=>{n.value&&e(t,n.value)}))}}class aa{constructor(e){this.writeTree_=e}static empty(){return new aa(new sa(null))}}function la(e,t,n){if(qo(t))return new aa(new sa(n));{const r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){const i=r.path;let o=r.value;const s=Uo(i,t);return o=o.updateChild(s,n),new aa(e.writeTree_.set(i,o))}{const r=new sa(n),i=e.writeTree_.setTree(t,r);return new aa(i)}}}function ca(e,t,n){let r=e;return eo(n,((e,n)=>{r=la(r,$o(t,e),n)})),r}function ua(e,t){if(qo(t))return aa.empty();{const n=e.writeTree_.setTree(t,new sa(null));return new aa(n)}}function ha(e,t){return null!=fa(e,t)}function fa(e,t){const n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(Uo(n.path,t)):null}function da(e){const t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(ps,((e,n)=>{t.push(new Jo(e,n))})):e.writeTree_.children.inorderTraversal(((e,n)=>{null!=n.value&&t.push(new Jo(e,n.value))})),t}function pa(e,t){if(qo(t))return e;{const n=fa(e,t);return new aa(null!=n?new sa(n):e.writeTree_.subtree(t))}}function ga(e){return e.writeTree_.isEmpty()}function ma(e,t){return _a(Po(),e.writeTree_,t)}function _a(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);{let r=null;return t.children.inorderTraversal(((t,i)=>{".priority"===t?(Qn(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=_a($o(e,t),i,n)})),n.getChild(e).isEmpty()||null===r||(n=n.updateChild($o(e,".priority"),r)),n}}function va(e,t){return Aa(t,e)}function ya(e,t){if(e.snap)return Wo(e.path,t);for(const n in e.children)if(e.children.hasOwnProperty(n)&&Wo($o(e.path,n),t))return!0;return!1}function ba(e){return e.visible}function wa(e,t,n){let r=aa.empty();for(let i=0;i<e.length;++i){const o=e[i];if(t(o)){const e=o.path;let t;if(o.snap)Wo(n,e)?(t=Uo(n,e),r=la(r,t,o.snap)):Wo(e,n)&&(t=Uo(e,n),r=la(r,Po(),o.snap.getChild(t)));else{if(!o.children)throw Zn("WriteRecord should have .snap or .children");if(Wo(n,e))t=Uo(n,e),r=ca(r,t,o.children);else if(Wo(e,n))if(t=Uo(e,n),qo(t))r=ca(r,Po(),o.children);else{const e=yr(o.children,Ro(t));if(e){const n=e.getChild(Fo(t));r=la(r,Po(),n)}}}}}return r}function xa(e,t,n,r,i){if(r||i){const o=pa(e.visibleWrites,t);if(!i&&ga(o))return n;if(i||null!=n||ha(o,Po())){const o=function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(Wo(e.path,t)||Wo(t,e.path))};return ma(wa(e.allWrites,o,t),n||xs.EMPTY_NODE)}return null}{const r=fa(e.visibleWrites,t);if(null!=r)return r;{const r=pa(e.visibleWrites,t);return ga(r)?n:null!=n||ha(r,Po())?ma(r,n||xs.EMPTY_NODE):null}}}function Ca(e,t,n,r){return xa(e.writeTree,e.treePath,t,n,r)}function Sa(e,t){return function(e,t,n){let r=xs.EMPTY_NODE;const i=fa(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(ps,((e,t)=>{r=r.updateImmediateChild(e,t)})),r;if(n){const i=pa(e.visibleWrites,t);return n.forEachChild(ps,((e,t)=>{const n=ma(pa(i,new Oo(e)),t);r=r.updateImmediateChild(e,n)})),da(i).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}return da(pa(e.visibleWrites,t)).forEach((e=>{r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function ka(e,t,n,r){return function(e,t,n,r,i){Qn(r||i,"Either existingEventSnap or existingServerSnap must exist");const o=$o(t,n);if(ha(e.visibleWrites,o))return null;{const t=pa(e.visibleWrites,o);return ga(t)?i.getChild(n):ma(t,i.getChild(n))}}(e.writeTree,e.treePath,t,n,r)}function Ea(e,t){return function(e,t){return fa(e.visibleWrites,t)}(e.writeTree,$o(e.treePath,t))}function Ta(e,t,n){return function(e,t,n,r){const i=$o(t,n),o=fa(e.visibleWrites,i);return null!=o?o:r.isCompleteForChild(n)?ma(pa(e.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(e.writeTree,e.treePath,t,n)}function Ia(e,t){return Aa($o(e.treePath,t),e.writeTree)}function Aa(e,t){return{treePath:e,writeTree:t}}class Da{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,n=e.childName;Qn("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),Qn(".priority"!==n,"Only non-priority child changes can be tracked.");const r=this.changeMap.get(n);if(r){const i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,Ns(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,Ds(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,As(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw Zn("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,Ns(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}const Na=new class{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}};class Oa{constructor(e,t,n=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const t=null!=this.optCompleteServerCache_?new Js(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Ta(this.writes_,e,t)}}getChildAfterChild(e,t,n){const r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:ia(this.viewCache_),i=function(e,t,n,r,i,o){return function(e,t,n,r,i,o,s){let a;const l=pa(e.visibleWrites,t),c=fa(l,Po());if(null!=c)a=c;else{if(null==n)return[];a=ma(l,n)}if(a=a.withIndex(s),a.isEmpty()||a.isLeafNode())return[];{const e=[],t=s.getCompare(),n=o?a.getReverseIteratorFrom(r,s):a.getIteratorFrom(r,s);let l=n.getNext();for(;l&&e.length<i;)0!==t(l,r)&&e.push(l),l=n.getNext();return e}}(e.writeTree,e.treePath,t,n,r,i,o)}(this.writes_,r,t,1,n,e);return 0===i.length?null:i[0]}}function Pa(e,t,n,r,i,o){const s=t.eventCache;if(null!=Ea(r,n))return t;{let a,l;if(qo(n))if(Qn(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){const n=ia(t),i=Sa(r,n instanceof xs?n:xs.EMPTY_NODE);a=e.filter.updateFullNode(t.eventCache.getNode(),i,o)}else{const n=Ca(r,ia(t));a=e.filter.updateFullNode(t.eventCache.getNode(),n,o)}else{const c=Ro(n);if(".priority"===c){Qn(1===Mo(n),"Can't have a priority with additional path components");const i=s.getNode();l=t.serverCache.getNode();const o=ka(r,n,i,l);a=null!=o?e.filter.updatePriority(i,o):s.getNode()}else{const u=Fo(n);let h;if(s.isCompleteForChild(c)){l=t.serverCache.getNode();const e=ka(r,n,s.getNode(),l);h=null!=e?s.getNode().getImmediateChild(c).updateChild(u,e):s.getNode().getImmediateChild(c)}else h=Ta(r,c,t.serverCache);a=null!=h?e.filter.updateChild(s.getNode(),c,h,u,i,o):s.getNode()}}return ta(t,a,s.isFullyInitialized()||qo(n),e.filter.filtersNodes())}}function Ra(e,t,n,r,i,o,s,a){const l=t.serverCache;let c;const u=s?e.filter:e.filter.getIndexedFilter();if(qo(n))c=u.updateFullNode(l.getNode(),r,null);else if(u.filtersNodes()&&!l.isFiltered()){const e=l.getNode().updateChild(n,r);c=u.updateFullNode(l.getNode(),e,null)}else{const e=Ro(n);if(!l.isCompleteForPath(n)&&Mo(n)>1)return t;const i=Fo(n),o=l.getNode().getImmediateChild(e).updateChild(i,r);c=".priority"===e?u.updatePriority(l.getNode(),o):u.updateChild(l.getNode(),e,o,i,Na,null)}const h=na(t,c,l.isFullyInitialized()||qo(n),u.filtersNodes());return Pa(e,h,n,i,new Oa(i,h,o),a)}function Ma(e,t,n,r,i,o,s){const a=t.eventCache;let l,c;const u=new Oa(i,t,o);if(qo(n))c=e.filter.updateFullNode(t.eventCache.getNode(),r,s),l=ta(t,c,!0,e.filter.filtersNodes());else{const i=Ro(n);if(".priority"===i)c=e.filter.updatePriority(t.eventCache.getNode(),r),l=ta(t,c,a.isFullyInitialized(),a.isFiltered());else{const o=Fo(n),c=a.getNode().getImmediateChild(i);let h;if(qo(o))h=r;else{const e=u.getCompleteChild(i);h=null!=e?".priority"===Lo(o)&&e.getChild(zo(o)).isEmpty()?e:e.updateChild(o,r):xs.EMPTY_NODE}l=c.equals(h)?t:ta(t,e.filter.updateChild(a.getNode(),i,h,o,u,s),a.isFullyInitialized(),e.filter.filtersNodes())}}return l}function Fa(e,t){return e.eventCache.isCompleteForChild(t)}function La(e,t,n){return n.foreach(((e,n)=>{t=t.updateChild(e,n)})),t}function ja(e,t,n,r,i,o,s,a){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let l,c=t;l=qo(n)?r:new sa(null).setTree(n,r);const u=t.serverCache.getNode();return l.children.inorderTraversal(((n,r)=>{if(u.hasChild(n)){const l=La(0,t.serverCache.getNode().getImmediateChild(n),r);c=Ra(e,c,new Oo(n),l,i,o,s,a)}})),l.children.inorderTraversal(((n,r)=>{const l=!t.serverCache.isCompleteForChild(n)&&null===r.value;if(!u.hasChild(n)&&!l){const l=La(0,t.serverCache.getNode().getImmediateChild(n),r);c=Ra(e,c,new Oo(n),l,i,o,s,a)}})),c}class za{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const n=this.query_._queryParams,r=new Os(n.getIndex()),i=(o=n).loadsAllData()?new Os(o.getIndex()):o.hasLimit()?new Rs(o):new Ps(o);var o;this.processor_=function(e){return{filter:e}}(i);const s=t.serverCache,a=t.eventCache,l=r.updateFullNode(xs.EMPTY_NODE,s.getNode(),null),c=i.updateFullNode(xs.EMPTY_NODE,a.getNode(),null),u=new Js(l,s.isFullyInitialized(),r.filtersNodes()),h=new Js(c,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=ea(h,u),this.eventGenerator_=new Qs(this.query_)}get query(){return this.query_}}function $a(e,t){const n=ia(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!qo(t)&&!n.getImmediateChild(Ro(t)).isEmpty())?n.getChild(t):null}function qa(e){return 0===e.eventRegistrations_.length}function Ua(e,t,n){const r=[];if(n){Qn(null==t,"A cancel should cancel all event registrations.");const i=e.query._path;e.eventRegistrations_.forEach((e=>{const t=e.createCancelEvent(n,i);t&&r.push(t)}))}if(t){let n=[];for(let r=0;r<e.eventRegistrations_.length;++r){const i=e.eventRegistrations_[r];if(i.matches(t)){if(t.hasAnyCallback()){n=n.concat(e.eventRegistrations_.slice(r+1));break}}else n.push(i)}e.eventRegistrations_=n}else e.eventRegistrations_=[];return r}function Ba(e,t,n,r){t.type===Hs.MERGE&&null!==t.source.queryId&&(Qn(ia(e.viewCache_),"We should always have a full cache before handling merges"),Qn(ra(e.viewCache_),"Missing event cache, even though we have a server cache"));const i=e.viewCache_,o=function(e,t,n,r,i){const o=new Da;let s,a;if(n.type===Hs.OVERWRITE){const l=n;l.source.fromUser?s=Ma(e,t,l.path,l.snap,r,i,o):(Qn(l.source.fromServer,"Unknown source."),a=l.source.tagged||t.serverCache.isFiltered()&&!qo(l.path),s=Ra(e,t,l.path,l.snap,r,i,a,o))}else if(n.type===Hs.MERGE){const l=n;l.source.fromUser?s=function(e,t,n,r,i,o,s){let a=t;return r.foreach(((r,l)=>{const c=$o(n,r);Fa(t,Ro(c))&&(a=Ma(e,a,c,l,i,o,s))})),r.foreach(((r,l)=>{const c=$o(n,r);Fa(t,Ro(c))||(a=Ma(e,a,c,l,i,o,s))})),a}(e,t,l.path,l.children,r,i,o):(Qn(l.source.fromServer,"Unknown source."),a=l.source.tagged||t.serverCache.isFiltered(),s=ja(e,t,l.path,l.children,r,i,a,o))}else if(n.type===Hs.ACK_USER_WRITE){const a=n;s=a.revert?function(e,t,n,r,i,o){let s;if(null!=Ea(r,n))return t;{const a=new Oa(r,t,i),l=t.eventCache.getNode();let c;if(qo(n)||".priority"===Ro(n)){let n;if(t.serverCache.isFullyInitialized())n=Ca(r,ia(t));else{const e=t.serverCache.getNode();Qn(e instanceof xs,"serverChildren would be complete if leaf node"),n=Sa(r,e)}c=e.filter.updateFullNode(l,n,o)}else{const i=Ro(n);let u=Ta(r,i,t.serverCache);null==u&&t.serverCache.isCompleteForChild(i)&&(u=l.getImmediateChild(i)),c=null!=u?e.filter.updateChild(l,i,u,Fo(n),a,o):t.eventCache.getNode().hasChild(i)?e.filter.updateChild(l,i,xs.EMPTY_NODE,Fo(n),a,o):l,c.isEmpty()&&t.serverCache.isFullyInitialized()&&(s=Ca(r,ia(t)),s.isLeafNode()&&(c=e.filter.updateFullNode(c,s,o)))}return s=t.serverCache.isFullyInitialized()||null!=Ea(r,Po()),ta(t,c,s,e.filter.filtersNodes())}}(e,t,a.path,r,i,o):function(e,t,n,r,i,o,s){if(null!=Ea(i,n))return t;const a=t.serverCache.isFiltered(),l=t.serverCache;if(null!=r.value){if(qo(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return Ra(e,t,n,l.getNode().getChild(n),i,o,a,s);if(qo(n)){let r=new sa(null);return l.getNode().forEachChild(ts,((e,t)=>{r=r.set(new Oo(e),t)})),ja(e,t,n,r,i,o,a,s)}return t}{let c=new sa(null);return r.foreach(((e,t)=>{const r=$o(n,e);l.isCompleteForPath(r)&&(c=c.set(e,l.getNode().getChild(r)))})),ja(e,t,n,c,i,o,a,s)}}(e,t,a.path,a.affectedTree,r,i,o)}else{if(n.type!==Hs.LISTEN_COMPLETE)throw Zn("Unknown operation type: "+n.type);s=function(e,t,n,r,i){const o=t.serverCache;return Pa(e,na(t,o.getNode(),o.isFullyInitialized()||qo(n),o.isFiltered()),n,r,Na,i)}(e,t,n.path,r,o)}const l=o.getChanges();return function(e,t,n){const r=t.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=ra(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(Is(ra(t)))}}(t,s,l),{viewCache:s,changes:l}}(e.processor_,i,t,n,r);var s,a;return s=e.processor_,a=o.viewCache,Qn(a.eventCache.getNode().isIndexed(s.filter.getIndex()),"Event snap not indexed"),Qn(a.serverCache.getNode().isIndexed(s.filter.getIndex()),"Server snap not indexed"),Qn(o.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=o.viewCache,Wa(e,o.changes,o.viewCache.eventCache.getNode(),null)}function Wa(e,t,n,r){const i=r?[r]:e.eventRegistrations_;return function(e,t,n,r){const i=[],o=[];return t.forEach((t=>{var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&o.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),Zs(e,i,"child_removed",t,r,n),Zs(e,i,"child_added",t,r,n),Zs(e,i,"child_moved",o,r,n),Zs(e,i,"child_changed",t,r,n),Zs(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,i)}let Ha,Va;class Ya{constructor(){this.views=new Map}}function Ga(e,t,n,r){const i=t.source.queryId;if(null!==i){const o=e.views.get(i);return Qn(null!=o,"SyncTree gave us an op for an invalid query."),Ba(o,t,n,r)}{let i=[];for(const o of e.views.values())i=i.concat(Ba(o,t,n,r));return i}}function Ka(e,t,n,r,i){const o=t._queryIdentifier,s=e.views.get(o);if(!s){let e=Ca(n,i?r:null),o=!1;e?o=!0:r instanceof xs?(e=Sa(n,r),o=!1):(e=xs.EMPTY_NODE,o=!1);const s=ea(new Js(e,o,!1),new Js(r,i,!1));return new za(t,s)}return s}function Xa(e){const t=[];for(const n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function Ja(e,t){let n=null;for(const r of e.views.values())n=n||$a(r,t);return n}function Qa(e,t){if(t._queryParams.loadsAllData())return tl(e);{const n=t._queryIdentifier;return e.views.get(n)}}function Za(e,t){return null!=Qa(e,t)}function el(e){return null!=tl(e)}function tl(e){for(const t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}let nl=1;class rl{constructor(e){this.listenProvider_=e,this.syncPointTree_=new sa(null),this.pendingWriteTree_={visibleWrites:aa.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function il(e,t,n,r,i){return function(e,t,n,r,i){Qn(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=la(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?hl(e,new Ks({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function ol(e,t,n=!1){const r=function(e,t){for(let n=0;n<e.allWrites.length;n++){const r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(function(e,t){const n=e.allWrites.findIndex((e=>e.writeId===t));Qn(n>=0,"removeWrite called with nonexistent writeId.");const r=e.allWrites[n];e.allWrites.splice(n,1);let i=r.visible,o=!1,s=e.allWrites.length-1;for(;i&&s>=0;){const t=e.allWrites[s];t.visible&&(s>=n&&ya(t,r.path)?i=!1:Wo(r.path,t.path)&&(o=!0)),s--}return!!i&&(o?(function(e){e.visibleWrites=wa(e.allWrites,ba,Po()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0):(r.snap?e.visibleWrites=ua(e.visibleWrites,r.path):eo(r.children,(t=>{e.visibleWrites=ua(e.visibleWrites,$o(r.path,t))})),!0))}(e.pendingWriteTree_,t)){let t=new sa(null);return null!=r.snap?t=t.set(Po(),!0):eo(r.children,(e=>{t=t.set(new Oo(e),!0)})),hl(e,new Ys(r.path,t,n))}return[]}function sl(e,t,n){return hl(e,new Ks({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function al(e,t,n,r,i=!1){const o=t._path,s=e.syncPointTree_.get(o);let a=[];if(s&&("default"===t._queryIdentifier||Za(s,t))){const l=function(e,t,n,r){const i=t._queryIdentifier,o=[];let s=[];const a=el(e);if("default"===i)for(const[t,i]of e.views.entries())s=s.concat(Ua(i,n,r)),qa(i)&&(e.views.delete(t),i.query._queryParams.loadsAllData()||o.push(i.query));else{const t=e.views.get(i);t&&(s=s.concat(Ua(t,n,r)),qa(t)&&(e.views.delete(i),t.query._queryParams.loadsAllData()||o.push(t.query)))}return a&&!el(e)&&o.push(new(Qn(Ha,"Reference.ts has not been loaded"),Ha)(t._repo,t._path)),{removed:o,events:s}}(s,t,n,r);0===s.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(o));const c=l.removed;if(a=l.events,!i){const n=-1!==c.findIndex((e=>e._queryParams.loadsAllData())),i=e.syncPointTree_.findOnPath(o,((e,t)=>el(t)));if(n&&!i){const t=e.syncPointTree_.subtree(o);if(!t.isEmpty()){const n=function(e){return e.fold(((e,t,n)=>{if(t&&el(t))return[tl(t)];{let e=[];return t&&(e=Xa(t)),eo(n,((t,n)=>{e=e.concat(n)})),e}}))}(t);for(let t=0;t<n.length;++t){const r=n[t],i=r.query,o=pl(e,r);e.listenProvider_.startListening(bl(i),gl(e,i),o.hashFn,o.onComplete)}}}if(!i&&c.length>0&&!r)if(n){const n=null;e.listenProvider_.stopListening(bl(t),n)}else c.forEach((t=>{const n=e.queryToTagMap.get(ml(t));e.listenProvider_.stopListening(bl(t),n)}))}!function(e,t){for(let n=0;n<t.length;++n){const r=t[n];if(!r._queryParams.loadsAllData()){const t=ml(r),n=e.queryToTagMap.get(t);e.queryToTagMap.delete(t),e.tagToQueryMap.delete(n)}}}(e,c)}return a}function ll(e,t,n,r){const i=_l(e,r);if(null!=i){const r=vl(i),o=r.path,s=r.queryId,a=Uo(o,t);return yl(e,o,new Ks(Vs(s),a,n))}return[]}function cl(e,t,n,r=!1){const i=t._path;let o=null,s=!1;e.syncPointTree_.foreachOnPath(i,((e,t)=>{const n=Uo(e,i);o=o||Ja(t,n),s=s||el(t)}));let a,l=e.syncPointTree_.get(i);l?(s=s||el(l),o=o||Ja(l,Po())):(l=new Ya,e.syncPointTree_=e.syncPointTree_.set(i,l)),null!=o?a=!0:(a=!1,o=xs.EMPTY_NODE,e.syncPointTree_.subtree(i).foreachChild(((e,t)=>{const n=Ja(t,Po());n&&(o=o.updateImmediateChild(e,n))})));const c=Za(l,t);if(!c&&!t._queryParams.loadsAllData()){const n=ml(t);Qn(!e.queryToTagMap.has(n),"View does not exist, but we have a tag");const r=nl++;e.queryToTagMap.set(n,r),e.tagToQueryMap.set(r,n)}let u=function(e,t,n,r,i,o){const s=Ka(e,t,r,i,o);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,s),function(e,t){e.eventRegistrations_.push(t)}(s,n),function(e,t){const n=e.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(ps,((e,t)=>{r.push(As(e,t))})),n.isFullyInitialized()&&r.push(Is(n.getNode())),Wa(e,r,n.getNode(),t)}(s,n)}(l,t,n,va(e.pendingWriteTree_,i),o,a);if(!c&&!s&&!r){const n=Qa(l,t);u=u.concat(function(e,t,n){const r=t._path,i=gl(e,t),o=pl(e,n),s=e.listenProvider_.startListening(bl(t),i,o.hashFn,o.onComplete),a=e.syncPointTree_.subtree(r);if(i)Qn(!el(a.value),"If we're adding a query, it shouldn't be shadowed");else{const t=a.fold(((e,t,n)=>{if(!qo(e)&&t&&el(t))return[tl(t).query];{let e=[];return t&&(e=e.concat(Xa(t).map((e=>e.query)))),eo(n,((t,n)=>{e=e.concat(n)})),e}}));for(let n=0;n<t.length;++n){const r=t[n];e.listenProvider_.stopListening(bl(r),gl(e,r))}}return s}(e,t,n))}return u}function ul(e,t,n){const r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,((e,n)=>{const r=Ja(n,Uo(e,t));if(r)return r}));return xa(r,t,i,n,!0)}function hl(e,t){return fl(t,e.syncPointTree_,null,va(e.pendingWriteTree_,Po()))}function fl(e,t,n,r){if(qo(e.path))return dl(e,t,n,r);{const i=t.get(Po());null==n&&null!=i&&(n=Ja(i,Po()));let o=[];const s=Ro(e.path),a=e.operationForChild(s),l=t.children.get(s);if(l&&a){const e=n?n.getImmediateChild(s):null,t=Ia(r,s);o=o.concat(fl(a,l,e,t))}return i&&(o=o.concat(Ga(i,e,r,n))),o}}function dl(e,t,n,r){const i=t.get(Po());null==n&&null!=i&&(n=Ja(i,Po()));let o=[];return t.children.inorderTraversal(((t,i)=>{const s=n?n.getImmediateChild(t):null,a=Ia(r,t),l=e.operationForChild(t);l&&(o=o.concat(dl(l,i,s,a)))})),i&&(o=o.concat(Ga(i,e,r,n))),o}function pl(e,t){const n=t.query,r=gl(e,n);return{hashFn:()=>{const e=function(e){return e.viewCache_.serverCache.getNode()}(t)||xs.EMPTY_NODE;return e.hash()},onComplete:t=>{if("ok"===t)return r?function(e,t,n){const r=_l(e,n);if(r){const n=vl(r),i=n.path,o=n.queryId,s=Uo(i,t);return yl(e,i,new Gs(Vs(o),s))}return[]}(e,n._path,r):function(e,t){return hl(e,new Gs({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);{const r=function(e,t){let n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");const r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}(t,n);return al(e,n,null,r)}}}}function gl(e,t){const n=ml(t);return e.queryToTagMap.get(n)}function ml(e){return e._path.toString()+"$"+e._queryIdentifier}function _l(e,t){return e.tagToQueryMap.get(t)}function vl(e){const t=e.indexOf("$");return Qn(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new Oo(e.substr(0,t))}}function yl(e,t,n){const r=e.syncPointTree_.get(t);return Qn(r,"Missing sync point for query tag that we're tracking"),Ga(r,n,va(e.pendingWriteTree_,t),null)}function bl(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(Qn(Va,"Reference.ts has not been loaded"),Va)(e._repo,e._path):e}class wl{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new wl(t)}node(){return this.node_}}class xl{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=$o(this.path_,e);return new xl(this.syncTree_,t)}node(){return ul(this.syncTree_,this.path_)}}const Cl=function(e){return(e=e||{}).timestamp=e.timestamp||(new Date).getTime(),e},Sl=function(e,t,n){return e&&"object"==typeof e?(Qn(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?kl(e[".sv"],t,n):"object"==typeof e[".sv"]?El(e[".sv"],t):void Qn(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},kl=function(e,t,n){if("timestamp"===e)return n.timestamp;Qn(!1,"Unexpected server value: "+e)},El=function(e,t,n){e.hasOwnProperty("increment")||Qn(!1,"Unexpected server value: "+JSON.stringify(e,null,2));const r=e.increment;"number"!=typeof r&&Qn(!1,"Unexpected increment value: "+r);const i=t.node();if(Qn(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const o=i.getValue();return"number"!=typeof o?r:o+r},Tl=function(e,t,n,r){return Al(t,new xl(n,e),r)},Il=function(e,t,n){return Al(e,new wl(t),n)};function Al(e,t,n){const r=e.getPriority().val(),i=Sl(r,t.getImmediateChild(".priority"),n);let o;if(e.isLeafNode()){const r=e,o=Sl(r.getValue(),t,n);return o!==r.getValue()||i!==r.getPriority().val()?new ds(o,ks(i)):e}{const r=e;return o=r,i!==r.getPriority().val()&&(o=o.updatePriority(new ds(i))),r.forEachChild(ps,((e,r)=>{const i=Al(r,t.getImmediateChild(e),n);i!==r&&(o=o.updateImmediateChild(e,i))})),o}}class Dl{constructor(e="",t=null,n={children:{},childCount:0}){this.name=e,this.parent=t,this.node=n}}function Nl(e,t){let n=t instanceof Oo?t:new Oo(t),r=e,i=Ro(n);for(;null!==i;){const e=yr(r.node.children,i)||{children:{},childCount:0};r=new Dl(i,r,e),n=Fo(n),i=Ro(n)}return r}function Ol(e){return e.node.value}function Pl(e,t){e.node.value=t,jl(e)}function Rl(e){return e.node.childCount>0}function Ml(e,t){eo(e.node.children,((n,r)=>{t(new Dl(n,e,r))}))}function Fl(e,t,n,r){n&&!r&&t(e),Ml(e,(e=>{Fl(e,t,!0,r)})),n&&r&&t(e)}function Ll(e){return new Oo(null===e.parent?e.name:Ll(e.parent)+"/"+e.name)}function jl(e){null!==e.parent&&function(e,t,n){const r=function(e){return void 0===Ol(e)&&!Rl(e)}(n),i=vr(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,jl(e)):r||i||(e.node.children[t]=n.node,e.node.childCount++,jl(e))}(e.parent,e.name,e)}const zl=/[\[\].#$\/\u0000-\u001F\u007F]/,$l=/[\[\].#$\u0000-\u001F\u007F]/,ql=10485760,Ul=function(e){return"string"==typeof e&&0!==e.length&&!zl.test(e)},Bl=function(e){return"string"==typeof e&&0!==e.length&&!$l.test(e)},Wl=function(e,t,n,r){r&&void 0===t||Hl(kr(e,"value"),t,n)},Hl=function(e,t,n){const r=n instanceof Oo?new Ho(n,e):n;if(void 0===t)throw new Error(e+"contains undefined "+Yo(r));if("function"==typeof t)throw new Error(e+"contains a function "+Yo(r)+" with contents = "+t.toString());if(Vi(t))throw new Error(e+"contains "+t.toString()+" "+Yo(r));if("string"==typeof t&&t.length>ql/3&&Er(t)>ql)throw new Error(e+"contains a string greater than "+ql+" utf8 bytes "+Yo(r)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){let n=!1,i=!1;if(eo(t,((t,o)=>{if(".value"===t)n=!0;else if(".priority"!==t&&".sv"!==t&&(i=!0,!Ul(t)))throw new Error(e+" contains an invalid key ("+t+") "+Yo(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=Er(t),Vo(e)}(r,t),Hl(e,o,r),function(e){const t=e.parts_.pop();e.byteLength_-=Er(t),e.parts_.length>0&&(e.byteLength_-=1)}(r)})),n&&i)throw new Error(e+' contains ".value" child '+Yo(r)+" in addition to actual children.")}},Vl=function(e,t,n,r){if(!(r&&void 0===n||Bl(n)))throw new Error(kr(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Yl=function(e,t,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Vl(e,t,n,r)},Gl=function(e,t){if(".info"===Ro(t))throw new Error(e+" failed = Can't modify data under /.info/")};class Kl{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Xl(e,t){let n=null;for(let r=0;r<t.length;r++){const i=t[r],o=i.getPath();null===n||Bo(o,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:o}),n.events.push(i)}n&&e.eventLists_.push(n)}function Jl(e,t,n){Xl(e,n),function(e,t){e.recursionDepth_++;let n=!0;for(let r=0;r<e.eventLists_.length;r++){const i=e.eventLists_[r];i&&(t(i.path)?(Ql(e.eventLists_[r]),e.eventLists_[r]=null):n=!1)}n&&(e.eventLists_=[]),e.recursionDepth_--}(e,(e=>Wo(e,t)||Wo(t,e)))}function Ql(e){for(let t=0;t<e.events.length;t++){const n=e.events[t];if(null!==n){e.events[t]=null;const r=n.getEventRunner();zi&&qi("event: "+n.toString()),io(r)}}}const Zl=25;class ec{constructor(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Kl,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=$s(),this.transactionQueueTree_=new Dl,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function tc(e,t,n){if(e.stats_=bo(e.repoInfo_),e.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new js(e.repoInfo_,((t,n,r,i)=>{ic(e,t,n,r,i)}),e.authTokenProvider_,e.appCheckProvider_),setTimeout((()=>oc(e,!0)),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{mr(n)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}e.persistentConnection_=new Xo(e.repoInfo_,t,((t,n,r,i)=>{ic(e,t,n,r,i)}),(t=>{oc(e,t)}),(t=>{!function(e,t){eo(t,((t,n)=>{sc(e,t,n)}))}(e,t)}),e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((t=>{e.server_.refreshAuthToken(t)})),e.appCheckProvider_.addTokenChangeListener((t=>{e.server_.refreshAppCheckToken(t.token)})),e.statsReporter_=function(t,n){const r=t.toString();return yo[r]||(yo[r]=new Ws(e.stats_,e.server_)),yo[r]}(e.repoInfo_),e.infoData_=new zs,e.infoSyncTree_=new rl({startListening:(t,n,r,i)=>{let o=[];const s=e.infoData_.getNode(t._path);return s.isEmpty()||(o=sl(e.infoSyncTree_,t._path,s),setTimeout((()=>{i("ok")}),0)),o},stopListening:()=>{}}),sc(e,"connected",!1),e.serverSyncTree_=new rl({startListening:(t,n,r,i)=>(e.server_.listen(t,r,n,((n,r)=>{const o=i(n,r);Jl(e.eventQueue_,t._path,o)})),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}function nc(e){const t=e.infoData_.getNode(new Oo(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function rc(e){return Cl({timestamp:nc(e)})}function ic(e,t,n,r,i){e.dataUpdateCount++;const o=new Oo(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let s=[];if(i)if(r){const t=wr(n,(e=>ks(e)));s=function(e,t,n,r){const i=_l(e,r);if(i){const r=vl(i),o=r.path,s=r.queryId,a=Uo(o,t),l=sa.fromObject(n);return yl(e,o,new Xs(Vs(s),a,l))}return[]}(e.serverSyncTree_,o,t,i)}else{const t=ks(n);s=ll(e.serverSyncTree_,o,t,i)}else if(r){const t=wr(n,(e=>ks(e)));s=function(e,t,n){const r=sa.fromObject(n);return hl(e,new Xs({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,o,t)}else{const t=ks(n);s=sl(e.serverSyncTree_,o,t)}let a=o;s.length>0&&(a=fc(e,o)),Jl(e.eventQueue_,a,s)}function oc(e,t){sc(e,"connected",t),!1===t&&function(e){cc(e,"onDisconnectEvents");const t=rc(e),n=$s();Us(e.onDisconnect_,Po(),((r,i)=>{const o=Tl(r,i,e.serverSyncTree_,t);qs(n,r,o)}));let r=[];Us(n,Po(),((t,n)=>{r=r.concat(sl(e.serverSyncTree_,t,n));const i=_c(e,t);fc(e,i)})),e.onDisconnect_=$s(),Jl(e.eventQueue_,Po(),r)}(e)}function sc(e,t,n){const r=new Oo("/.info/"+t),i=ks(n);e.infoData_.updateSnapshot(r,i);const o=sl(e.infoSyncTree_,r,i);Jl(e.eventQueue_,r,o)}function ac(e){return e.nextWriteId_++}function lc(e,t,n,r,i){cc(e,"set",{path:t.toString(),value:n,priority:r});const o=rc(e),s=ks(n,r),a=ul(e.serverSyncTree_,t),l=Il(s,a,o),c=ac(e),u=il(e.serverSyncTree_,t,l,c,!0);Xl(e.eventQueue_,u),e.server_.put(t.toString(),s.val(!0),((n,r)=>{const o="ok"===n;o||Hi("set at "+t+" failed: "+n);const s=ol(e.serverSyncTree_,c,!o);Jl(e.eventQueue_,t,s),function(e,t,n,r){t&&io((()=>{if("ok"===n)t(null);else{const e=(n||"error").toUpperCase();let i=e;r&&(i+=": "+r);const o=new Error(i);o.code=e,t(o)}}))}(0,i,n,r)}));const h=_c(e,t);fc(e,h),Jl(e.eventQueue_,h,[])}function cc(e,...t){let n="";e.persistentConnection_&&(n=e.persistentConnection_.id+":"),qi(n,...t)}function uc(e,t,n){return ul(e.serverSyncTree_,t,n)||xs.EMPTY_NODE}function hc(e,t=e.transactionQueueTree_){if(t||mc(e,t),Ol(t)){const n=pc(e,t);Qn(n.length>0,"Sending zero length transaction queue"),n.every((e=>0===e.status))&&function(e,t,n){const r=n.map((e=>e.currentWriteId)),i=uc(e,t,r);let o=i;const s=i.hash();for(let e=0;e<n.length;e++){const r=n[e];Qn(0===r.status,"tryToSendTransactionQueue_: items in queue should all be run."),r.status=1,r.retryCount++;const i=Uo(t,r.path);o=o.updateChild(i,r.currentOutputSnapshotRaw)}const a=o.val(!0),l=t;e.server_.put(l.toString(),a,(r=>{cc(e,"transaction put response",{path:l.toString(),status:r});let i=[];if("ok"===r){const r=[];for(let t=0;t<n.length;t++)n[t].status=2,i=i.concat(ol(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&r.push((()=>n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved))),n[t].unwatcher();mc(e,Nl(e.transactionQueueTree_,t)),hc(e,e.transactionQueueTree_),Jl(e.eventQueue_,t,i);for(let e=0;e<r.length;e++)io(r[e])}else{if("datastale"===r)for(let e=0;e<n.length;e++)3===n[e].status?n[e].status=4:n[e].status=0;else{Hi("transaction at "+l.toString()+" failed: "+r);for(let e=0;e<n.length;e++)n[e].status=4,n[e].abortReason=r}fc(e,t)}}),s)}(e,Ll(t),n)}else Rl(t)&&Ml(t,(t=>{hc(e,t)}))}function fc(e,t){const n=dc(e,t),r=Ll(n);return function(e,t,n){if(0===t.length)return;const r=[];let i=[];const o=t.filter((e=>0===e.status)).map((e=>e.currentWriteId));for(let a=0;a<t.length;a++){const l=t[a],c=Uo(n,l.path);let u,h=!1;if(Qn(null!==c,"rerunTransactionsUnderNode_: relativePath should not be null."),4===l.status)h=!0,u=l.abortReason,i=i.concat(ol(e.serverSyncTree_,l.currentWriteId,!0));else if(0===l.status)if(l.retryCount>=Zl)h=!0,u="maxretry",i=i.concat(ol(e.serverSyncTree_,l.currentWriteId,!0));else{const n=uc(e,l.path,o);l.currentInputSnapshot=n;const r=t[a].update(n.val());if(void 0!==r){Hl("transaction failed: Data returned ",r,l.path);let t=ks(r);"object"==typeof r&&null!=r&&vr(r,".priority")||(t=t.updatePriority(n.getPriority()));const s=l.currentWriteId,a=rc(e),c=Il(t,n,a);l.currentOutputSnapshotRaw=t,l.currentOutputSnapshotResolved=c,l.currentWriteId=ac(e),o.splice(o.indexOf(s),1),i=i.concat(il(e.serverSyncTree_,l.path,c,l.currentWriteId,l.applyLocally)),i=i.concat(ol(e.serverSyncTree_,s,!0))}else h=!0,u="nodata",i=i.concat(ol(e.serverSyncTree_,l.currentWriteId,!0))}Jl(e.eventQueue_,n,i),i=[],h&&(t[a].status=2,s=t[a].unwatcher,setTimeout(s,Math.floor(0)),t[a].onComplete&&("nodata"===u?r.push((()=>t[a].onComplete(null,!1,t[a].currentInputSnapshot))):r.push((()=>t[a].onComplete(new Error(u),!1,null)))))}var s;mc(e,e.transactionQueueTree_);for(let e=0;e<r.length;e++)io(r[e]);hc(e,e.transactionQueueTree_)}(e,pc(e,n),r),r}function dc(e,t){let n,r=e.transactionQueueTree_;for(n=Ro(t);null!==n&&void 0===Ol(r);)r=Nl(r,n),n=Ro(t=Fo(t));return r}function pc(e,t){const n=[];return gc(e,t,n),n.sort(((e,t)=>e.order-t.order)),n}function gc(e,t,n){const r=Ol(t);if(r)for(let e=0;e<r.length;e++)n.push(r[e]);Ml(t,(t=>{gc(e,t,n)}))}function mc(e,t){const n=Ol(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,Pl(t,n.length>0?n:void 0)}Ml(t,(t=>{mc(e,t)}))}function _c(e,t){const n=Ll(dc(e,t)),r=Nl(e.transactionQueueTree_,t);return function(e,t,n){let r=e.parent;for(;null!==r;){if(t(r))return!0;r=r.parent}}(r,(t=>{vc(e,t)})),vc(e,r),Fl(r,(t=>{vc(e,t)})),n}function vc(e,t){const n=Ol(t);if(n){const r=[];let i=[],o=-1;for(let t=0;t<n.length;t++)3===n[t].status||(1===n[t].status?(Qn(o===t-1,"All SENT items should be at beginning of queue."),o=t,n[t].status=3,n[t].abortReason="set"):(Qn(0===n[t].status,"Unexpected transaction status in abort"),n[t].unwatcher(),i=i.concat(ol(e.serverSyncTree_,n[t].currentWriteId,!0)),n[t].onComplete&&r.push(n[t].onComplete.bind(null,new Error("set"),!1,null))));-1===o?Pl(t,void 0):n.length=o+1,Jl(e.eventQueue_,Ll(t),i);for(let e=0;e<r.length;e++)io(r[e])}}const yc=function(e,t){const n=bc(e),r=n.namespace;"firebase.com"===n.domain&&Wi(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||Wi("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Hi("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new go(n.host,n.secure,r,i,t,"",r!==n.subdomain),path:new Oo(n.pathString)}},bc=function(e){let t="",n="",r="",i="",o="",s=!0,a="https",l=443;if("string"==typeof e){let c=e.indexOf("//");c>=0&&(a=e.substring(0,c-1),e=e.substring(c+2));let u=e.indexOf("/");-1===u&&(u=e.length);let h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(u,h)),u<h&&(i=function(e){let t="";const n=e.split("/");for(let e=0;e<n.length;e++)if(n[e].length>0){let r=n[e];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch(e){}t+="/"+r}return t}(e.substring(u,h)));const f=function(e){const t={};"?"===e.charAt(0)&&(e=e.substring(1));for(const n of e.split("&")){if(0===n.length)continue;const r=n.split("=");2===r.length?t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Hi(`Invalid query segment '${n}' in query '${e}'`)}return t}(e.substring(Math.min(e.length,h)));c=t.indexOf(":"),c>=0?(s="https"===a||"wss"===a,l=parseInt(t.substring(c+1),10)):c=t.length;const d=t.slice(0,c);if("localhost"===d.toLowerCase())n="localhost";else if(d.split(".").length<=2)n=d;else{const e=t.indexOf(".");r=t.substring(0,e).toLowerCase(),n=t.substring(e+1),o=r}"ns"in f&&(o=f.ns)}return{host:t,port:l,domain:n,subdomain:r,secure:s,scheme:a,pathString:i,namespace:o}};class wc{constructor(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+mr(this.snapshot.exportVal())}}class xc{constructor(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class Cc{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return Qn(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class Sc{constructor(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}get key(){return qo(this._path)?null:Lo(this._path)}get ref(){return new kc(this._repo,this._path)}get _queryIdentifier(){const e=Ls(this._queryParams),t=Qi(e);return"{}"===t?"default":t}get _queryObject(){return Ls(this._queryParams)}isEqual(e){if(!((e=Tr(e))instanceof Sc))return!1;const t=this._repo===e._repo,n=Bo(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&n&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}class kc extends Sc{constructor(e,t){super(e,t,new Ms,!1)}get parent(){const e=zo(this._path);return null===e?null:new kc(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class Ec{constructor(e,t,n){this._node=e,this.ref=t,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new Oo(e),n=Ic(this.ref,e);return new Ec(this._node.getChild(t),n,ps)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,((t,n)=>e(new Ec(n,Ic(this.ref,t),ps))))}hasChild(e){const t=new Oo(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Tc(e,t){return(e=Tr(e))._checkNotDeleted("ref"),void 0!==t?Ic(e._root,t):e._root}function Ic(e,t){return null===Ro((e=Tr(e))._path)?Yl("child","path",t,!1):Vl("child","path",t,!1),new kc(e._repo,$o(e._path,t))}function Ac(e,t){e=Tr(e),Gl("set",e._path),Wl("set",t,e._path,!1);const n=new ur;return lc(e._repo,e._path,t,null,n.wrapCallback((()=>{}))),n.promise}function Dc(e){e=Tr(e);const t=new Cc((()=>{})),n=new Nc(t);return function(e,t,n){const r=function(e,t){const n=t._path;let r=null;e.syncPointTree_.foreachOnPath(n,((e,t)=>{const i=Uo(e,n);r=r||Ja(t,i)}));let i=e.syncPointTree_.get(n);i?r=r||Ja(i,Po()):(i=new Ya,e.syncPointTree_=e.syncPointTree_.set(n,i));const o=null!=r,s=o?new Js(r,!0,!1):null;return ra(Ka(i,t,va(e.pendingWriteTree_,t._path),o?s.getNode():xs.EMPTY_NODE,o).viewCache_)}(e.serverSyncTree_,t);return null!=r?Promise.resolve(r):e.server_.get(t).then((r=>{const i=ks(r).withIndex(t._queryParams.getIndex());let o;if(cl(e.serverSyncTree_,t,n,!0),t._queryParams.loadsAllData())o=sl(e.serverSyncTree_,t._path,i);else{const n=gl(e.serverSyncTree_,t);o=ll(e.serverSyncTree_,t._path,i,n)}return Jl(e.eventQueue_,t._path,o),al(e.serverSyncTree_,t,n,null,!0),i}),(n=>(cc(e,"get for query "+mr(t)+" failed: "+n),Promise.reject(new Error(n)))))}(e._repo,e,n).then((t=>new Ec(t,new kc(e._repo,e._path),e._queryParams.getIndex())))}class Nc{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const n=t._queryParams.getIndex();return new wc("value",this,new Ec(e.snapshotNode,new kc(t._repo,t._path),n))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new xc(this,e,t):null}matches(e){return e instanceof Nc&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}!function(e){Qn(!Ha,"__referenceConstructor has already been defined"),Ha=e}(kc),function(e){Qn(!Va,"__referenceConstructor has already been defined"),Va=e}(kc);const Oc={};function Pc(e,t,n,r,i){let o=r||e.options.databaseURL;void 0===o&&(e.options.projectId||Wi("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),qi("Using default host for project ",e.options.projectId),o=`${e.options.projectId}-default-rtdb.firebaseio.com`);let s,a,l=yc(o,i),c=l.repoInfo;"undefined"!=typeof process&&process.env&&(a=process.env.FIREBASE_DATABASE_EMULATOR_HOST),a?(s=!0,o=`http://${a}?ns=${c.namespace}`,l=yc(o,i),c=l.repoInfo):s=!l.repoInfo.secure;const u=i&&s?new lo(lo.OWNER):new ao(e.name,e.options,t);(function(e,t){const n=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!Ul(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Bl(e)}(n))throw new Error(kr(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')})("Invalid Firebase Database URL",l),qo(l.path)||Wi("Database URL must point to the root of a Firebase Database (not including a child path).");const h=function(e,t,n,r){let i=Oc[t.name];i||(i={},Oc[t.name]=i);let o=i[e.toURLString()];return o&&Wi("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),o=new ec(e,false,n,r),i[e.toURLString()]=o,o}(c,e,u,new so(e.name,n));return new Rc(h,e)}class Rc{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(tc(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new kc(this._repo,Po())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function(e,t){const n=Oc[t];n&&n[e.key]===e||Wi(`Database ${t}(${e.repoInfo_}) has already been deleted.`),function(e){e.persistentConnection_&&e.persistentConnection_.interrupt("repo_interrupt")}(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&Wi("Cannot call "+e+" on a deleted database.")}}Xo.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},Xo.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)},Ai="9.23.0",hi(new Ir("database",((e,{instanceIdentifier:t})=>Pc(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t)),"PUBLIC").setMultipleInstances(!0)),gi(Ti,Ii,void 0),gi(Ti,Ii,"esm2017");const Mc=function(e=function(e=si){const t=li.get(e);if(!t&&e===si&&cr())return pi();if(!t)throw fi.create("no-app",{appName:e});return t}(),t){const n=function(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}(e,"database").getImmediate({identifier:t});if(!n._instanceStarted){const e=(e=>{const t=(e=>{var t,n;return null===(n=null===(t=lr())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]})(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]})("database");e&&function(e,t,n,r={}){(e=Tr(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&Wi("Cannot call useEmulator() after instance has already been initialized.");const i=e._repoInternal;let o;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Wi('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new lo(lo.OWNER);else if(r.mockUserToken){const t="string"==typeof r.mockUserToken?r.mockUserToken:function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[ir(JSON.stringify({alg:"none",type:"JWT"})),ir(JSON.stringify(o)),""].join(".")}(r.mockUserToken,e.app.options.projectId);o=new lo(t)}!function(e,t,n,r){e.repoInfo_=new go(`${t}:${n}`,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams,!0),r&&(e.authTokenProvider_=r)}(i,t,n,o)}(n,...e)}return n}(pi({apiKey:"AIzaSyB0IV0RAdqkE-TqR7scVzzaSXy8KfFFQc4",authDomain:"topull-c7f63.firebaseapp.com",projectId:"topull-c7f63",storageBucket:"topull-c7f63.appspot.com",messagingSenderId:"918543856050",appId:"1:918543856050:web:7f867159815a1b4c3df4ab",measurementId:"G-8V9JR8P40D"})),Fc=document.querySelector(".container-main"),Lc=document.querySelector(".main-body"),jc=document.querySelector(".list-data"),zc=document.querySelectorAll(".input"),$c=document.querySelector(".container-inputs"),qc=document.querySelector(".numbers-cargas-puxar"),Uc=document.querySelector(".numbers-cargas-puxadas"),Bc=document.querySelector(".input-filial"),Wc=document.querySelector(".input-agenda"),Hc=document.querySelector(".input-box"),Vc=document.querySelector(".input-controle"),Yc=document.querySelector(".input-material"),Gc=document.querySelector(".input-pallets"),Kc=[],Xc=[],Jc=[],Qc=[];let Zc,eu,tu,nu,ru,iu,ou=1;class su{constructor(e){this.filial=e.filial,this.agenda=e.agenda,this.box=e.box,this.controle=e.controle,this.material=e.material,this.qtPallet=e.qtPallets,this.date=e.date,this.hora=e.hora,this.startingTime="00:00:00",this.id=e.id}printObject(){const e="div",t="cell",n=pu(e,"line");if(nu<=700){const e=function(){const e=pu("div","container-title-of-list");return["Filial","Agenda","Doca","Controle","Material","Pallets","Data","Hora","Tempo"].forEach((t=>{const n=pu("p","title");n.innerHTML=t,e.appendChild(n)})),e}();n.appendChild(e)}const r=pu(e,t,"filial",this.filial),i=pu(e,t,"agenda",this.agenda),o=pu(e,t,"box",this.box),s=pu(e,t,"controle",this.controle),a=pu(e,t,"material",this.material.toUpperCase()),l=pu(e,t,"qt-pallets",this.qtPallet),c=pu(e,t,"data",this.date),u=pu(e,t,"hora",this.hora),h=pu(e,t,"time",this.startingTime),f=pu(e,t,"id",this.id);return n.appendChild(r),n.appendChild(i),n.appendChild(o),n.appendChild(s),n.appendChild(a),n.appendChild(l),n.appendChild(c),n.appendChild(u),n.appendChild(h),n.appendChild(f),jc.appendChild(n),h}}function au(){let e;return e=iu?Jc.length:Xc.length,e}function lu(){let e;return e=iu?Qc.length:Kc.length,e}function cu(e){const t=ru.childNodes,n=[];let r,i;return t.forEach((t=>{t.classList.contains("cell")&&(n.push(t.textContent),t.classList.contains(e)&&(r=t.textContent),t.classList.contains(e)&&(i=t.textContent))})),r||i||n}function uu(e){return e<10&&(e="0"+e),e}function hu(){const e=new Date;let t=1;return t+=e.getMonth(),`${uu(e.getDate())}/${uu(t)}/${e.getFullYear()}`}class fu{constructor(e,t,n,r){this.cellTime=e,this.ano=t.slice(6,10),this.mes=t.slice(3,5),this.dia=t.slice(0,2),this.hora=n,this.cont=r}create(){const e=new Date(`${this.ano}-${this.mes}-${this.dia}T${this.hora}`),t=new Date,n=new Date(t-e);let r=uu(n.getUTCHours())+":";return r+=uu(n.getUTCMinutes())+":",r+=uu(n.getUTCSeconds()),r}start(){this.cont=setInterval((()=>{this.segundos++;let e=this.create();return e>="00:20:00"&&e<="00:40:00"&&mu(this.cellTime),e>"00:40:00"&&_u(this.cellTime),this.cellTime.innerHTML=e}),1e3)}}class du{constructor(e,t,n){this.cellTime=e,this.second=t,this.time=n}createDateNow(){return new Date(1e3*this.second).toLocaleTimeString("pt-BR",{hora12:!1,timeZone:"UTC"})}startDateNow(){this.time=setInterval((()=>{this.second++;let e=this.createDateNow();return e>="00:20:00"&&e<="00:40:00"&&mu(this.cellTime),e>"00:40:00"&&_u(this.cellTime),this.cellTime.innerHTML=e}),1e3)}}function pu(e,t,n,r){const i=document.createElement("p");i.classList.add("cell-data"),i.innerHTML=r;const o=document.createElement(e);return o.classList.add(t),o.classList.add(n),r&&o.appendChild(i),o}function gu(e){const t=document.querySelector(".dialog-box"),n=document.querySelector(".mobile-dialog-box");if("true"===e)return null!=t&&t.remove(),void(null!=n&&n.remove());null!=t&&t.remove(),null!=n&&n.remove(),ru.remove(),t.remove()}function mu(e){return e.parentNode.classList.add("yellow")}function _u(e){return e.parentNode.classList.add("red")}function vu(){zc.forEach((e=>{e.value=""}))}function yu(e){const t=[];if(e)return ru.childNodes.forEach((e=>{e.classList.contains("cell")&&t.push(e.textContent)})),t;{const e=jc.childNodes;return e[e.length-1].childNodes.forEach((e=>{e.classList.contains("cell")&&t.push(e.textContent)})),t}}function bu(){const e=["ATENÇÃO!","Aguardando etiquetas."],t=pu("div","body-of-print"),n=pu("div","warn"),r=pu("div","description");n.innerHTML=`${e[0]}`,r.innerHTML=`${e[1]}`,t.appendChild(n),t.appendChild(r),Lc.appendChild(t)}document.addEventListener("click",(e=>{const t=e.target;if(t.classList.contains("push")||t.classList.contains("push-request")){if(!function(){if(Bc.value)if(Wc.value)if(Hc.value)if(Vc.value)if(Yc.value){if(Gc.value)return!0;Gc.focus()}else Yc.focus();else Vc.focus();else Hc.focus();else Wc.focus();else Bc.focus()}())return;const e="true";jc.classList.add(e);const t=hu(),r=function(){const e=new Date;return`${uu(e.getHours())}:${uu(e.getMinutes())}:${uu(e.getSeconds())}`}(),i=Yc.value;(function(e,t,n,r,i,o,s,a){Ac(Tc(Mc,`cargas-puxar/${tu.slice(6,10)}/${tu.slice(3,5)}/${tu.replace(/\//g,"")}/${ou}`),{filial:e,agenda:t,box:n,controle:r,material:i,qtPallets:o,date:s,hora:a,id:ou})})(Bc.value,Wc.value,Hc.value,Vc.value,i.toUpperCase(),Gc.value,t,r),vu(),Bc.focus(),n=ou,Ac(Tc(Mc,"key-cargas-puxar/"),{cont:n}),ou++,Dc(Tc(Mc,`cargas-puxar/${tu.slice(6,10)}/${tu.slice(3,5)}/${tu.replace(/\//g,"")}`)).then((e=>{const t=Object.values(e.val()),n=t.length-1;Kc.push(t[n]);const r=Kc.length-1,i=new su(Kc[r]).printObject();new du(i,0,"").startDateNow(),nu>=700&&(qc.innerHTML=lu())}))}var n,r,i,o,s,a,l;if(t.classList.contains("menu")||t.classList.contains("li-menu")||t.classList.contains("abas")){const e=document.querySelector(".menu"),t=document.querySelector(".box-menu");e.classList.toggle("animation-btn-menu"),t.classList.toggle("animation-box-menu")}if(t.classList.contains("transpicking")){const e=document.querySelector(".body"),t=document.querySelector(".m-status");$c.classList.add("inp"),t.classList.contains("s-visible")&&t.classList.remove("s-visible"),e.classList.contains("visible")||e.classList.add("visible")}if(t.classList.contains("recebimento")){const e=document.querySelector(".body"),t=document.querySelector(".m-status");$c.classList.remove("inp"),t.classList.contains("s-visible")&&t.classList.remove("s-visible"),e.classList.contains("visible")&&e.classList.remove("visible")}if(t.classList.contains("status")){const e=document.querySelector(".m-cargas-puxar"),t=document.querySelector(".m-cargas-puxadas"),n=document.querySelector(".m-status");n.classList.contains("s-visible")||n.classList.add("s-visible"),e.innerHTML=lu(),t.innerHTML=au()}if(t.classList.contains("cell")||t.classList.contains("cell-data")){if(t.classList.contains("cell")&&(ru=t.parentNode),t.classList.contains("cell-data")){const e=t.parentNode;ru=e.parentNode}const e="id";nu>700&&function(){const e=pu("div","dialog-box"),t=pu("h3","title-dialog-box"),n=pu("button","btn-confirm-dialog-box"),r=pu("button","btn-desk-print-dialog-box"),i=pu("button","btn-cancel-dialog-box");t.innerHTML="Carga retirada!",n.innerHTML="Confirmar",r.innerHTML="Imprimir",i.innerHTML="Devolver",e.appendChild(t),e.appendChild(n),e.appendChild(r),e.appendChild(i),Fc.appendChild(e)}(),cu(e),nu<=700&&function(){const e=pu("div","mobile-dialog-box"),t=pu("h2","m-btn-confirm-dialog-box"),n=pu("h2","m-btn-close-dialog-box"),r=pu("h2","m-btn-print-dialog-box");t.innerHTML="Confirmar",r.innerHTML="Imprimir",n.innerHTML="Devolver",e.appendChild(t),e.appendChild(r),e.appendChild(n),Fc.appendChild(e)}()}if(t.classList.contains("btn-confirm-dialog-box")||t.classList.contains("m-btn-confirm-dialog-box")){const e="time",t="data";let n;n=iu?Qc:Kc;const r=cu("id");let i;n.forEach((e=>{e.id===Number(r)&&(i=e)}));let o=cu(t);!function(e,t){var n;n=Tc(Mc,`cargas-puxar/${tu.slice(6,10)}/${tu.slice(3,5)}/${t.replace(/\//g,"")}/${e}`),Gl("remove",n._path),Ac(n,null)}(r,o);const s=cu(e);!function(e,t,n){Ac(Tc(Mc,`cargas-historico/${tu.slice(6,10)}/${tu.slice(3,5)}/${n.replace(/\//g,"")}/${e.id}`),{filial:e.filial,agenda:e.agenda,box:e.box,controle:e.controle,material:e.material,qtPallets:e.qtPallets,date:e.date,hora:e.hora,tempo:t,id:e.id})}(i,s,o),nu>700&&gu(),nu<=700&&gu(),Dc(Tc(Mc,`cargas-puxar/${tu.slice(6,10)}/${tu.slice(3,5)}/${o.replace(/\//g,"")}`)).then((e=>{const t=Object.values(e.val()),n=t.length-1;iu||Kc.pop(t[n]),iu&&Qc.pop(t[n]),nu>=700&&(qc.innerHTML=lu())})).catch((e=>{qc.innerHTML="0",Kc.pop(),console.error("Não há dados!")})),Dc(Tc(Mc,`cargas-historico/${tu.slice(6,10)}/${tu.slice(3,5)}/${o.replace(/\//g,"")}`)).then((e=>{const t=Object.values(e.val()),n=t.length-1;iu||Xc.push(t[n]),iu&&Jc.push(t[n]),nu>=700&&(Uc.innerHTML=au())})).catch((e=>{console.error(e)}))}if(t.classList.contains("btn-cancel-dialog-box")||t.classList.contains("m-btn-close-dialog-box")){if(!ru.classList.contains("green"))return void gu("true");const e=cu();Ac(Tc(Mc,"cargas-devovidas/"+(i=e)[8]),{afilial:i[0],agenda:i[1],box:i[2],controle:i[3],dmaterial:i[4],dtPallets:i[5],edata:i[6],hora:i[7],key:i[8]}),(r=ru).classList.contains("green")&&r.classList.remove("green");const t=cu();removeCargaRetiradas(t[8]),function(e){Ac(Tc(Mc,"key-cargas-devolvidas/"),{cont:e})}(e[8])}if((t.classList.contains("print")||t.classList.contains("printer"))&&(Zc=yu(),print()),(t.classList.contains("m-btn-print-dialog-box")||t.classList.contains("btn-desk-print-dialog-box"))&&(Zc=yu(!0),print()),t.classList.contains("btn-ag-etiquetas")&&(eu=bu(),print()),t.classList.contains("btn-backday")){const e=document.querySelector(".btn-xlsx");let t=0;t=tu.slice(0,2)-1,Dc(Tc(Mc,`cargas-puxar/${tu.slice(6,10)}/${tu.slice(3,5)}/${uu(t)}${tu.slice(3,10).replace(/\//g,"")}`)).then((t=>{t.exists()&&(jc.textContent="",e.style.display="inline",Object.values(t.val()).forEach((e=>{Qc.push(e);const t=new su(e).printObject();new fu(t,e.date,e.hora,0).start()})),nu>=700&&(qc.innerHTML=Qc.length))})).catch((e=>{console.error("Não há dados!")})),Dc(Tc(Mc,`cargas-historico/${tu.slice(6,10)}/${tu.slice(3,5)}/${uu(t)}${tu.slice(3,10).replace(/\//g,"")}`)).then((e=>{e.exists()&&(Object.values(e.val()).forEach((e=>{Jc.push(e)})),nu>=700&&(Uc.innerHTML=Jc.length))})).catch((e=>{console.error("Não há dados")})),iu="lestDay"}if(t.classList.contains("btn-xlsx")){const e=[];Array.from(document.querySelectorAll(".line")).forEach((t=>{const n=[];Array.from(t.childNodes).forEach((e=>{n.push(e.textContent)}));const r={filial:n[0],agenda:n[1],box:n[2],controle:n[3],material:n[4],qtPallet:n[5],data:n[6],hora:n[7],time:n[8],id:n[9]};e.push(r)})),t.style.display="none";const n=Jn.json_to_sheet(e),r=Jn.book_new();Jn.book_append_sheet(r,n,"Dates"),Jn.sheet_add_aoa(n,[["Filial","Agenda","Box","Controle","Material","Qt. Pallets","Data","Hora","Tempo","Id"]],{origin:"A1"}),o=r,s="planilha-cargas.xlsx",(l=a||{}).type="file",l.file=s,function(e){if(!e.bookType){var t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType}}(l),Un(o,l)}})),window.addEventListener("load",(e=>{vu(),Bc.focus(),nu=window.screen.width,tu=hu(),Dc(Tc(Mc,`cargas-puxar/${tu.slice(6,10)}/${tu.slice(3,5)}/${tu.replace(/\//g,"")}`)).then((e=>{e.exists()&&(Object.values(e.val()).forEach((e=>{Kc.push(e);const t=new su(e).printObject();new fu(t,e.date,e.hora,0).start()})),nu>=700&&(qc.innerHTML=lu()))})).catch((e=>{console.error("Não há dados!")})),Dc(Tc(Mc,`cargas-historico/${tu.slice(6,10)}/${tu.slice(3,5)}/${tu.replace(/\//g,"")}`)).then((e=>{e.exists()&&(Object.values(e.val()).forEach((e=>{Xc.push(e)})),nu>=700&&(Uc.innerHTML=au()))})).catch((e=>{console.error("Não há dados")})),Dc(Tc(Mc,"key-cargas-puxar/")).then((e=>{if(e.exists()){const t=Object.values(e.val()),n=Object.values(t);ou+=n[0]}}))})),window.addEventListener("beforeprint",(()=>{Zc&&function(e,t,n,r,i,o){const s=["FILIAL: ","AGENDA: ","DOCA: ","CONTROLE: ","PALLETS: ","HORA: "],a=pu("div","body-of-print"),l=pu("p","number-filial"),c=pu("p","number-agenda"),u=pu("p","number-doca"),h=pu("p","number-controle"),f=pu("p","number-of-pallets"),d=pu("p","time-request");l.textContent=`${s[0]}${e}`,c.textContent=`${s[1]}${t}`,u.textContent=`${s[2]}${n}`,h.textContent=`${s[3]}${r}`,f.textContent=`${s[4]}${i}`,d.textContent=`${s[5]}${o}`,a.appendChild(l),a.appendChild(c),a.appendChild(u),a.appendChild(h),a.appendChild(f),a.appendChild(d),Lc.appendChild(a),Zc=""}(Zc[0],Zc[1],Zc[2],Zc[3],Zc[5],Zc[7]),eu&&bu(eu[0],eu[1]),gu("true")})),window.addEventListener("afterprint",(()=>{document.querySelector(".body-of-print").remove(),Bc.focus()}))})()})();